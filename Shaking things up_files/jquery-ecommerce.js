/* +=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+= (c) InFX Solutions 2015 +=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=
File list:
../script/infx-config.js
../script/infx-console.js
../script/infx-lib.js
../script/infx-search.js
../script/jQuery/plugins/scroll-to/scroll-to.min.js
../script/popup-new.js
../script/infx-cookie.js
../script/jquery-pagesupport-ecommerce.js
../script/infx-delivery.js
../script/infx-callbacks.js
../script/infx-profile.js
../script/infx-basket.js
../script/infx-tracking.js
../script/infx-navigation.js
../script/infx-form.js
../script/jquery-product-navigation.js
../script/validate.js
../script/ext-lite.js
../script/infx-social.js
../script/infx-bazaarvoice.js
../script/auto-set-picture-height.js
../script/auto-size-columns1.0.js
../script/infx-sliding-header.js
../script/infx-generate-password-popup.js

 */_infx=(typeof(_infx)==='undefined')?{}:_infx;_infx.scripts={ecommerce:{system:'/cgi-bin/ecommerce/system.pl',payment:'/cgi-bin/ecommerce/payment.pl',ajax:'/cgi-bin/ecommerce/ajax.pl'},infxsystem:{send:'/cgi-bin/infxsystem/send.pl',widget:'/cgi-bin/infxsystem/widget.pl'},widgets:{captcha:'widget-captcha.pl',product:'widget-product.pl',event:'widget-event.pl',advert:'widget-adverts.pl',login:'widget-login.pl',profile:'widget-profile.pl',review:'widget-review.pl',upload:'widget-upload.pl',basket:'widget-basket.pl'},newsletter:'/cgi-bin/newsletter.pl',campaign:'/cgi-bin/campaign.pl'};_infx.config={scrollTopOffset:0,return_config_for_domain:function(config_array){if(config_array&&config_array.constructor===Array){for(var x=0;x<config_array.length;x++){if(config_array[x].domain&&(config_array[x].domain==location.host)){return(config_array[x]);};};};return(undefined);}};_infx.scripts.system_widget_handler=_infx.scripts.infxsystem.widget;var system=_infx.scripts.ecommerce.system;var ecommerce_ajax=_infx.scripts.ecommerce.ajax;var payment_control=_infx.scripts.ecommerce.payment;var send_info=_infx.scripts.infxsystem.send;var newsletter_signup=_infx.scripts.newsletter;var campaign_signup=_infx.scripts.campaign;var captcha_widget='/cgi-bin/infxwidgets/'+_infx.scripts.widgets.captcha;var product_widget='/cgi-bin/infxwidgets/'+_infx.scripts.widgets.product;var event_widget='/cgi-bin/infxwidgets/'+_infx.scripts.widgets.event;var advert_widget='/cgi-bin/infxwidgets/'+_infx.scripts.widgets.advert;var login_widget='/cgi-bin/infxwidgets/'+_infx.scripts.widgets.login;var profile_widget='/cgi-bin/infxwidgets/'+_infx.scripts.widgets.profile;var review_widget='/cgi-bin/infxwidgets/'+_infx.scripts.widgets.review;var upload_widget='/cgi-bin/infxwidgets/'+_infx.scripts.widgets.upload;var basket_widget='/cgi-bin/infxwidgets/'+_infx.scripts.widgets.basket;if(!window.console){window.console={};};if(!window.console.log){window.console.log=function(){};};if(!window.console.warn){window.console.warn=function(){};};if(!window.console.error){window.console.error=function(){};};if(typeof String.prototype.trim!=='function'){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,'');}}
if(typeof String.prototype.upperCaseFirst!=='function'){String.prototype.upperCaseFirst=function(all_words){if(all_words){return this.split(" ")
.map(function(e){return e.upperCaseFirst();})
.join(' ');}else{return this.charAt(0).toUpperCase()+this.slice(1);}}}
if(typeof String.prototype.toIdentifier!=='function'){String.prototype.toIdentifier=function(repl_char,invalid_regex){if(typeof repl_char==='undefined')repl_char='_';if(typeof invalid_regex==='undefined')invalid_regex=/[^\w]+/;return this.trim().replace(new RegExp(invalid_regex.source,'g'),repl_char);}}
if(typeof String.prototype.toWords!=='function'){String.prototype.toWords=function(repl_char,invalid_regex){if(typeof repl_char==='undefined')repl_char=' ';if(typeof invalid_regex==='undefined')invalid_regex=/[^A-Za-z0-9]+/;return this.replace(new RegExp(invalid_regex.source,'g'),repl_char);}}
if(typeof Array.prototype.shuffle!=='function'){Array.prototype.shuffle=function(){var sorted=[];while(this.length){sorted.push(this.splice(Math.random()*this.length,1));};while(sorted.length){this.push(sorted.pop());};return this;};};if(typeof Array.prototype.numericSort!=='function'){Array.prototype.numericSort=function(){this.sort(function(a,b){a=parseInt(a);b=parseInt(b);if(a>b){return 1;};if(a<b){return-1;};return 0;});return this;};};_infx=(typeof(_infx)==='undefined')?{}:_infx;_infx.search={debug:0,script:'/cgi-bin/infxsystem/search.pl',busy:false,last_search:"",delay:750,min_chars:3,elem:null,expandable:false,expanded:false,locked:false,timers:{search_close_timer:null},appliedScrollTopOffsetInput:0,appliedScrollTopOffsetResults:0,callbacks:{selected_result:null,trigger:null},attach_handlers:function(){if(typeof(Modernizr)!='undefined'&&Modernizr.touch==true){if(_infx.search.version===2){if(_infx.search.expandable==true){_infx.search.elem.find(".search-icon").on("click",function(e){if(_infx.search.expanded==false){_infx.search.expanded=true;_infx.search.elem.find(".search-input").css("display","block");_infx.search.elem.addClass("hoverable");if($("#minibasket.basket-expanded").length!=0){multi_basket_control('collapse','mini');};_infx.search.elem.find(".search-input").focus();}else{_infx.search.expanded=false;_infx.search.elem.removeClass("hoverable");setTimeout(function(){_infx.search.elem.find(".search-input").blur().css("display","none")},500);_infx.search.close();e.stopPropagation();};e.stopPropagation();});}else{_infx.search.elem.find(".search-icon").on("click",function(e){_infx.search.expanded=false;setTimeout(function(){_infx.search.elem.find(".search-input").blur()},500);_infx.search.close();e.stopPropagation();});};}
if(_infx.search.version===3){_infx.search.elem.find(".search-icon").on("click",function(e){$(this).toggleClass("open");_infx.search.inputWrapper.slideToggle();if(!$(this).hasClass("open")){_infx.config.scrollTopOffset-=_infx.search.appliedScrollTopOffsetInput;if(_infx.search.resultsWrapper.html()!=""){_infx.search.resultsWrapper.slideUp(400,function(){_infx.config.scrollTopOffset-=_infx.search.appliedScrollTopOffsetResults;if(_infx.search.v3fullScreenMobile===true){if(_infx.search.v3fullScreenMobileWrapper)_infx.search.v3fullScreenMobileWrapper.css("display","none");}});}}else{setTimeout(function(){_infx.search.appliedScrollTopOffsetInput=_infx.search.inputWrapper.outerHeight();_infx.config.scrollTopOffset+=_infx.search.appliedScrollTopOffsetInput;},400);if(_infx.search.v3fullScreenMobile===true&&$(window).width()<=_infx.search.v3fullScreenMobileThreshold){if(_infx.search.v3fullScreenMobileWrapper)_infx.search.v3fullScreenMobileWrapper.css("display","block");_infx.search.setV3fullScreenMobileWrapperHeight();}
if(_infx.search.resultsWrapper.html()!=""){_infx.search.resultsWrapper.slideDown(400,function(){_infx.search.appliedScrollTopOffsetResults=_infx.search.resultsWrapper.outerHeight();_infx.config.scrollTopOffset+=_infx.search.appliedScrollTopOffsetResults;});}}});if(_infx.search.v3fullScreenMobile===true){$(window).on("resize",function(){_infx.search.resizeV3fullScreenMobileWrapper();});_infx.search.resizeV3fullScreenMobileWrapper();}}}else{if(_infx.search.version===2){_infx.search.elem.find(".search-input").show();if(_infx.search.expandable==true){_infx.search.elem.live("mouseenter",function(e){clearTimeout(_infx.search.timers.search_close_timer);_infx.search.expanded=true;_infx.search.elem.addClass("hoverable");if($("#minibasket.basket-expanded").length!=0)multi_basket_control('collapse','mini');_infx.search.elem.find(".search-input").css("z-index",25).focus();e.stopPropagation();});_infx.search.elem.live("mouseleave",function(e){if(_infx.search.locked==false){_infx.search.timers.search_close_timer=setTimeout(function(){if(_infx.search.elem.find(".search_results").html()==""){_infx.search.elem.removeClass("hoverable");_infx.search.elem.find(".search-input").blur();_infx.search.close();}},500);}
e.stopPropagation();});_infx.search.elem.find(".search-icon").on("click",function(e){_infx.search.expanded=false;_infx.search.locked=false;_infx.search.elem.removeClass("hoverable");_infx.search.elem.find(".search-input").blur();_infx.search.close();e.stopPropagation();});_infx.search.elem.find(".search-input").on("click",function(e){_infx.search.locked=true;});}else{_infx.search.elem.find(".search-icon").on("click",function(e){_infx.search.elem.find(".search-input").blur();_infx.search.close();e.stopPropagation();});}}
if(_infx.search.version===3){_infx.search.elem.find(".search-icon").on("click",function(e){$(this).toggleClass("open");_infx.search.inputWrapper.slideToggle();if(!$(this).hasClass("open")){_infx.config.scrollTopOffset-=_infx.search.appliedScrollTopOffsetInput;if(_infx.search.resultsWrapper.html()!=""){_infx.search.resultsWrapper.slideUp(400,function(){_infx.config.scrollTopOffset-=_infx.search.appliedScrollTopOffsetResults;});}}else{setTimeout(function(){_infx.search.appliedScrollTopOffsetInput=_infx.search.inputWrapper.outerHeight();_infx.config.scrollTopOffset+=_infx.search.appliedScrollTopOffsetInput;},400);if(_infx.search.resultsWrapper.html()!=""){_infx.search.resultsWrapper.slideDown(400,function(){_infx.search.appliedScrollTopOffsetResults=_infx.search.resultsWrapper.outerHeight();_infx.config.scrollTopOffset+=_infx.search.appliedScrollTopOffsetResults;});}}});}
$(window).on("resize",function(){});}
if(_infx.search.clickoutclose===true){$('body').on("click",function(e){if(!$(e.target).parents('.search-v2').length){if(_infx.search.expanded){_infx.search.expanded=false;_infx.search.locked=false;_infx.search.elem.removeClass("hoverable");_infx.search.elem.find(".search-input").blur();_infx.search.close();e.stopPropagation();}}});}},resizeV3fullScreenMobileWrapper:function(){if($(window).width()<=_infx.search.v3fullScreenMobileThreshold){_infx.search.createV3fullScreenMobileWrapper();}
_infx.search.setV3fullScreenMobileWrapperHeight();},createV3fullScreenMobileWrapper:function(){if($(".v3-mobile-fullscreen-wrapper").length===0){var p=_infx.search.resultsWrapper.parent();p.append('<div class="v3-mobile-fullscreen-wrapper"></div>');_infx.search.v3fullScreenMobileWrapper=$(".v3-mobile-fullscreen-wrapper");_infx.search.inputWrapper.appendTo(_infx.search.v3fullScreenMobileWrapper);_infx.search.resultsWrapper.appendTo(_infx.search.v3fullScreenMobileWrapper);_infx.search.inputWrapper.append('<div class="mobile-close-button"></div>');_infx.search.inputWrapper.find(".mobile-close-button").on("click",function(){_infx.search.elem.find(".search-icon").removeClass("open");_infx.search.inputWrapper.slideUp();_infx.search.resultsWrapper.slideUp(400,function(){if(_infx.search.v3fullScreenMobile===true){if(_infx.search.v3fullScreenMobileWrapper)_infx.search.v3fullScreenMobileWrapper.css("display","none");}});});_infx.search.elem.addClass("mobile");}},setV3fullScreenMobileWrapperHeight:function(){var v3mfw=$(".v3-mobile-fullscreen-wrapper");if(v3mfw.length>0){_infx.search.v3fullScreenMobileWrapperHeight=$(window).height();v3mfw.css("height",_infx.search.v3fullScreenMobileWrapperHeight+"px");}},init:function(initconfig){_infx.search.elem=initconfig.elem;_infx.search.override=initconfig.override;_infx.search.clickoutclose=typeof(initconfig.clickoutclose)!="undefined"?initconfig.clickoutclose:false;_infx.search.version=typeof(initconfig.version)!="undefined"?initconfig.version:2;_infx.search.resultsWrapper=typeof(initconfig.resultsWrapper)!="undefined"?initconfig.resultsWrapper:_infx.search.elem.find(".search_results");_infx.search.inputWrapper=typeof(initconfig.inputWrapper)!="undefined"?initconfig.inputWrapper:null;_infx.search.v3fullScreenMobile=typeof(initconfig.v3fullScreenMobile)!="undefined"?initconfig.v3fullScreenMobile:true;_infx.search.v3fullScreenMobileWrapper=null;_infx.search.v3fullScreenMobileThreshold=typeof(initconfig.v3fullScreenMobileThreshold)!="undefined"?initconfig.v3fullScreenMobileThreshold:650;_infx.search.addCloseButtonToResultsWrapper=typeof(initconfig.addCloseButtonToResultsWrapper)!="undefined"?initconfig.addCloseButtonToResultsWrapper:true;if(_infx.search.version===2){_infx.search.elem.addClass("v2");}
if(_infx.search.version===3){_infx.search.elem.addClass("v3");if(_infx.search.resultsWrapper.hasClass("search_results")){$(".content-container-three").prepend('<div class="group-wrapper display-none search-v3-results-wrapper"></div>');_infx.search.resultsWrapper=$(".search-v3-results-wrapper");}
if(_infx.search.inputWrapper!==null){_infx.search.inputWrapper.append(_infx.search.elem.find(".search-input"));}else{$(".content-container-three").prepend('<div class="group-wrapper display-none search-v3-input-wrapper"></div>');_infx.search.inputWrapper=$(".search-v3-input-wrapper");_infx.search.inputWrapper.append(_infx.search.elem.find(".search-input"));}
}
if(_infx.search.override==""){if(_infx.search.elem.parents("#navigation").length!=0||_infx.search.elem.parents("#header-outer").length!=0){_infx.search.expandable=true;_infx.search.elem.addClass("search-expandable");}else{_infx.search.expandable=false;_infx.search.elem.addClass("search-static");}
}else{var so="search-"+_infx.search.override;_infx.search.elem.addClass(so);if(so=="search-expandable"){_infx.search.expandable=true;}else{_infx.search.expandable=false;}}
this.attach_handlers();},trigger:function(config,event){if(this.debug){console.log("_infx.search.trigger - config:",config);};if(typeof(config)!=='object'){console.error("_infx.search.trigger - invalid config provided");return;};config.searchtxt=unescape(String(config.searchtxt).trim());if(config.returnkey){config.force=1;};config.ac=(typeof(config.override_ac)!=='undefined')?config.override_ac:'search';if(config.searchtxt!=''){if((config.force==1||config.searchtxt!=_infx.search.last_search)&&!_infx.search.busy){if(config.searchtxt.length>=this.min_chars){if(typeof(_infx.search.callbacks.trigger)==='function'){_infx.search.callbacks.trigger(config.searchtxt);}
this.spinner.show();this.last_search=config.searchtxt;this.busy=1;$.extend(true,config,{mode:'ajax',valid_json:1});$.ajax({url:search_script,type:'post',data:config,dataType:'json',success:function(data){_infx.search.busy=0;_infx.search.display({selector:_infx.search.resultsWrapper,content:data.content+data.hidden});}});}else{if(this.debug){console.log("_infx.search.trigger - min chars not reached");};};};}else{_infx.search.display({selector:_infx.search.resultsWrapper,content:""});};},delay_trigger:function(config,event){if(this.debug){console.log("_infx.search.delay_trigger - config:",config,"event:",event);};if(this.timers.search)clearTimeout(this.timers.search);if(event){config.force=(keyCheck(event,13))?1:0;};if(config.force){this.trigger(config);}else{this.timers.search=setTimeout(function(){_infx.search.trigger(config);},this.delay);};},display:function(config){if(this.debug){console.log("_infx.search.display - config:",config);};var $target=$(config.selector);if($target.length){if(config.content!=""){if(_infx.search.version===2)$target.css("display","block");if(_infx.search.expandable==false){_infx.search.elem.find(".search-icon").css("display","block");}}
else{$target.css("display","none");if(_infx.search.expandable==false){_infx.search.elem.find(".search-icon").css("display","none");}}
if(_infx.search.version===3){_infx.config.scrollTopOffset-=_infx.search.appliedScrollTopOffsetResults;_infx.search.resultsWrapper.slideUp();}
$target.html(config.content);if(config.content!=""&&_infx.search.version===3&&_infx.search.addCloseButtonToResultsWrapper===true){if(_infx.search.v3fullScreenMobile===false){_infx.search.resultsWrapper.append('<div class="results-wrapper-close-button"></div>');$(".results-wrapper-close-button").on("click",function(){_infx.config.scrollTopOffset-=_infx.search.appliedScrollTopOffsetResults;_infx.search.resultsWrapper.slideUp();});}
_infx.search.resultsWrapper.slideDown(400,function(){_infx.search.appliedScrollTopOffsetResults=_infx.search.resultsWrapper.outerHeight();_infx.config.scrollTopOffset+=_infx.search.appliedScrollTopOffsetResults;});}
if(typeof(_infx.search.callbacks.selected_result)==='function'){var $results=config.selector.find('.search-result-item');if(this.debug){console.log("_infx.search.display adding selected result click events to",$results.length,"elements");};config.selector.find('.search-result-item').on("click",function(){_infx.search.callbacks.selected_result($(this));});};}else{console.error("_infx.search.display couldn't find search result target with selector:",config.selector);};this.spinner.hide();},spinner:{show:function(){_infx.search.elem.find('.search_spinner').show();},hide:function(){_infx.search.elem.find('.search_spinner').hide();}},close:function(config){if(this.debug){console.log("_infx.search.close config:",config);};_infx.search.display({selector:_infx.search.elem.find(".search_results"),content:""});}};var last_search=_infx.search.last_search;var search_script=_infx.search.script;var search_busy=_infx.search.busy;function close_search(value){_infx.search.close();};function search_control(json){_infx.search.trigger(json);};function display_search_results(target_id,json,display_callback){_infx.search.display({selector:'#'+target_id,content:json.content+json.hidden});};function delay_submit_search(value,override_ac){_infx.search.delay_trigger({searchtxt:value,override_ac:override_ac|undefined});};function delay_submit_search2(e,value,override_ac){_infx.search.delay_trigger({searchtxt:value,override_ac:override_ac|undefined},e);};;(function(d){var k=d.scrollTo=function(a,i,e){d(window).scrollTo(a,i,e)};k.defaults={axis:'xy',duration:parseFloat(d.fn.jquery)>=1.3?0:1};k.window=function(a){return d(window)._scrollable()};d.fn._scrollable=function(){return this.map(function(){var a=this,i=!a.nodeName||d.inArray(a.nodeName.toLowerCase(),['iframe','#document','html','body'])!=-1;if(!i)return a;var e=(a.contentWindow||a).document||a.ownerDocument||a;return d.browser.safari||e.compatMode=='BackCompat'?e.body:e.documentElement})};d.fn.scrollTo=function(n,j,b){if(typeof j=='object'){b=j;j=0}if(typeof b=='function')b={onAfter:b};if(n=='max')n=9e9;b=d.extend({},k.defaults,b);j=j||b.speed||b.duration;b.queue=b.queue&&b.axis.length>1;if(b.queue)j/=2;b.offset=p(b.offset);b.over=p(b.over);return this._scrollable().each(function(){var q=this,r=d(q),f=n,s,g={},u=r.is('html,body');switch(typeof f){case'number':case'string':if(/^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(f)){f=p(f);break}f=d(f,this);case'object':if(f.is||f.style)s=(f=d(f)).offset()}d.each(b.axis.split(''),function(a,i){var e=i=='x'?'Left':'Top',h=e.toLowerCase(),c='scroll'+e,l=q[c],m=k.max(q,i);if(s){g[c]=s[h]+(u?0:l-r.offset()[h]);if(b.margin){g[c]-=parseInt(f.css('margin'+e))||0;g[c]-=parseInt(f.css('border'+e+'Width'))||0}g[c]+=b.offset[h]||0;if(b.over[h])g[c]+=f[i=='x'?'width':'height']()*b.over[h]}else{var o=f[h];g[c]=o.slice&&o.slice(-1)=='%'?parseFloat(o)/100*m:o}if(/^\d+$/.test(g[c]))g[c]=g[c]<=0?0:Math.min(g[c],m);if(!a&&b.queue){if(l!=g[c])t(b.onAfterFirst);delete g[c]}});t(b.onAfter);function t(a){r.animate(g,j,b.easing,a&&function(){a.call(this,n,b)})}}).end()};k.max=function(a,i){var e=i=='x'?'Width':'Height',h='scroll'+e;if(!d(a).is('html,body'))return a[h]-d(a)[e.toLowerCase()]();var c='client'+e,l=a.ownerDocument.documentElement,m=a.ownerDocument.body;return Math.max(l[h],m[h])-Math.min(l[c],m[c])};function p(a){return typeof a=='object'?a:{top:a,left:a}}})(jQuery);var _popup={speed:250,queue:new Array(),stacking:new Array(),current:{},instant:false,active:false,offset:0,masker:{show:true,opacity:0.6},debug:0,defaults:{closeicon:false,mask:false,loading:false,plain:false,autohide:0,cls:""}};_popup.create=function(config){config.orig_width=config.width;config.width=_popup.dynamic_width(config.width);for(var p in _popup.defaults){config[p]=(typeof(config[p])=='undefined')?_popup.defaults[p]:config[p];}
if(config.masker&&(typeof(config.masker.show)!='undefined'))_popup.masker.show=config.masker.show;config.pop_id="jq-popup";if(config.id){config.pop_id="jq-"+config.id;config.empty=config.empty||0;}else{config.empty=1;}
_popup.width=$(window).width();_popup.height=$(window).height();_popup.build_masker();_popup.build_popup(config);if(_popup.current.loading)config.force=true;if(config.force){_popup.current.instant=true;_popup.close();}
if(config.stack&&config.id){if(!config.z_index){config.z_index=_popup.highestZindex(config.id)+2;}
_popup.stackit(config);return;}
_popup.enqueue(config);}
_popup.highestZindex=function(cur_id){var zmax=1;$(".jq-popupcls").each(function(){if($(this).is(':visible')){var z=parseInt($(this).css("z-index"));if($(this).attr('id')!=cur_id){zmax=(z>zmax)?z:zmax;}}});return zmax;}
_popup.getFrontPopupId=function(){var zmax=0;var id=null;$(".jq-popupcls").each(function(){if($(this).is(':visible')){var z=parseInt($(this).css("z-index"));if(z>zmax){zmax=z;id=$(this).attr('id')}}});return id;}
_popup.dynamic_width=function(width){if(!width){return width}
var bw=$(window).width();var w='';if(/%/.test(width)){w=width;}else if(/px/.test(width)){w=parseFloat(width);}else if(parseFloat(width)>1){w=(parseFloat(width)/bw*100)+'%';}else{width=parseFloat(width);var widthmultiplier;if(bw>1280){widthmultiplier=width+(1-width)*3/8;}else{widthmultiplier=width+(1-width)*3/8;}
if(bw<960){widthmultiplier=width+(1-width)*1/2;}
if(bw<768){widthmultiplier=width+(1-width)*5/8;}
if(bw<650){widthmultiplier=width+(1-width)*4/5;}
if(widthmultiplier>1)widthmultiplier=1;w=(widthmultiplier*100)+"%";}
return w}
_popup.load=function(config){if(typeof(config)=='undefined'){config=_popup.dequeue();}
if(typeof(config)=='undefined'){$("#jq-masker").fadeOut((_popup.speed*2));return;}
_popup.current=config;$("#"+config.pop_id).css({height:(config.height?config.height:''),width:(config.width?config.width:''),'opacity':1,'-webkit-opacity':1});if(config.plain){$("#"+config.pop_id).addClass('plain');}else{$("#"+config.pop_id).removeClass('plain');}
if(_popup.masker.show){$("#jq-masker").css({opacity:_popup.masker.opacity}).fadeIn(_popup.speed);}
if(config.loading){$("#"+config.pop_id).css({width:'220px'}).empty().append("<img src='/x_icons/loading-bar.gif' alt='loading'/>").fadeIn((_popup.speed*2));}else if(config.mask){$("#"+config.pop_id).css({display:'none'}).empty();}else{if(config.empty){var popid=config.pop_id||'';$("#"+config.pop_id).empty().append((config.closeicon)?"<img src='/images/icons/grey-cross.png' onclick='_popup.close();' alt='cross' title='Close this popup' style='float:right;cursor:pointer;'/>":"").append(config.html).fadeIn((_popup.speed*2));config.empty=0;}else{$("#"+config.pop_id).fadeIn((_popup.speed*2));}}
if(config.left){$("#"+config.pop_id).css({left:config.left});}else{_popup.center(config);}
if(typeof(config.onload)=='function'){config.onload();}
if(config.autohide){setTimeout(function(){_popup.close();},(config.autohide+_popup.speed*2));}
_popup.active=true;_popup.pop_id=config.pop_id;$('body').trigger('init_widgets');if(config.scope){$('#popup_scope').data('scope',config.scope);}}
_popup.build_masker=function(){if($('#jq-masker').length!=0)return;$('<div id="jq-masker"></div>').prependTo("body");$("#jq-masker").click(function(){_popup.close();});$(document).keypress(function(e){if(e.keyCode==27)_popup.close();});}
_popup.build_popup=function(config){_popup.showdebug("build popup - Window width:"+$(window).width());if($('#'+config.pop_id).length==0){$("#jq-masker").after('<div id="'+config.pop_id+'"></div>');var $pop=$('#'+config.pop_id);$pop.addClass('jq-popupcls');$pop.css({top:"-150px"});$pop.after('<div id="popup_scope"></div>');if(config.cls){$pop.addClass(config.cls)};var cfg=config;$pop.resize(function(){});$(window).on('content_resize resize',function(event){_popup.showdebug("ww:"+$(window).width()+" ev:"+event.type);_popup.set_width(cfg,_popup.dynamic_width(cfg.orig_width));$("#"+config.pop_id).css("left",(($(window).width()-$("#"+config.pop_id).outerWidth(true))/2)+$(window).scrollLeft());});$pop.on('video_resize',function(event){_popup.showdebug("ww:"+$(window).width()+" ev:"+event.type);_popup.set_width(cfg,_popup.dynamic_width(cfg.orig_width));$("#"+config.pop_id).css("left",(($(window).width()-$("#"+config.pop_id).outerWidth(true))/2)+$(window).scrollLeft());_popup.center(cfg);});config.empty=1;}
return;}
_popup.setup_close=function(config){config.close=function(){if(!this.closed){var allow=true;if(typeof(this.onunload)=="function"){allow=this.onunload();if(typeof(allow)=='undefined')allow=true;}
if(allow){var id=_popup.current.pop_id;if(this.instant){$("#"+id).css({'opacity':0,'-webkit-opacity':0,top:-140});if(id=="jq-popup")$("#jq-popup").html('');_popup.load();}else{$("#"+id).fadeOut(_popup.speed,function(){$("#"+id).css({top:-140,display:'none'});if(id=="jq-popup")$("#jq-popup").html('');if(_popup.current.stack){_popup.unstackit();var z=_popup.highestZindex(id);$("#jq-masker").css('z-index',z-1);}else{_popup.load();}});}}else{this.closed=true;}}}
config.closed=false;return config;}
_popup.enqueue=function(config){config=_popup.setup_close(config);_popup.queue.push(config);if(!_popup.active)_popup.load();}
_popup.dequeue=function(){if(_popup.queue.length==0){_popup.active=false;return undefined;}
var config=_popup.queue.shift();if(++_popup.offset*2>=_popup.queue.length){_popup.queue=_popup.queue.slice(_popup.offset);_popup.offset=0;}
return config;}
_popup.stackit=function(config){config=_popup.setup_close(config);_popup.stacking.push(_popup.current);_popup.load(config);}
_popup.unstackit=function(){_popup.current=_popup.stacking.pop();}
_popup.center=function(config){var top=(($(window).height()-$("#"+config.pop_id).outerHeight(true))/2);if(top<10)top=10;var cfg={"position":"absolute","z-index":config.z_index||51,"top":top+$(window).scrollTop(),"left":(($(window).width()-$("#"+config.pop_id).outerWidth(true))/2)+$(window).scrollLeft()};if(cfg.top<10){cfg.top=10;}
if(config.top){cfg.top=config.top;}
$("#"+config.pop_id).css(cfg);$("#jq-masker").css({'z-index':(config.z_index||51)-1});}
_popup.set_width=function(config,w){$("#"+config.pop_id).css('width',w);}
_popup.close=function(){if(_popup.current.close)_popup.current.close();}
_popup.showdebug=function(html){if(_popup.debug==1){var $dbg=$("#popup-debug");if(!$dbg.length){$('<div id="popup-debug"></div>').prependTo("body");$dbg=$("#popup-debug");$dbg.css({"zIndex":200,"font-size":"15px","lineHeight":"18px","position":"fixed","top":0,"left":0,"color":"#000000","backgroundColor":"#FFFFFF","padding":"6px"});};$dbg.html(html);}}
_popup.block_open=function(id,width){var $el=$('#'+id).children().detach();var mywrapper=document.createElement("div");mywrapper.id="content-container";var mywrapper2=document.createElement("div");mywrapper2.id="mypopupcontent";$(mywrapper2).append("<div class='popup-close-line' style='text-align:right;display:block;width:100%'><img style='cursor:pointer;' title='Close this popup' alt='cross' onclick='_popup.close();' src='/images/icons/grey-cross.png'></div>");$(mywrapper).append(mywrapper2);$(mywrapper2).append($el);_popup.create({id:id,html:mywrapper,width:width,closeicon:false});$(window).trigger('resize');}
function popup_block_open(id,width){_popup.block_open(id,width);}
_infx=(typeof(_infx)==='undefined')?{}:_infx;_infx.cookie=function(){var info={};var properties={};function read(){var nameEQ=info.name+"=";var ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' ')c=c.substring(1,c.length);if(c.indexOf(nameEQ)==0)return c.substring(nameEQ.length,c.length);};return null;};function write(){var secure="";var expires="";if(info.days){var date=new Date();date.setTime(date.getTime()+(info.days*24*60*60*1000));expires="; expires="+date.toGMTString();};if(info.secure){secure=";secure";};document.cookie=info.name+"="+info.value+expires+secure+"; path=/";};return{create:function(jsonobj){info=jsonobj;write();},read:function(name){info.name=name;return read();},clear:function(name){info={name:name,value:'',days:-1};write();},enable:function(type,reload){if(typeof(pageTracker)!='undefined'){pageTracker._trackPageview('/'+type+'/cookies/enabled/');}
_infx.cookie.create({days:365,name:'_site_acceptance',value:1,secure:1});if(reload){location.reload(true);};},disable:function(type,reload){if(typeof(pageTracker)!='undefined'){pageTracker._trackPageview('/'+type+'/cookies/disabled/');}
_infx.cookie.create({days:365,name:'_site_acceptance',value:0,secure:1});if(reload){location.reload(true);};},overlay:function(){var setting=_infx.cookie.read('_site_acceptance');if(setting==null){_infx.cookie.create({days:1,name:'_cookie_check',value:1});var check=_infx.cookie.read('_cookie_check');_infx.cookie.clear('_cookie_check');if(check!=null){$('.cookie-overlay').css({"opacity":0.9}).fadeIn(500);properties.overlay_timer=setTimeout(_infx.cookie.allow,10000);$('.cookie-overlay').unbind();$('.cookie-overlay').bind('mouseover',function(){if(properties.overlay_timer)clearTimeout(properties.overlay_timer);}).bind('mouseout',function(){properties.overlay_timer=setTimeout(_infx.cookie.allow,5000);});};};},allow:function(){$('.cookie-overlay').fadeOut(500);_infx.cookie.enable('tracking',0);},settings:function(){_popup.create({html:$('.cookie-popup-content').html(),closeicon:false,plain:true,force:true,width:0.5});}};}();var current_option;var system_state='';var basket_state='';var timeouts={};var cached_memory={};var system_states={profile:{},registration:{},debug:{ecommerce_forms:0}};var advert_fade_timeouts=[];_infx=(typeof(_infx)==='undefined')?{}:_infx;_infx.control_change=function($el){var v=$el.val();if($el.attr('type')=='checkbox'){if($el.hasClass('state-other')){$el.parent().children('.state-input').css({"display":(($el.prop('checked'))?"block":"none")});}else{$el.parent().children('input[type="hidden"]').val($el.prop('checked')?1:0);}}else if($el.prop('tagName')=='SELECT'){var other=(v=='Other'||v=='other')?true:false;$el.parent().children('.state-other').css({"display":(other)?"block":"none"});$el.parent().children('input[type="hidden"]').val((other)?"":v);}else if($el.hasClass('state-other')){$el.parent().children('input[type="hidden"]').val(v);}}
_infx.load_form_state=function(form_state){for(var fname in form_state){var config=form_state[fname];var $element=$('input[name="'+fname+'"], select[name="'+fname+'"]');if(config.type=='checkbox'){$element.prop('checked',(config.value)?true:false).change();}else if(config.type=='checkbox_composite'){$element.parent().children('input[type="checkbox"]').prop('checked',(config.value)?true:false).change();}else if(config.type=='combo'){var $combo=$element;if($element.prop('tagName')!='SELECT'){$combo=$element.parent().children('select').eq(0);}
var value=config.value;if($combo.find('[value="'+config.value+'"]').length==0){if($combo.find('[value="Other"]').length!=0){value="Other";}
else if($combo.find('[value="other"]').length!=0){value="other";}}
$combo.val(value).change();}else{$element.val(config.value);}
var $other=$element.parent().find('.state-other');if($other.length!=0&&config.value!=""){if($other.attr('type')=='checkbox'){$other.prop('checked',true).change();}else if($other.prop('tagName')=='INPUT'){$other.val(config.value).change();}}}}
_infx.pca={address:null,bindings:{billing:{'company_name':'F_client.company_name','address_1':'F_client.billing_address_1','address_2':'F_client.billing_address_2','address_3':'F_client.billing_address_3','town':'F_client.billing_town','county':'F_client.billing_county','post_code':'F_client.billing_post_code','country_code':function(value){_infx.pca.setCountry('F_client.billing_country_id',value);}},delivery:{'company_name':'F_delivery_address.delivery_company_name','address_1':'F_delivery_address.delivery_address_1','address_2':'F_delivery_address.delivery_address_2','address_3':'F_delivery_address.delivery_address_3','town':'F_delivery_address.delivery_town','county':'F_delivery_address.delivery_county','post_code':'F_delivery_address.delivery_post_code','country_code':function(value){_infx.pca.setCountry('F_delivery_address.delivery_country_id',value);}},custom:null},setCountry:function(field,value){var country_id=$('select[name="'+field+'"] option[data-iso3="'+value+'"]').eq(0).val();$('select[name="'+field+'"]').val(country_id).change();},confirm:function(){$('.postcode-anywhere-popup-dialog input[name^="pca."]').each(function(idx){var matches=$(this).attr('name').match(/^pca\.(.*)$/);if(matches){var target=_infx.pca.bindings[_infx.pca.target][matches[1]];if(typeof(target)=='function'){target($(this).val());}else{$('input[name="'+target+'"]').val($(this).val()).change();}}});this.closePopup();},callback:{loaded:function(control){},error:function(control,error){},success:function(control,address){$('.postcode-anywhere-popup-dialog .popup-row.hidden').show();}},popup:function(target){if(target){this.target=target;}
$.ajax({url:_infx.scripts.infxsystem.widget,type:'post',data:{widget:'widget-postcode-anywhere.pl',mode:'popup',valid_json:true},dataType:'json',success:function(json){if(json.success){_popup.create({width:0.5,html:json.content,plain:true,closeicon:false,force:true});}}});},closePopup:function(){_popup.close();}};function CapturePlusCallback(control,address){_infx.pca.callback.success(control,address);}
function CapturePlusLoaded(control){_infx.pca.callback.loaded(control);}
function CapturePlusError(control,error){_infx.pca.callback.error(control,error);}
_infx.populate_login_interface=function(){$.ajax({url:_infx.scripts.infxsystem.widget,type:'post',data:{widget:'widget-login.pl',ac:'top_interface',valid_json:true,cache:false},dataType:'json',success:function(json){if(json.success){$('.top-login-interface').html(json.dialog_html);}}});}
_infx.ecommerce_images={init:function(){$('img.infx-product-pinch-zoomer').pinchzoomer({imageOptions:{preloaderUrl:"/images/infx-slick-slider-spinner.gif"},controlOptions:{alwaysShow:true}});$('.infx-product-slick-slide img').on('click',function(){$('.infx-product-main-image div div div img').attr('src',$(this).data('zoomimage'));});$('.infx-product-slick-slider').slick({"slidesToShow":4,"slidesToScroll":1,"autoplay":false,"autoplaySpeed":800,"centerMode":false,"fade":false,"pauseOnHover":true,"speed":300,"vertical":false,"infinite":false,"arrows":true,"dots":false,"responsive":[{"breakpoint":1024,"settings":{"arrows":true,"dots":false,"infinite":false,"slidesToShow":4}},{"breakpoint":800,"settings":{"arrows":true,"dots":false,"infinite":false,"slidesToShow":4}},{"breakpoint":540,"settings":{"arrows":true,"dots":false,"infinite":false,"slidesToShow":3}},{"breakpoint":340,"settings":{"arrows":true,"dots":false,"infinite":false,"slidesToShow":3}}]});}};_infx.client_form_mode=function(){var mode=null;if($('#profile_button').length||$('body').hasClass('SECTION-profile')){mode='profile';}else if($('#registration_button').length||$('body').hasClass('SECTION-registration')){mode='registration';}
if(mode==null){mode='registration';}
return mode;}
_infx.set_client_form_state=function(ident,state){var mode=_infx.client_form_mode();if(typeof(system_states[mode])!="undefined"){system_states[mode][ident]=state;}}
_infx.current_client_form_state=function(){var mode=_infx.client_form_mode();return system_states[mode];}
function rtnEl(id){return document.getElementById(id);}
function submit_form(json,config){if(typeof(config)=='undefined')config={};var frmObj=(typeof(config.selector)!='undefined')?$("form"+config.selector).get(0):rtnEl(json.frmname);if(frmObj){for(var n in json){var obj=rtnEl(n);if(obj){obj.value=json[n];}else if(n!='frmname'&&n!='val_list'&&n!='error_panel'){console.warn("function submit_form - can't set "+n+" in "+json.frmname+" to "+json[n]);}}
var ok_to_submit=1;if(json.val_list){if(verifylist(frmObj,json.val_list)){if(config){if(typeof(config.onsubmit)=='function'){ok_to_submit=config.onsubmit();}}}else{ok_to_submit=0;}}else{if(config){if(typeof(config.onsubmit)=='function'){ok_to_submit=config.onsubmit();}}}
if(ok_to_submit){frmObj.submit();}}else{console.error("function submit_form - can't find form with name "+json.frmname);}}
function submit_persistent_data(element,override_data){var persistence_data=$(element).closest('.infx-data-persistence').data();var className=undefined;if(typeof(persistence_data['class'])!='undefined'){className=persistence_data['class'];delete persistence_data['class'];}
var data=$.extend({},persistence_data,override_data);var form_data={};for(var p in data){var name=(className)?className+'.'+p:p;form_data[name]=data[p];}
submit_virtual_form(location.pathname,"POST",form_data);}
function submit_virtual_form(action,method,data){var form=$("<form/>");$(form).attr("action",action);$(form).attr("method",method);for(var p in data){var input=$("<input>").attr("type","hidden").attr("name",p).val(data[p]);$(form).append($(input));}
$(document.body).append(form);$(form).submit();}
function check_captcha(frmObj,captcha_target){var result=0;$.ajax({dataType:"json",url:"/cgi-bin/infxwidgets/widget-captcha.pl",data:{output:'json',ac:'check',code:$('#captcha-check-code').val(),md5:$('#captcha-check-sum').val(),valid_json:'1'},async:false,success:function(data){if(data.result==1){result=1;}else{generate_captcha(0,captcha_target);}}});return result;}
function generate_captcha(initial,target){var params={target:target,initial:initial,output:'json',valid_json:1};if(!initial){params.time=(new Date()).getTime();params.output='json';}
$.ajax({url:captcha_widget,type:'post',data:params,success:function(data){captcha_callback(initial,target,data);}});}
function dynamically_post_form(json){var oldfrmObj=document.getElementById('dynamic_form');if(oldfrmObj){document.body.removeChild(oldfrmObj);}
var frmObj=document.createElement('form');frmObj.setAttribute('action',json.action);frmObj.setAttribute('method','POST');frmObj.name='dynamic_form';frmObj.id='dynamic_form';for(var p in json.elements){var obj=rtnEl(json.elements[p]);if(obj){var input=document.createElement("input");input.name=obj.name;var value=obj.value;if(json.override){value=((json.override[obj.name])?json.override[obj.name]:obj.value);}
input.setAttribute('type','hidden');input.setAttribute('value',value);frmObj.appendChild(input);}}
document.body.appendChild(frmObj);document.forms['dynamic_form'].submit();}
function signup_for_newsletter(type,message){if(rtnEl('signup_name')){rtnEl('signup_name').value=(rtnEl('signup_name').value=='Your Name')?"":rtnEl('signup_name').value;}
if(rtnEl('signup_email')){rtnEl('signup_email').value=(rtnEl('signup_email').value=='your@email.com')?"":rtnEl('signup_email').value;}
if(validate_single_field(rtnEl('signup_email'),{'signup_email':'email'})){var name=(rtnEl('signup_name'))?rtnEl('signup_name').value:rtnEl('signup_email').value;$.ajax({url:_infx.scripts.newsletter,type:'post',data:{ac:'subscribe',json:1,name:name,email:rtnEl('signup_email').value,signup_type:type,successtext:escape(message)},success:function(data){newsletter_callback('newsletter_signup',data);}});}}
function signup_for_newsletter_db(type,message){signup_for_newsletter(type,message);}
function send_page_to_a_friend(message){if(rtnEl('friend_email')){rtnEl('friend_email').value=(rtnEl('friend_email').value=='friends.name@email.com'||rtnEl('friend_email').value=='their-name@email.com')?"":rtnEl('friend_email').value;}
if(validate_single_field(rtnEl('friend_email'),{'friend_email':'email'})){$.ajax({url:_infx.scripts.infxsystem.send,type:'post',data:{ac:'send_to_a_friend',friends_email:rtnEl('friend_email').value,recommended_page:location.href,successtext:message},success:function(data){$('#send_to_a_friend').html(data);}});}}
function campaign_subscription(type,selector){var params={ac:'subscribe',signup_type:type};$(selector+" input").each(function(idx){params[$(this).attr('name')]=$(this).val();});if(validate_single_field($(selector+" input[name='email']").get(0),{'email':'email'})){$.ajax({url:_infx.scripts.campaign,type:'post',data:params,dataType:'json',success:function(json){$(selector).html("<b title='"+json.message+"'>"+json.title+"</b>");}});}}
function findPos(obj){var curleft=curtop=0;if(obj.offsetParent){do{curleft+=obj.offsetLeft;curtop+=obj.offsetTop;}while(obj=obj.offsetParent);}
return[curleft,curtop];}
function keyCheck(e,checkcode){var keycode=(window.event)?event.keyCode:e.keyCode;return(keycode==checkcode)?true:false;}
function join_objects(){for(var x=1;x<arguments.length;x++){for(var p in arguments[x]){arguments[0][p]=arguments[x][p];}}}
function BC_datachange(obj,lcb_fieldname){if(rtnEl('datachange'))rtnEl('datachange').value=1;rtnEl(lcb_fieldname).value='';}
function toggle_panels(id_list,force){var id_array=id_list.split(',');for(var x=0;x<id_array.length;x++){toggle_panel(id_array[x],force);}}
function toggle_panel(id,force){var obj=rtnEl(id);if(obj)obj.style.display=(obj.style.display=='none'||force==1)?'block':'none';}
function toggle_panel_visibility(id,force){var obj=rtnEl(id);if(obj)obj.style.visibility=(obj.style.visibility=='hidden'||force==1)?'show':'hidden';}
function panel_control(id,display){var obj=rtnEl(id);if(obj)obj.style.display=display;}
function load_page(href){var check=location.href;check=check.replace(location.protocol+"//"+location.host,"");if(href!=check&&location.href!=href)location.href=href;}
function login_popup(json,callback){if(json.ac=='')return;$.ajax({url:login_widget,type:'post',data:json,success:function(data){if(typeof(callback)=='function'){callback(data);}else{popup_callback(data);}}});}
function profile_popup(json){if(json.ac==''){return false;};if(json.validate&&json.sendform){var validated=true;$('#'+json.sendform+' select, #'+json.sendform+' input').each(function(){var result=validate_single_field($(this).get(0),validate);validated=(!result)?false:validated;});if(!validated){return false;}};if(json.sendform){add_form_to_json(json,json.sendform);}
$.ajax({url:profile_widget,type:'post',data:json,success:function(data){popup_callback(data);}});return true;}
function option_list_popup(json){if(json.ac=='')return;$.ajax({url:product_widget,type:'post',data:json,success:function(data){option_list_callback(data);}});}
function add_form_to_json(json,formid){var frmobj=rtnEl(formid);var elements=frmobj.getElementsByTagName('input');for(var x=0;x<elements.length;x++){json[elements[x].id]=elements[x].value;}
var selectors=frmobj.getElementsByTagName('select');for(var x=0;x<selectors.length;x++){json[selectors[x].id]=selectors[x].value;}}
function write_review_popup(json){if(json.ac=='')return;$.ajax({url:review_widget,type:'post',data:json,success:function(data){write_review_callback(data);}});}
function quote_request(json){if(json.ac=='')return;$.ajax({url:product_widget,type:'post',data:json,success:function(data){quote_request_callback(data);}});}
function control_payment_gateways(json){var jq_payment_type=$("input[name=payment_type]");if(jq_payment_type.length==0){return;}
var payment_type=jq_payment_type.val();if(payment_type==json.type){return;}else if(json.type!=''){jq_payment_type.val(json.type)
payment_type=json.type;}
if(json.highlight==1){$('#payment_method div').each(function(index){if($(this).attr('id')=='payment_gateway_'+payment_type){$(this).addClass('option_on').removeClass('option_off');}else{$(this).addClass('option_off').removeClass('option_on');}});}
if(json.submit==1){_popup.create({mask:true});$.ajax({url:_infx.scripts.ecommerce.payment,type:'post',data:{ac:'ajax_form',type:payment_type},success:function(data){ajax_populate_form('dynamic_form_div','dynamic_form',data);if(typeof(json.callback)=='function'){json.callback();};}});}else if(json.load_form){var params={ac:'load_form',form_type:json.load_form,type:payment_type};if(rtnEl('mode')){params.mode=rtnEl('mode').value;}
$.ajax({url:_infx.scripts.ecommerce.payment,type:'post',data:params,success:function(data){callback_fill_payment_form(payment_type,json.highlight,data);if(typeof(json.callback)=='function'){json.callback();};}});}else{if(payment_type=='paypal'||payment_type=='google'){$('#payment_form').html("");}
if(json.highlight==1){setup_checkout_button(payment_type);}
if(typeof(json.callback)=='function'){json.callback();};}}
function setup_state_button(){var mode=_infx.client_form_mode();var $trigger_button=(mode=='registration')?$('#registration_button'):$('#profile_button');if($trigger_button.length!=0){$trigger_button.off('click');var state_errors=0;var current_states=_infx.current_client_form_state();for(var p in current_states){if(current_states[p]==0){state_errors++;}}
if(state_errors>0){$trigger_button.css({cursor:'default',opacity:0.6}).off('click');$('.infx-validation-result').addClass('infx-error-message').html("Please ensure you've corrected all errors in the form above.");}else{if(mode=='profile'){for(var p in{"passhash":null,"passhash_confirm":null}){if(typeof(validate['F_client.'+p])=='object'){validate['F_client.'+p].optional=1;}else if(typeof(validate['F_client.'+p])=='string'){validate['F_client.'+p]={type:validate['F_client.'+p],optional:1};}}
}
$trigger_button.css({cursor:'pointer',opacity:1}).on('click',function(){submit_form({'frmname':'main_form','val_list':validate,'ac':mode,'ac_type':'save_client'},{onsubmit:function(){$trigger_button.css({cursor:'default',opacity:0.6}).off('click');$trigger_button.find('td.m').html("Submitting&hellip;");return 1;}});});$('.infx-validation-result').removeClass('infx-error-message').html("");}}}
function setup_checkout_button(type){if($('#checkout_button')){$('#checkout_button .m').html(((type=='paypal')?'Checkout with Paypal':((type=='google')?"Checkout with Google":"Checkout")));$('#checkout_button').off('click');if(type==''){$('#checkout_button').css({cursor:'default',opacity:0.6}).on('click',function(){_popup.create({width:0.5,html:"Please ensure you have selected a <b>payment method</b>, before attempting to checkout.",autohide:2500,closeicon:false});});}else{$('#checkout_button').css({cursor:'pointer',opacity:1}).on('click',function(){var result=true;if($('input[name="billing_address_for_delivery"]').length){if($('input[name="billing_address_for_delivery"]').val()==1){result=copy_billing_to_delivery();if(result==false){use_alternative_delivery_address();}}else{}}
if(result){submit_form({'frmname':'main_form','val_list':validate,'ac':'process_payment','ac_type':'save_client'},{onsubmit:function(){$('#checkout_button').css({cursor:'default',opacity:0.6}).off('click');$('#checkout_button .m').html("Submitting&hellip;");return 1;}});}else{}});}}}
_infx.setup_check_email_form=function(selector){$(selector+' .check-email-btn').off().on('click',function(){_infx.check_email_unique(selector,$(selector+' input[name="F_email"]'),$(selector+' input[name="F_confirm_email"]'));});$(selector+' input[name="F_confirm_email"]').off('cut copy paste').on("cut copy paste",function(e){e.preventDefault();});}
_infx.check_email_unique=function(selector,$email,$confirm_email){if($email.length==0){console.error("_infx.check_email_unique - email input not found");return;}
_infx.validate.input.reset($email);_infx.validate.input.reset($confirm_email);var entered_email=$email.val()||"";if(entered_email.indexOf('.')==-1||entered_email.indexOf('@')==-1){_infx.validate.input.error($email,"Please enter a valid email address");}else{var params={ac:'validate_email',email:$email.val(),confirm_email:$confirm_email.val()};$(selector+' .check-email-spinner').show();$.ajax({url:_infx.scripts.ecommerce.ajax,type:'post',dataType:'json',data:params,success:function(data){var hide_spinner=true;if(data.invalid_email){_infx.validate.input.error($email,"Please ensure you have entered a valid email address");_infx.validate.input.error($confirm_email);}else if(data.invalid_email_domain){_infx.validate.input.error($email,"Please ensure you have entered a valid email address domain");_infx.validate.input.error($confirm_email);}else if(data.confirmation_email_missmatch){_infx.validate.input.error($email,"Please ensure the email addresses match");_infx.validate.input.error($confirm_email);}else{if(data.email_exists){$.ajax({url:_infx.scripts.infxsystem.widget,type:'post',dataType:'json',data:{ac:'do_forgot_password',widget:'widget-login.pl',F_recover_field:$email.val(),route:'existing_user',redirect:location.pathname,valid_json:1},success:function(response){var $form=$email.closest('div.infx-ecommerce-form-shell');_infx.validate.displayMessage({$form:$form,message:{title:response.message_title,body:response.message,state:response.message_state}});$(selector+' .check-email-spinner').hide();}});}else{_infx.validate.input.pass($email);_infx.validate.input.pass($confirm_email);location.reload(true);}
hide_spinner=false;}
if(hide_spinner){$(selector+' .check-email-spinner').hide();}}});}}
function callback_fill_payment_form(type,highlight,jsonstr){var json;eval("json = "+jsonstr+";");$('#payment_form').html(json.html);if(highlight==1){setup_checkout_button(type);}
_popup.close();}
function amend_product_list(product_id,mode,list_type){$.ajax({url:profile_widget,type:'post',data:{ac:'amend_product_list',mode:mode,list_type:list_type,product_id:product_id,option_string:""},success:function(data){var json;eval("json = "+data+";");if(json.ac=='display_dialog'){_popup.create({width:0.5,html:json.dialog_html,closeicon:false,plain:true,force:true});}}});}
function increase_product_list_qty(cnt){modify_quantity_input(1,'qty_'+cnt);}
function modify_quantity_input(adjustment,inputname){$('input[name="'+inputname+'"]').each(function(){$(this).val(function(idx,value){value=value.replace(/[^\d]/g,'');if(value==''){value=1;}
return((parseInt(value)+adjustment)<1)?1:(parseInt(value)+adjustment);});});}
function update_dyn_date(field,selects){var obj=rtnEl(field);if(obj){var select_array=selects.split(',');var s1=rtnEl(select_array[0]);var s2=rtnEl(select_array[1]);obj.value=s1.value+'/'+s2.value;}}
function change_card_detail(json){if(json.card_detail_id!=-1){var params={};params.ac='load_form';params.form_type='card';params.mode=system_state;params['F_card_detail.id']=json.card_detail_id;$.ajax({url:_infx.scripts.ecommerce.payment,type:'post',data:params,success:function(data){callback_change_card_detail('payment_form',data);}});}else{var obj=rtnEl('payment_type');if(obj)obj.value='';control_payment_gateways({'type':'','highlight':1});var payment_form_div=rtnEl('payment_form');if(payment_form_div)payment_form_div.innerHTML='';}}
function callback_change_card_detail(target_id,jsonstr){var json;eval("json = "+jsonstr+";");control_payment_gateways({'type':json.type,'highlight':1});$('#'+target_id).html(json.html);}
function change_product_option(json){console.error("function change_product_option is [deprecated]");}
function callback_change_product_option(jsonstr){console.error("function callback_change_product_option is [deprecated]");}
function change_product_multiple_options(json){var $product_options=$('div[id="options_'+json.product_id+'"] select');$product_options.each(function(){json[$(this).attr('id')]=$(this).val();});options_switch_product_image(json.product_id,$product_options);var required_replacements={};var unique_replacement_array=[];$('.-sys-price-replacement[data-product-id='+json.product_id+']').each(function(){required_replacements[$(this).data('price-replacement')]=1;});for(var p in required_replacements){unique_replacement_array.push(p);}
json.required_replacements=unique_replacement_array.join(",");setTimeout(function(){json.valid_json=1;$.ajax({url:product_widget,async:false,type:'post',data:json,dataType:'json',success:function(data){callback_change_product_multiple_options(data);}})},1);}
function options_switch_product_image(product_id,$product_options){var match_counts={};$product_options.each(function(){var option={name_id:String($(this).attr('id')).replace(/option_/,""),value_id:$(this).val()};$('.infx-product-slick-slide img').each(function(){if(String($(this).data('options')).indexOf(option.name_id+"="+option.value_id)!=-1){var slickIndex=undefined;if($('.infx-product-slick-slider').slickGoTo==undefined){slickIndex=$(this).parent().data('slick-index');}else{slickIndex=$(this).parent().attr('index');}
match_counts[parseInt(slickIndex,10)]=(match_counts[option.name_id])?(match_counts[option.name_id]+1):1;}});});var matches=[];for(var p in match_counts){matches.push({'index':p,'count':match_counts[p]});}
console.log(match_counts);console.log(matches);if(matches.length){matches=matches.sort(function(a,b){return a-b;});if($('.infx-product-slick-slider').slickGoTo==undefined){$('.infx-product-slick-slider').slick('slickGoTo',matches[0].index);}else{$('.infx-product-slick-slider').slickGoTo(matches[0].index);}
$('.infx-product-slick-slider img').eq(matches[0].index).click();}}
function callback_change_product_multiple_options(json){for(var json_property in json){if(json_property=='disable_add_button'){if(json[json_property]==1){$('.toggle-basket-btn').fadeTo('fast',.5);var onclick=$('.toggle-basket-btn').attr('onclick');if(typeof(onclick)!='undefined'&&onclick!=''&&onclick!=null){$('.toggle-basket-btn').attr('onclick',"").data('onclick',onclick);}else{var onmousedown=$('.toggle-basket-btn span').attr('onmousedown');if(typeof(onmousedown)!='undefined'&&onmousedown!=''){$('.toggle-basket-btn span').attr('onmousedown',"").data('onmousedown',onmousedown);}}}else if(json[json_property]==0){$('.toggle-basket-btn').fadeTo('fast',1);var onclick=$('.toggle-basket-btn').data('onclick');if(typeof(onclick)!='undefined'&&onclick!=''&&onclick!=null){$('.toggle-basket-btn').attr('onclick',onclick);}else{var onmousedown=$('.toggle-basket-btn span').data('onmousedown');if(typeof(onmousedown)!='undefined'&&onmousedown!=''){$('.toggle-basket-btn span').attr('onmousedown',onmousedown);}}}}else if(json_property=='replacements'){if(typeof json[json_property]=='object'){for(var p in json[json_property]){$('.-sys-price-replacement[data-product-id='+json.product_id+'][data-price-replacement="'+p+'"]').replaceWith(json[json_property][p]);}}}else if(json_property.indexOf("option_")!=-1){$("#"+json_property).replaceWith(json[json_property]);}else if(json_property.indexOf("option_string")!=-1){$("#"+json.product_id).val(json[json_property]);}else if(json_property.indexOf("stock_level_")!=-1){$('.'+json_property).html(json[json_property]);}else{$('#'+json_property).html(json[json_property]);}}}
function email(name,domain,suffix,text){var address=name+"\u0040"+domain+"."+suffix;var url="mailto:"+address;document.write("<a href=\""+url+"\">"+((!text)?address:text)+"</a>");}
function switch_advert_category(type,amount,target,category,control_type){var json={};json.type=type;json.dir=(type=='smallads')?'/dyn/_smallads/':'/dyn/_mainads/';json.amount=amount;json.category=category;json.control_type=control_type;json.ajax=1;$.ajax({url:advert_widget,type:'post',data:json,success:function(data){advert_callback(target,data);}});}
function toggle_advert_category(type,idx){$('.'+type+"-adverts .advert-category").css({'display':'none'});$('.'+type+"-adverts .filter-category-"+idx).css({'display':'block'});$('.'+type+"-adverts .tab").removeClass('on');$('.'+type+"-adverts .tab-"+idx).addClass('on');}
function delivery_charge_change_popop(){if(1){return;}
if(typeof(cached_memory.charge_change_popop)!='undefined'){return;}
if(timeouts.charge_change_popop)clearTimeout(timeouts.charge_change_popop);timeouts.charge_change_popop=setTimeout(function(){if(system_states.debug.ecommerce_forms){console.log("timeouts.charge_change_popop triggered");}
_popup.create({width:0.5,html:"<div id='popup_form'><div class='information_message'>Your changes may have affected the delivery charge please check before proceeding</div></div>",onload:function(){cached_memory.charge_change_popop=1;},onunload:function(){delete cached_memory.charge_change_popop;},autohide:2000,closeicon:false,plain:true});},1000);}
function checkout_form_control(config){client_form_control(config);}
function registration_form_control(config){client_form_control(config);}
function client_form_control(config){if(typeof(config.profile)=='undefined'){var mode=_infx.client_form_mode();config.profile=(mode=='profile')?1:0;}
if(typeof(config.obj)!='undefined'){config.profile=($(config.obj).parent().hasClass('profile-section'))?1:0;}
if(system_states.debug.ecommerce_forms){console.log("function client_form_control",config);}
if(config.ac=='use_billing_address_for_delivery'&&!config.profile){setup_delivery_address('billing',config);}else if(config.ac=='use_alternative_delivery_address'&&!config.profile){setup_delivery_address('delivery',config);}else if(config.ac=='change_carrier'){if(timeouts.change_carrier)clearTimeout(timeouts.change_carrier);timeouts.change_carrier=setTimeout(function(){if(system_states.debug.ecommerce_forms){console.log("timeouts.change_carrier triggered");}
$.ajax({url:_infx.scripts.ecommerce.ajax,type:'post',dataType:'json',data:{ac:'set_delivery_carrier',carrier_id:config.carrier_id},success:function(data){if(system_states.debug.ecommerce_forms){console.log("change_carrier callback",data);}
if(data.update_basket){delivery_charge_change_popop();multi_update_basket('main');}}});},1500);}else if(config.ac=='change_postcode'&&!config.profile){var params={ac:'set_delivery_postcode',profile:config.profile};if(config.type=='billing'){if($('input[name="billing_address_for_delivery"]').val()==1){params.delivery_postcode=$('input[name="F_client.billing_post_code"]').val();}else{return;}}else{params.delivery_postcode=config.delivery_postcode;}
if(timeouts.change_postcode)clearTimeout(timeouts.change_postcode);timeouts.change_postcode=setTimeout(function(){if(system_states.debug.ecommerce_forms){console.log("timeouts.change_postcode triggered");}
$.ajax({url:_infx.scripts.ecommerce.ajax,type:'post',dataType:'json',data:params,success:function(data){if(system_states.debug.ecommerce_forms){console.log("change_postcode callback",data);}
if(data.update_basket&&config.profile!=1){delivery_charge_change_popop();multi_update_basket('main');}}});},1000);}else if(config.ac=='change_state'){if(timeouts.change_state)clearTimeout(timeouts.change_state);timeouts.change_state=setTimeout(function(){if(system_states.debug.ecommerce_forms){console.log("timeouts.change_state triggered");}
var actions=['set_'+config.type+'_state'];var params={state_id:config.state_id,profile:config.profile};if(config.profile!=1){if(config.type=='billing'&&$('input[name="billing_address_for_delivery"]').val()==1){actions.push('set_delivery_state');config.display_delivery_charge_popup=1;}else if(config.type=='delivery'){config.display_delivery_charge_popup=1;}}
params.ac=actions.join(",");$.ajax({url:_infx.scripts.ecommerce.ajax,type:'post',dataType:'json',data:params,success:function(data){if(system_states.debug.ecommerce_forms){console.log("change_state callback",data);}
if(data.update_basket){if(config.display_delivery_charge_popup){delivery_charge_change_popop();}
multi_update_basket('main');}}});},750);}else if(config.ac=='change_country'){if(timeouts.change_country)clearTimeout(timeouts.change_country);timeouts.change_country=setTimeout(function(){if(system_states.debug.ecommerce_forms){console.log("timeouts.change_country triggered");}
var params={type:'state',form_type:config.type,country_id:config.country_id,profile:config.profile};var actions=['ajax_load_drop_down','post_code_label','mobile_phone_label','state_label','set_'+config.type+'_country'];if(config.profile!=1){if(config.type=='billing'){var tax_number_element=$("input[name='F_client.tax_number']");if(tax_number_element.length>0){actions.push('validate_tax_number');params.number=tax_number_element.val();}
if($('input[name="billing_address_for_delivery"]').val()==1){actions.push('set_delivery_country');config.display_delivery_charge_popup=1;}}else if(config.type=='delivery'){config.display_delivery_charge_popup=1;}}
params.ac=actions.join(",");$.ajax({url:_infx.scripts.ecommerce.ajax,type:'post',dataType:'json',data:params,success:function(data){if(system_states.debug.ecommerce_forms){console.log("change_country callback",data);}
var display_state=0;var state=$('.'+config.type+'-state');var county=$('.'+config.type+'-county');if(data.records)display_state=(data.records.length>0)?1:0;var state_combo=$('form[name="main_form"] select[name="'+((config.type=='billing')?"F_client.billing_state_id":"F_delivery_address.delivery_state_id")+'"]');var county_input=$('form[name="main_form"] input[name="'+((config.type=='billing')?"F_client.billing_county":"F_delivery_address.delivery_county")+'"]');if(display_state){state_combo.empty().append($('<option/>').attr('value',-1).html("[ Select ]"));for(var x=0;x<data.records.length;x++){var option=$('<option/>').attr('value',data.records[x].id).html(data.records[x].name);if(data.records[x].id==state_combo.val())option.attr('checked','checked');state_combo.append(option);}
cached_memory[config.type+'_county']=county_input.val();if(cached_memory[config.type+'_state_id']){state_combo.val(cached_memory[config.type+'_state_id']);}
county_input.val("");county.css({'display':'none'});state.css({'display':'block'});if(config.type=='billing'&&$('input[name="billing_address_for_delivery"]').val()==1){$('form[name="main_form"] select[name="F_delivery_address.delivery_country_id"]').val(config.country_id).change();}}else{cached_memory[config.type+'_state_id']=state_combo.val();if(cached_memory[config.type+'_county']){county_input.val(cached_memory[config.type+'_county']);}
state_combo.val(-1);state.css({'display':'none'});county.css({'display':'block'});}
if(data['post-code-label'])$('.'+config.type+'-post-code-label').html(data['post-code-label']);if(data['mobile-phone-label'])$('.mobile-phone-label').html(data['mobile-phone-label']);if(data['state-label'])$('.state-label').html(data['state-label']);if(data.change_tax_number_state){field_state_callback('tax_number',rtnEl('F_client.tax_number'),data);}
if(data.update_basket&&config.profile!=1){if(config.display_delivery_charge_popup){delivery_charge_change_popop();}
multi_update_basket('main');}}});},750);}else if(config.ac=='validate_tax_number'){if(timeouts.validate_tax_number)clearTimeout(timeouts.validate_tax_number);timeouts.validate_tax_number=setTimeout(function(){if(system_states.debug.ecommerce_forms){console.log("timeouts.validate_tax_number triggered");}
$.ajax({url:_infx.scripts.ecommerce.ajax,type:'post',dataType:'json',data:{ac:'validate_tax_number',number:$(config.el).val(),profile:config.profile},success:function(data){if(system_states.debug.ecommerce_forms){console.log("validate_tax_number callback",data);}
field_state_callback('tax_number',config.el,data);}});},750);}else if(config.ac=='validate_username'){if(timeouts.validate_username)clearTimeout(timeouts.validate_username);timeouts.validate_username=setTimeout(function(){if($(config.el).val()==""){return;}
if(system_states.debug.ecommerce_forms){console.log("timeouts.validate_username triggered");}
$.ajax({url:_infx.scripts.ecommerce.ajax,type:'post',dataType:'json',data:{ac:'validate_username',username:$(config.el).val(),profile:config.profile},success:function(data){if(system_states.debug.ecommerce_forms){console.log("validate_username callback",data);}
field_state_callback('username',config.el,data);}});},750);}else if(config.ac=='validate_password'){if(timeouts.validate_password)clearTimeout(timeouts.validate_password);timeouts.validate_password=setTimeout(function(){if($(config.el).val()==""){if(config.profile){_infx.validate.input.reset($(config.el));}
return;}
if(system_states.debug.ecommerce_forms){console.log("timeouts.validate_password triggered");}
$.ajax({url:_infx.scripts.ecommerce.ajax,type:'post',dataType:'json',data:{ac:'validate_password',password:$(config.el).val(),profile:config.profile},success:function(data){if(system_states.debug.ecommerce_forms){console.log("validate_password callback",data);}
field_state_callback('password',config.el,data);}});},750);}else if(config.ac=='validate_password_confirm'){if(timeouts.validate_password_confirm)clearTimeout(timeouts.validate_password_confirm);timeouts.validate_password_confirm=setTimeout(function(){if($(config.el).val()==""&&$(config.el_confirm).val()==""){_infx.validate.input.reset($(config.el_confirm));return;}else if($(config.el_confirm).val()!=""){if($(config.el).val()!=$(config.el_confirm).val()){_infx.validate.input.error($(config.el_confirm),"Please ensure the two passwords match.");}else{_infx.validate.input.pass($(config.el_confirm));}
setup_state_button();}},750);}else if(config.ac=='validate_email'){if(timeouts.validate_email)clearTimeout(timeouts.validate_email);timeouts.validate_email=setTimeout(function(){if(system_states.debug.ecommerce_forms){console.log("timeouts.validate_email triggered");}
$.ajax({url:_infx.scripts.ecommerce.ajax,type:'post',dataType:'json',data:{ac:'validate_email',email:$(config.el).val(),profile:config.profile},success:function(data){if(system_states.debug.ecommerce_forms){console.log("validate_email callback",data);}
field_state_callback('email',config.el,data);}});},750);}}
function setup_delivery_address(using,config){var selectors={};var acs=['set_delivery_postcode','set_delivery_country'];if(using=='billing'){selectors.country_id='select[name="F_client.billing_country_id"]';selectors.delivery_postcode='input[name="F_client.billing_post_code"]';var state_selector='select[name="F_client.billing_state_id"]';if($(state_selector).length){selectors.state_id=state_selector;acs.push('set_delivery_state');}}else if(using=='delivery'){selectors.country_id='select[name="F_delivery_address.delivery_country_id"]';selectors.delivery_postcode='input[name="F_delivery_address.delivery_post_code"]';var state_selector='select[name="F_delivery_address.delivery_state_id"]';if($(state_selector).length){selectors.state_id=state_selector;acs.push('set_delivery_state');}}
var callback=function(){var params={};for(var p in selectors){params[p]=$(selectors[p]).val();}
params.ac=acs.join(',');if(system_states.debug.ecommerce_forms){console.log("using: ",using," params: ",params," config: ",config);}
if(timeouts.setup_delivery_address)clearTimeout(timeouts.setup_delivery_address);timeouts.setup_delivery_address=setTimeout(function(){if(system_states.debug.ecommerce_forms){console.log("timeouts.setup_delivery_address triggered");}
$.ajax({url:_infx.scripts.ecommerce.ajax,type:'post',dataType:'json',data:params,success:function(data){if(system_states.debug.ecommerce_forms){console.log("setup_delivery_address callback",data);}
if(data.update_basket){delivery_charge_change_popop();multi_update_basket('main');}}});},1000);};if($('.existing-delivery-address-selector').length){var switch_delivery_address_id=undefined;if(using=='delivery'){switch_delivery_address_id=$('.existing-delivery-address-selector .default-delivery-address input').val();}
if(switch_delivery_address_id==undefined){switch_delivery_address_id=$('.existing-delivery-address-selector .blank-delivery-address input').val();}
if(switch_delivery_address_id==undefined){console.error("[FATAL] - setup_delivery_address - no blank or default delivery address available.");}else{_infx.delivery.address.load({params:{delivery_address_id:switch_delivery_address_id,profile:0},callback:callback});}}else{callback();}}
function stop_propagation(event){if(!event)var event=window.event;event.cancelBubble=true;if(event.stopPropagation)event.stopPropagation();return false;}
function BC_cbxv(obj,nm,offval,onval){var ipobj=gfindobj(obj,nm);var cbobj=gfindobj(obj,"CB_"+nm);if(!cbobj||!ipobj)return 0;if(cbobj.checked){ipobj.value=onval;}else{ipobj.value=offval;}
return 1;}
function gfindobj(obj,reqid){for(var p in obj.childNodes){var cobj=obj.childNodes[p];if(cobj&&cobj.id!=null){if(cobj.id==reqid)return cobj;}
if(cobj&&(cobj.childNodes)&&(cobj.childNodes.length>0)){var ob=gfindobj(cobj,reqid);if(ob)return ob;}}
return null;}
function toggle_filter_display(element,id,type){var target=rtnEl(id);if(type=='options'){target.style.display=(target.style.display!='none')?'none':'inline';element.innerHTML=(target.style.display=='none')?'More...':'Less';}else if(type=='rows'){var morerowtxt=rtnEl('morerowtxt');target.style.display=(target.style.display!='none')?'none':'inline';morerowtxt.innerHTML=(target.style.display=='none')?'More rows':'Less rows';}}
function format_currency(expr){return format_currency_commas(format_decimal_places(expr,2));}
function format_currency_commas(nStr){nStr+='';x=nStr.split('.');x1=x[0];x2=x.length>1?'.'+x[1]:'';var rgx=/(\d+)(\d{3})/;while(rgx.test(x1)){x1=x1.replace(rgx,'$1'+','+'$2');}
return x1+x2;}
function format_decimal_places(expr,decplaces){var str=""+Math.round(eval(expr)*Math.pow(10,decplaces));while(str.length<=decplaces){str="0"+str;}
var decpoint=str.length-decplaces
var decimal=".";if(decplaces==0){decimal="";}
return str.substring(0,decpoint)+decimal+str.substring(decpoint,str.length);}
function ajax_populate_form(target_id,form_id,returned){if(document.getElementById(target_id)){document.getElementById(target_id).innerHTML=returned;if(document.forms[form_id]){document.forms[form_id].submit();}}}
function ajax_submit_form(json){if(json.disallow_simultaneous_ajax_requests&&_infx.ajax_request_in_progress){return false;}
var frmObj=rtnEl(json.frmname);if(frmObj){for(var n in json){var obj=frmObj[n];if(obj){obj.value=json[n];}}
var params={};var elements=frmObj.elements;for(var x=0;x<elements.length;x++){var el=elements[x];if(el.type=='radio'){if(el.checked)params[el.name]=el.value;}else{if(el.name){params[el.name]=el.value;}}}
if(json.val_list){if(verifylist(frmObj,json.val_list)){$.ajax({url:json.script,type:'post',data:params,beforeSend:function(jqXHR,settings){if(json.disallow_simultaneous_ajax_requests){_infx.ajax_request_in_progress=true;}},error:function(data){if(json.disallow_simultaneous_ajax_requests){_infx.ajax_request_in_progress=false;}},success:function(data){if(typeof json.callback=='function'){json.callback();}else{eval(json.callback);}
if(json.disallow_simultaneous_ajax_requests){_infx.ajax_request_in_progress=false;}}});}}else{$.ajax({url:json.script,type:'post',data:params,beforeSend:function(jqXHR,settings){if(json.disallow_simultaneous_ajax_requests){_infx.ajax_request_in_progress=true;}},error:function(data){if(json.disallow_simultaneous_ajax_requests){_infx.ajax_request_in_progress=false;}},success:function(data){if(typeof json.callback=='function')json.callback();else eval(json.callback);if(json.disallow_simultaneous_ajax_requests){_infx.ajax_request_in_progress=false;}}});}}else{alert("Can't find form with name "+json.frmname);}}
function upload_widget_get_initial_data(type,mode){$.ajax({url:_infx.scripts.infxsystem.widget,type:'post',dataType:'json',data:{ac:'get_initial_data',widget:_infx.scripts.widgets.upload,type:type,mode:mode,valid_json:true},success:function(data){if(data.src){$('.upload-widget-'+type+'-'+mode).attr('src',data.src+"?"+new Date().getTime());}}});}
function upload_widget_display_uploading_message(type,mode){$('.upload-widget-message')
.text('Uploading...')
.removeClass("upload-widget-"+type+"-"+mode+"-error")
.addClass("upload-widget-"+type+"-"+mode+"-uploading")
.fadeIn();}
function upload_widget_init(type,mode){if($.browser.msie||$.browser.opera){$('.upload-widget-'+type+"-"+mode).attr('onclick','').off('click').css('cursor','auto').attr('title','');$('.upload-widget-instructions').hide();$('.upload-widget-submit-button').click(function(){upload_widget_display_uploading_message(type,mode);})}else{$('#upload-widget-form').hide();$('.upload-widget-input').change(function(){upload_widget_submit_form(type,mode);});}}
var upload_widget_submit_form=function(type,mode){$('#upload-widget-form').submit();upload_widget_display_uploading_message(type,mode);}
function select_image_option(config,option_name_id,option_value_id,el){change_product_option(config);$(el).parent().removeClass('error').find('.product-image-option').removeClass('selected');$(el).addClass('selected');$('input[name="option_'+option_name_id+'"]').val(option_value_id);}
function advert_fade_hover(el,inselector,outselector,speed){$(el).find(inselector).fadeOut(speed).parent().find(outselector).off('mouseout').on('mouseout',function(){if($(this).data('timeout-idx')==null){$(this).data('timeout-idx',advert_fade_timeouts.length);}
var p=this;var timeout_idx=$(this).data('timeout-idx');if(advert_fade_timeouts[timeout_idx])clearTimeout(advert_fade_timeouts[timeout_idx]);advert_fade_timeouts[timeout_idx]=setTimeout(function(){$(p).fadeOut(speed);$(el).find(inselector).fadeIn(speed);},150);}).off('mouseover').on('mouseover',function(){var timeout_idx=$(this).data('timeout-idx');if(advert_fade_timeouts[timeout_idx])clearTimeout(advert_fade_timeouts[timeout_idx]);}).fadeIn(speed);}
function use_alternative_delivery_address(){if(system_states.debug.ecommerce_forms){console.log("function use_alternative_delivery_address()");}
$('.use-alternative-address').css({'display':'none'});$('.use-billing-address').css({'display':'table'});$('.delivery-address-fields').show();$('input[name="billing_address_for_delivery"]').val(0);var config={'type':'billing',ac:'use_alternative_delivery_address'};client_form_control(config);}
function use_billing_address_for_delivery(){if(system_states.debug.ecommerce_forms){console.log("function use_billing_address_for_delivery()");}
$('.use-alternative-address').css({'display':'table'});$('.use-billing-address').css({'display':'none'});$('.delivery-address-fields').hide();$('input[name="billing_address_for_delivery"]').val(1);var config={'type':'billing',ac:'use_billing_address_for_delivery'};client_form_control(config);}
function copy_billing_to_delivery(){var all_fields_set=1;$('#delivery_address fieldset input, #delivery_address fieldset select').each(function(idx){var set_value=null;var delivery_input_name=$(this).attr('name');var billing_input_name=delivery_input_name.replace(/_delivery_address/,'_client');billing_input_name=billing_input_name.replace(/delivery_/,'billing_');billing_input_name=billing_input_name.replace(/billing_company_name/,'company_name');if(delivery_input_name=='F_delivery_address.client_id'||delivery_input_name=='F_delivery_address.id'){return;}else if(delivery_input_name=='F_delivery_address.delivery_name'){var title=$('select[name="F_client.title"]').val();set_value=((title==-1)?"":title)+" "+$('input[name="F_client.forename"]').val()+" "+$('input[name="F_client.surname"]').val();}else{set_value=$('input[name="'+billing_input_name+'"], select[name="'+billing_input_name+'"]').val()}
$(this).val(set_value);if(delivery_input_name=='F_delivery_address.delivery_state_id'&&$('.delivery-state').css('display')=="block"&&$(this).val()=="-1"){all_fields_set=0;}else if(delivery_input_name=='F_delivery_address.delivery_country_id'&&$(this).val()=="-1"){all_fields_set=0;}
if(system_states.debug.ecommerce_forms){console.log("billing: "+billing_input_name+" delivery: "+delivery_input_name+" set value: "+set_value+" all fields set: "+all_fields_set);}});$('input[name="F_delivery_address.updated"]').val("");if(!all_fields_set){_popup.create({width:0.5,html:"Please check your delivery address as we may not be able to deliver to the address you have defined as your billing address.",autohide:5000,closeicon:false});return false;}
return true;}
function hexDump(data){var outputString=new String();var addressPadding="0000000";var line=0;var countForCurrentLine=0;outputString+="Address   0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f \n"+
"---------------------------------------------------------\n"+
"00000000  ";for(var i=0;i<data.length;i++){countForCurrentLine++
var byteData=data.substr(i,1);var number=data.charCodeAt(i)&0xff;var byteHex=(number<16)?"0"+number.toString(16):number.toString(16);;outputString+=byteHex+" ";if(countForCurrentLine==16){countForCurrentLine=0;line++;outputString+="\n"+addressPadding.substr(0,7-line.toString(16).length)+line.toString(16)+"0  ";}}
return outputString;}
function remove_link_focus(){for(var i=0;i<document.links.length;i++){document.links[i].onfocus=blur_link;}}
function blur_link(){if(this.blur){this.blur();}}
function slick_slider_init(){$(window).trigger('slick_slider_init');}
$(document).ready(function(){_infx.basket.setup();remove_link_focus();var search=location.search.split("?");if(search.length==2){var data={};var pairs=search[1].split("&");for(var x=0;x<pairs.length;x++){var nv=pairs[x].split("=");data[nv[0]]=nv[1];}
if(data.login=='true'){login_popup({'ac':'login_dialog'});}}
if($('#navigation').css('position')=='fixed'){_infx.config.scrollTopOffset+=$('#navigation').height();}
if($('.top-login-interface').length!=0){_infx.populate_login_interface();}
if(location.pathname.search(/\/secure\/(login|registration|forgot-password)\//)==0){$("a[href='/secure/forgot-password/'], a[href='/secure/registration/'], a[href='/secure/login/']").attr('href',function(idx,href){if(location.search!=""){var safe_location_search=String(location.search).replace(/[^\?\w\-\/_=\d]+$/gi,"");return href+safe_location_search;};});};});_infx=(typeof(_infx)==='undefined')?{}:_infx;_infx.delivery={widget:'widget-profile.pl',address:{debug:0,load:function(input){if(this.debug){console.log('_infx.delivery.address.load called',input);};this.disable();input.params.ac='load_delivery_address';input.params.dataview=(input.params.profile==1)?2:1;this.request(input.params,function(response){_infx.callbacks.delivery_address({json:response,target_id:(input.params.profile==1)?'profile_delivery_address':'delivery_address',profile:input.params.profile});if(typeof input.callback==='function'){input.callback();}
_infx.delivery.address.enable();});},remove:function(input){if(this.debug){console.log('_infx.delivery.address.remove called',input);};input.params.ac='remove_delivery_address';this.request(input.params,function(response){var $form=$('#profile_delivery_address').closest('div.infx-ecommerce-form-shell');_infx.validate.displayMessage({$form:$form,message:{body:response.message,title:response.message_title,state:response.message_state}});_infx.delivery.address.load({params:{profile:1}});});},setDefault:function(input){if(this.debug){console.log('_infx.delivery.address.setDefault called',input);};input.params.ac='set_default_delivery_address';this.request(input.params,function(response){if(response.success){$('.existing-delivery-address-row').removeClass('default-delivery-address');$('.existing-delivery-address-row input[name="select_delivery_address_id"][value="'+input.params.delivery_address_id+'"]').parent().addClass('default-delivery-address');}
var $form=$('#profile_delivery_address').closest('div.infx-ecommerce-form-shell');_infx.validate.displayMessage({$form:$form,message:{body:response.message,title:response.message_title,state:response.message_state}});});},request:function(params,onsuccess){if(this.debug){console.log('_infx.delivery.address.request called params:',params);};params.widget=_infx.delivery.widget;params.valid_json=true;params.ajax=1;$.ajax({url:_infx.scripts.infxsystem.widget,dataType:'json',type:'post',data:params,success:(typeof(onsuccess)=='function')?onsuccess:function(){}});},inputs:function(){return $('.delivery-address-fields .ajax-target input, .delivery-address-fields .ajax-target select');},disable:function(){var $inputs=this.inputs();$inputs.prop('disabled',true).css({opacity:0.5});},enable:function(){var $inputs=this.inputs();$inputs.prop('disabled',false).css({opacity:1});}}};function change_delivery_address(json){_infx.delivery.address.load({params:json});};function set_default_delivery_address(json){_infx.delivery.address.setDefault({params:json});};function remove_delivery_address(json){_infx.delivery.address.remove({params:json});};_infx=(typeof(_infx)==='undefined')?{}:_infx;_infx.callbacks={debug:0,init:function(input){if(this.debug){console.log('_infx.callbacks.init called',input);};if(typeof(input.json)=='string'){var jsonstr=input.json;if(typeof(JSON)!='undefined'&&typeof(JSON.parse)=='function'){try{input.json=JSON.parse(jsonstr);}catch(e){if(this.debug){console.warn("unable to parse JSON using browser parse method",e);}};};if(typeof(input.json)!='object'){eval("input.json = "+jsonstr+";");};}else if(typeof(input.json)=='object'){}else{console.error("invalid JSON parsed to init method");};return input;},newsletter:function(input){input=this.init(input);if(this.debug){console.log('_infx.callbacks.newsletter called',input);};if(input.id){$('#'+input.id).html("<b>"+input.json.title+"</b><br/>"+input.json.message);return 1;};return 0;},popup:function(input){input=this.init(input);if(this.debug){console.log('_infx.callbacks.popup called',input);};if(input.message){multi_update_basket('main');_popup.create({width:0.5,html:"<div id='popup_form'><div class='close' onmousedown=\"_popup.close();\" title='Close this popup'>&nbsp;<\/div><h2 style='margin:0px;'>Add Promo Code<\/h2><div id='message' style='margin:0px;background-color:"+json.message_style+";width:437px;'>"+json.message+"<\/div><div class='clear'><\/div><\/div>",closeicon:false,plain:true});return 1;};return this.base(input);},login:function(input){input=this.init(input);if(this.debug){console.log('_infx.callbacks.login called',input);};if(input.json.logged_in){if(typeof _infx.bespoke!=='undefined'){if(typeof _infx.bespoke.onloginsuccess=='function'){return _infx.bespoke.onloginsuccess(input.json,function(){_infx.callbacks.base(input);});}}}
return this.base(input);},logout:function(input){input=this.init(input);if(this.debug){console.log('_infx.callbacks.logout called',input);};if(input.json.logged_out){if(typeof _infx.bespoke!=='undefined'){if(typeof _infx.bespoke.onlogoutsuccess=='function'){return _infx.bespoke.onlogoutsuccess(input.json,function(){_infx.callbacks.base(input);});}}}
return this.base(input);},promo:function(input){input=this.init(input);if(this.debug){console.log('_infx.callbacks.promo called',input);};multi_update_basket('main');input.json.popup=(input.json.popup_message)?true:false;display_message(input.json.message,input.json.message_class);return 1;},basket:function(input){input=this.init(input);if(this.debug){console.log('_infx.callbacks.basket called',input);};if(input.json.dialog_html){_popup.create({width:0.5,html:input.json.dialog_html,closeicon:false,plain:true,force:true});}else if(input.json.message&&input.json.message!=''&&input.json.ac!='add_next_item'){_popup.create({width:0.5,html:"<div id='popup_form'><div class='"+((input.json.message_class)?input.json.message_class:"add_to_basket_message")+"'>"+input.json.message+"</div></div>",closeicon:false,plain:true,autohide:((input.json.message_delay&&input.json.message_delay!='')?input.json.message_delay:1000),force:true});};if(input.json.ac=='display_event_options'){var event_option_popup_config={width:0.5,html:input.json.event_option_html,onload:function(){eval(input.json.event_javascript);},onunload:closePlanPopup,closeicon:false,plain:true};if(input.json.event_type=='seated'){_popup.create({width:0.5,html:"<div id='popup_form'><div class='information_message'>When making your ticket selection, please consider other customers and avoid leaving single seats empty.</div><div class='infx-button'><button class='block-link' onclick='_popup.close();'><span class='button-text'>OK</span></button></div><div class='clear'></div>",force:true});}else{event_option_popup_config.force=true;};_popup.create(event_option_popup_config);_infx.basket.spinner({show:false});return 1;}else if(input.json.ac=='update_mini_basket'){multi_basket_control(input.json.mode,'mini');return 1;}else if(input.json.ac=='update_mobile_basket'){multi_basket_control(input.json.mode,'mobile');return 1;}else if(input.json.ac=='update_slide_basket'){multi_basket_control(input.json.mode,'slide');return 1;}else if(input.json.ac=='add_next_item'){multiple_add_to_basket();return 1;}else if(input.json.ac=='update_basket'){multi_update_basket('main');return 1;}else if(input.json.ac=='checkout_redirect'){location.href='/checkout/';return 1;};return this.base(input);},multi_basket:function(input){input=this.init(input);if(this.debug){console.log('_infx.callbacks.multi_basket called',input);};var $target=$('#'+input.type+'basket');if(input.json.message&&input.json.message!=''){_popup.create({width:0.5,html:"<div id='popup_form'><div class='"+((input.json.message_class)?input.json.message_class:"add_to_basket_message")+"'>"+input.json.message+"</div></div>",closeicon:false,plain:true});setTimeout(function(){_popup.close();},((input.json.message_delay&&input.json.message_delay!='')?input.json.message_delay:1000));};if($target.length>0){$target.html(input.json.content);if(input.mode=='expand'){$target.removeClass('basket-collapsed').addClass('basket-expanded');}else{$target.removeClass('basket-expanded').addClass('basket-collapsed');}};_infx.basket.spinner({show:false});return 1;},main_basket:function(input){input=this.init(input);if(this.debug){console.log('_infx.callbacks.main_basket called',input);};if(input.json.message&&input.json.message!=''){_popup.create({width:0.5,html:"<div id='popup_form'><div class='"+((input.json.message_class)?input.json.message_class:"add_to_basket_message")+"'>"+input.json.message+"</div></div>",closeicon:false,plain:true});setTimeout(function(){_popup.close();},((input.json.message_delay&&input.json.message_delay!='')?input.json.message_delay:1000));};$('#checkout #form').css({'display':(input.json.content.indexOf("<!--[EMPTY BASKET]-->")!=-1)?'none':'block'});$('#'+input.target_id).html(input.json.content);return 1;},advert:function(input){input=this.init(input);if(this.debug){console.log('_infx.callbacks.advert called',input);};$('#'+input.json.control_type).html(input.json.control_html);$('#'+target).html(json.content);return 1;},captcha:function(input){input=this.init(input);if(this.debug){console.log('_infx.callbacks.captcha called',input);};var selector="";if(typeof(input.target)!='undefined'){selector="#"+input.target;};if(input.initial){$(selector).html(input.json.html);}else{if(input.json.check_sum&&input.json.captcha_image){$(selector+' #captcha-check-sum').val(input.json.check_sum);$(selector+' #captcha-image').attr('src',input.json.captcha_image);}};return 1;},upload_widget:function(input){input=this.init(input);if(this.debug){console.log('_infx.callbacks.upload_widget called',input);};if(input.json.success){if(typeof input.json.src!=='undefined'&&input.json.src!=''){$('.upload-widget-'+input.json.type+"-"+input.json.mode).attr('src',input.json.src+"?"+new Date().getTime());}
$('.upload-widget-message').text('').hide();}else{$('.upload-widget-message').text(input.json.message).addClass("upload-widget-"+input.json.type+"-"+input.json.mode+"-error").removeClass("upload-widget-"+input.json.type+"-"+input.json.mode+"-uploading").fadeIn();};return 1;},field_state:function(input){input=this.init(input);if(this.debug){console.log('_infx.callbacks.field_state called',input);};if(input.type=='tax_number'){if(input.json.exemption_state_changed){multi_update_basket('main');};if(input.json.tax_number_valid){_infx.validate.input.pass($(input.el),"You have entered a valid tax number.");}else if(input.json.tax_number_invalid){_infx.validate.input.error($(input.el),"Please ensure you have entered a valid tax number, it must include the country prefix.");}else{_infx.validate.input.reset($(input.el));};return 1;}else if(input.type=='username'){if(input.json.username_exists){_infx.validate.input.error($(input.el),input.json.username_invalid_message||"Sorry, this username is already taken.");}else if(input.json.username_invalid){_infx.validate.input.error($(input.el),input.json.username_invalid_message||"Sorry, this username is invalid.");}else{_infx.validate.input.pass($(input.el));};return 1;}else if(input.type=='password'){if(input.json.password_invalid){_infx.validate.input.error($(input.el),input.json.password_invalid_message||"Sorry, this password is invalid.");}else{_infx.validate.input.pass($(input.el));};return 1;}else if(input.type=='email'){if(!input.json.email_exists){if(input.json.invalid_email){_infx.validate.input.error($(input.el),"Please ensure you have entered a valid email address");}else{_infx.validate.input.pass($(input.el));}}else{_infx.validate.input.error($(input.el),"The email address entered is already present in our database.");};return 1;};return this.base(input);},write_review:function(input){input=this.init(input);if(this.debug){console.log('_infx.callbacks.write_review called',input);};if(input.json.ac=='display_dialog'){_popup.create({html:input.json.dialog_html,closeicon:false,plain:true,force:true,onload:function(){$('#popup_form .rateit').rateit();},width:0.5});return 1;};return this.base(input);},delivery_address:function(input){if(this.debug){console.log('_infx.callbacks.delivery_address called',input);};$('#'+input.target_id+' .ajax-target').html(input.json.html);if(input.profile!=1){_popup.close();}},base:function(input){if(this.debug){console.log('_infx.callbacks.base invoked',input);};if(input.json.ac=='display_dialog'){_popup.create({html:input.json.dialog_html,closeicon:false,plain:true,force:true,width:0.5});return 1;}else if(input.json.ac=='refresh'){window.location.reload(true);return 1;}else if(input.json.ac=='safe_refresh'){var href="";if(typeof(input.json.refresh_target)!='undefined'){href=input.json.refresh_target;}else{href=location.href;}
href=href.replace(/#.*$/,'');var separater=(href.indexOf('?')!=-1)?"&":"?";load_page(href+separater+'time='+new Date().getTime());return 1;};return 0;}};function newsletter_callback(id,jsonstr){_infx.callbacks.newsletter({id:id,json:jsonstr});};function popup_callback(jsonstr){_infx.callbacks.popup({json:jsonstr});};function option_list_callback(jsonstr){_infx.callbacks.popup({json:jsonstr});};function write_review_callback(jsonstr){_infx.callbacks.write_review({json:jsonstr});};function quote_request_callback(jsonstr){_infx.callbacks.popup({json:jsonstr});};function promo_callback(jsonstr){_infx.callbacks.promo({json:jsonstr});};function basket_callback(jsonstr){_infx.callbacks.basket({json:jsonstr});};function multi_basket_callback(type,mode,jsonstr){_infx.callbacks.multi_basket({type:type,mode:mode,json:jsonstr});};function main_basket_callback(target_id,jsonstr){_infx.callbacks.main_basket({target_id:target_id,json:jsonstr});};function advert_callback(target,jsonstr){_infx.callbacks.advert({target:target,json:jsonstr});};function field_state_callback(type,el,json){_infx.callbacks.field_state({type:type,el:el,json:json});};function upload_widget_callback(json){_infx.callbacks.upload_widget({json:json});};function captcha_callback(initial,target,jsonstr){_infx.callbacks.captcha({initial:initial,target:target,json:jsonstr});};function promo_callback_with_popup_message(jsonstr){_infx.callbacks.promo({json:jsonstr,popup:true});};function callback_delivery_address(target_id,profile,jsonstr){_infx.callbacks.delivery_address({json:jsonstr,target_id:target_id,profile:profile});};_infx=(typeof(_infx)==='undefined')?{}:_infx;_infx.profile={debug:0,locked:false,update:function($el,config,callback){if(this.isLocked()){return false;}
this.lock();if(_infx.profile.debug>1){console.log("_infx.profile.update - $el:",$el,"save variant:",config.save_variant);};if(_infx.profile.debug>2){console.log("validate config:",config.validate_cfg);};var $form=$el.closest('div.infx-ecommerce-form-shell');var $inputs=this.collectInputs($form);var data=this.collectInputData($inputs);var validated=this.validateInputData($inputs,config.validate_cfg);if(validated===true){this.submitData($form,data,{ac:'save_data',save_variant:config.save_variant,widget:'widget-dyn-template-insert.pl',valid_json:1},callback);return true;}else{_infx.validate.displayMessage({$form:$form,message:{body:_infx.validate.errorTxt,state:'error-state'}});this.unlock();}
return false;},image:{init:function(){upload_widget_get_initial_data("profile","image");upload_widget_init("profile","image");}},login:function($el,config,callback){if(this.isLocked()){return false;}
this.lock();if(_infx.profile.debug>1){console.log("_infx.profile.login - $el:",$el);};if(_infx.profile.debug>2){console.log("validate config:",config.validate_cfg);};var $form=$el.closest('div.infx-ecommerce-form-shell');var $inputs=this.collectInputs($form);var data=this.collectInputData($inputs);var validated=this.validateInputData($inputs,config.validate_cfg);if(validated===true){this.submitData($form,data,{ac:'do_page_based_login',widget:'widget-login.pl',valid_json:1},callback);return true;}else{_infx.validate.displayMessage({$form:$form,message:{body:_infx.validate.errorTxt,state:'error-state'}});this.unlock();}
return false;},logout:function(redirect,callback){$.ajax({url:_infx.scripts.infxsystem.widget,type:'post',data:{widget:_infx.scripts.widgets.login,ac:'do_logout',valid_json:1,redirect:redirect},success:function(response){if(typeof(callback)=='function'){callback(response);}else{_infx.callbacks.logout({json:response});}}});},forgot_password:function($el,config,callback){if(this.isLocked()){return false;}
this.lock();if(_infx.profile.debug>1){console.log("_infx.profile.forgot_password - $el:",$el);};if(_infx.profile.debug>2){console.log("validate config:",config.validate_cfg);};var $form=$el.closest('div.infx-ecommerce-form-shell');var $inputs=this.collectInputs($form);var data=this.collectInputData($inputs);var validated=this.validateInputData($inputs,config.validate_cfg);if(validated===true){this.submitData($form,data,{ac:'do_forgot_password',widget:'widget-login.pl',valid_json:1},callback);return true;}else{_infx.validate.displayMessage({$form:$form,message:{body:_infx.validate.errorTxt,state:'error-state'}});this.unlock();}
return false;},isLocked:function(){return(this.locked)?true:false;},lock:function(){this.locked=true;},unlock:function(){this.locked=false;},collectInputs:function($form){var $inputs=$form.find('select, input');if(_infx.profile.debug>2){console.log("loaded inputs:",$inputs);};return $inputs;},submitData:function($form,data,additional,callback){var postData={};$.extend(postData,data,additional);$.ajax({url:_infx.scripts.infxsystem.widget,type:'post',data:postData,success:function(response){if(typeof(response.message)!='undefined'){_infx.validate.displayMessage({$form:$form,message:{body:response.message,title:response.message_title,state:response.message_state,autoHide:5000}});}
if(typeof(response.redirect)!='undefined'){location.href=response.redirect;}
if(typeof(callback)=='function'){callback(response);}
_infx.profile.unlock();},failure:function(){_infx.profile.unlock();}});},validateInputData:function($inputs,validate_cfg){var validated=true;$inputs.each(function(){var result=validate_single_field($(this).get(0),validate_cfg);validated=(!result)?false:validated;});if(_infx.profile.debug>2){console.log((validated)?"[successfully validated the data]":"[validation errors where detected]");};return validated;},collectInputData:function($inputs){var data={};$inputs.each(function(){data[$(this).attr('name')]=$(this).val();});if(_infx.profile.debug>2){console.log("collected data:",data);};return data;}};_infx=(typeof(_infx)==='undefined')?{}:_infx;_infx.basket={debug:0,type:undefined,state:undefined,multi_add_items:[],setup:function(){if(this.debug){console.log('_infx.basket.setup called');};this.state='collapsed';if($('#basket').length!=0){this.type='main';}else if($('#minibasket').length!=0){this.type='mini';this.state='expand';}else if($('#slidebasket').length!=0){this.type='slide';}else if($('#mobilebasket').length!=0){this.type='mobile';};if(typeof this.type!=='undefined'){this.update({type:this.type});if(this.type=='mini'){this.popover.init();}else{$('body').click(function(e){if(!$(e.target).parents('#'+_infx.basket.type+'basket').length){if($('#'+_infx.basket.type+'basket').hasClass('basket-expanded')){multi_basket_control('collapse',_infx.basket.type);}}});};};},popover:{init:function(){if(_infx.basket.debug){console.log('_infx.basket.popover.init called');};$('#minibasket').hover(function(){_infx.basket.popover.show(this);},function(){_infx.basket.popover.hide(this);});},show:function(scope){if(_infx.basket.debug){console.log('_infx.basket.popover.show scope:',scope);};$(scope).addClass('basket-popover-open');$(scope).find('.basket-open-modifier-wrapper').fadeIn('fast');},hide:function(scope){if(_infx.basket.debug){console.log('_infx.basket.popover.hide scope:',scope);};$(scope).removeClass('basket-popover-open');$(scope).find('.basket-open-modifier-wrapper').fadeOut('fast');}},update:function(input){if(this.debug){console.log('_infx.basket.update called',input);};var params={};var type=(typeof input.type!='undefined')?input.type:this.type;var state=(typeof input.state!='undefined')?input.state:this.state;if(type=='main'){params.ac='basket';}else if(type=='mini'){params.ac='mini_basket_expand';state='expand';}else if(type=='slide'){params.ac=(state=='expand')?'slide_basket_expand':'slide_basket';}else if(type=='mobile'){params.ac='mobile_basket';};_infx.basket.request(params,function(response){if(this.debug){console.log('_infx.basket.update [callback]',response);};if(type=='main'){_infx.callbacks.main_basket({target_id:'basket',json:response});}else{_infx.callbacks.multi_basket({type:type,mode:state,json:response});};});},spinner:function(input){if(this.debug){console.log('_infx.basket.spinner called',input);};var $spinner=$('#mini_basket_spinner');if($spinner.length==0){$spinner=$('#mobile_basket_spinner');}
if($spinner.length==0){$spinner=$('#slide_basket_spinner');}
$spinner.css({"display":(input.show)?"block":"none"});$('#basket_open').css({"display":(!input.show)?"block":"none"});},flash:function(input){if(this.debug){console.log('_infx.basket.flash called',input);};$(input.selector).animate({opacity:0.7},250).delay(100).animate({opacity:1}).animate({opacity:0.7},250).delay(100).animate({opacity:1});},request:function(params,onsuccess){if(this.debug){console.log('_infx.basket.request called params:',params);};params.widget=_infx.scripts.widgets.basket;params.valid_json=true;params.ajax=1;$.ajax({url:_infx.scripts.infxsystem.widget,dataType:'json',type:'post',data:params,success:(typeof(onsuccess)=='function')?onsuccess:function(){}});},item:{add:function(input){if(_infx.basket.debug){console.log('_infx.basket.item.add called',input);};input.params.ac='add_to_basket';input.params.mode=_infx.basket.state;input.params.ajax=1;var validated=true;if(typeof input.validate==='string'){var validate={};validate[input.validate]={type:'numeric',notnegative:true};validated=validate_single_field(rtnEl(input.validate),validate);}
if(input.$quantity){input.params.quantity=input.$quantity.val();if(/^\d+$/.test(input.params.quantity)&&input.params.quantity>0){_infx.validate.input.reset(input.$quantity,"");}else{_infx.validate.input.error(input.$quantity,"please ensure you've entered a positive quantity");validated=false;}}
if(validated==true){if($('#minibasket').length>0){input.params.mini=1;};if($('#slidebasket').length>0){input.params.slide=1;};if($('#mobilebasket').length>0){input.params.mobile=1;};if(input.params.ignore_options!=1){var soptions=$('#options_'+input.params.product_id+' select');if(soptions.length){var count=0;soptions.each(function(){var value=$(this).val();if(value!=-1){input.params[$(this).attr('id')]=value;$(this).removeClass('hilite-error');count++;}else{hilite_error({element:$(this).get(0),alt_tag:"Please select all options, before attempting to add this item to your basket."});$(this).addClass('hilite-error');};});if(count!=soptions.length){return;}};var hoptions=$('#options_'+input.params.product_id+' .product-image-option-set input[type="hidden"]');if(hoptions.length){var count=0;hoptions.each(function(){var value=$(this).val();if(value!=-1&&value!=""){input.params[$(this).attr('id')]=value;count++;};});if(count!=hoptions.length){hoptions.parent().addClass('error');return;};};};if(input.params.option_string&&input.params.expanded===true){var merged_options=[input.params.option_string.split("=")];for(var p in input.params){if(p.search(/option_[0-9]+/)==0){var option_name_id=p.replace('option_','');merged_options.push([option_name_id,input.params[p]]);};};merged_options=merged_options.sort(function(a,b){return a[0]-b[0];});var option_string="";for(var x=0;x<merged_options.length;x++){option_string+=((option_string=="")?"":",")+merged_options[x].join("=");};input.params.option_string=option_string;};if(input.params.time_id){_popup.create({loading:true});};_infx.basket.request(input.params,function(response){if(_infx.basket.debug){console.log('_infx.basket.item.add [callback]',response);};_infx.callbacks.basket({json:response});});}},remove:function(input){if(_infx.basket.debug){console.log('_infx.basket.item.remove called',input);};input.params.ac='remove_from_basket';if(input.params.mini){basket_spinner(1);};_infx.basket.request(input.params,function(response){if(_infx.basket.debug){console.log('_infx.basket.item.remove [callback]',response);};if(input.params.mini){_infx.basket.update({type:'mini',state:input.params.mode});}else if(input.params.slide){_infx.basket.update({type:'slide',state:input.params.mode});}else if(input.params.mobile){_infx.basket.update({type:'mobile',state:input.params.mode});}else{_infx.basket.update({type:'main'});};});}},quantity:{modify:function(input){if(_infx.basket.debug){console.log('_infx.basket.quantity.modify called',input);};$(input.scope).closest(input.closest_selector).find(input.input_selector).val(function(idx,value){value=value.replace(/[^\d]/g,'');if(value==''){value=1;};return((parseInt(value)+input.adjustment)<1)?1:(parseInt(value)+input.adjustment);});}},saved_baskets:{$form:undefined,save:function($btn,input){if(_infx.basket.debug){console.log('_infx.basket.saved_baskets.save called',input);};var params={ac:'save_basket'};_infx.basket.request(params,function(response){if(_infx.basket.debug){console.log('_infx.basket.saved_baskets.save [callback]',response);};var $form=$btn.closest('div.infx-ecommerce-form-shell');if(typeof(response.message)!='undefined'){_infx.validate.displayMessage({$form:$form,message:{body:response.message,title:response.message_title,state:response.message_state}});};if(response.success==true){_infx.basket.saved_baskets.reload_interface({$target:$form.find('.ajax-load-wrapper')});};});},create:function($btn,input){if(_infx.basket.debug){console.log('_infx.basket.saved_baskets.create called',input);};if(input.confirmed!==true){_infx.basket.saved_baskets.confirm_dialog({ac:'view_confirm_new_basket_dialog',saved_basket_id:input.saved_basket_id,$btn:$btn});return;};var params={ac:'new_basket'};_infx.basket.request(params,function(response){if(_infx.basket.debug){console.log('_infx.basket.saved_baskets.create [callback]',response);};var $form=_infx.basket.saved_baskets.$form;if(typeof(response.message)!='undefined'){_infx.validate.displayMessage({$form:$form,message:{body:response.message,title:response.message_title,state:response.message_state}});}else if(response.success==false){_infx.validate.displayMessage({$form:$form,message:{body:"An unexpected error has occurred whilst attempting to start a new basket.",state:'error-state'}});};if(response.success==true){_infx.basket.update({});_popup.close();};});},load:function($btn,input){if(_infx.basket.debug){console.log('_infx.basket.saved_baskets.load called',input);};if(input.confirmed!==true){_infx.basket.saved_baskets.confirm_dialog({ac:'view_confirm_load_basket_dialog',saved_basket_id:input.saved_basket_id,$btn:$btn});return;};var params={ac:'load_basket',saved_basket_id:input.saved_basket_id};_infx.basket.request(params,function(response){if(_infx.basket.debug){console.log('_infx.basket.saved_baskets.load [callback]',response);};var $form=_infx.basket.saved_baskets.$form;if(typeof(response.message)!='undefined'){_infx.validate.displayMessage({$form:$form,message:{body:response.message,title:response.message_title,state:response.message_state}});}else if(response.success==false){_infx.validate.displayMessage({$form:$form,message:{body:"An unexpected error has occurred whilst attempting to load an existing basket.",state:'error-state'}});};if(response.success==true){_infx.basket.update({});_popup.close();_infx.basket.saved_baskets.reload_interface({$target:_infx.basket.saved_baskets.$form.find('.ajax-load-wrapper')});};});},rename:function($btn,input){if(_infx.basket.debug){console.log('_infx.basket.saved_baskets.rename called',input);};if(input.confirmed!==true){_infx.basket.saved_baskets.confirm_dialog({ac:'view_confirm_rename_basket_dialog',saved_basket_id:input.saved_basket_id,$btn:$btn});return;};var params={ac:'rename_basket',saved_basket_id:input.saved_basket_id,new_basket_name:input.new_basket_name};_infx.basket.request(params,function(response){if(_infx.basket.debug){console.log('_infx.basket.saved_baskets.rename [callback]',response);};var $form=_infx.basket.saved_baskets.$form;if(typeof(response.message)!='undefined'){_infx.validate.displayMessage({$form:$form,message:{body:response.message,title:response.message_title,state:response.message_state}});}else if(response.success==false){_infx.validate.displayMessage({$form:$form,message:{body:"An unexpected error has occurred whilst attempting to rename an existing basket.",state:'error-state'}});};if(response.success==true){_infx.basket.update({});_popup.close();_infx.basket.saved_baskets.reload_interface({$target:_infx.basket.saved_baskets.$form.find('.ajax-load-wrapper')});};});},remove:function($btn,input){if(_infx.basket.debug){console.log('_infx.basket.saved_baskets.remove called',input);};if(input.confirmed!==true){_infx.basket.saved_baskets.confirm_dialog({ac:'view_confirm_delete_basket_dialog',saved_basket_id:input.saved_basket_id,$btn:$btn});return;};var params={ac:'delete_basket',saved_basket_id:input.saved_basket_id};_infx.basket.request(params,function(response){if(_infx.basket.debug){console.log('_infx.basket.saved_baskets.remove [callback]',response);};var $form=_infx.basket.saved_baskets.$form;if(typeof(response.message)!='undefined'){_infx.validate.displayMessage({$form:$form,message:{body:response.message,title:response.message_title,state:response.message_state}});}else if(response.success==false){_infx.validate.displayMessage({$form:$form,message:{body:"An unexpected error has occurred whilst attempting to remove an existing basket.",state:'error-state'}});};if(response.success==true){_infx.basket.update({});_popup.close();_infx.basket.saved_baskets.reload_interface({$target:_infx.basket.saved_baskets.$form.find('.ajax-load-wrapper')});};});},reload_interface:function(input){if(_infx.basket.debug){console.log('_infx.basket.saved_baskets.reload_interface called',input);};$.ajax({url:_infx.scripts.infxsystem.widget,type:'post',data:{insert_block_type:'profile_insert',insert_variant:'saved_baskets',ajax_reload:1,widget:'widget-dyn-template-insert.pl'},success:function(html){input.$target.html(html);}});},confirm_dialog:function(input){_infx.basket.saved_baskets.$form=input.$btn.closest('div.infx-ecommerce-form-shell');$.ajax({url:_infx.scripts.infxsystem.widget,type:'post',dataType:'json',data:{ac:input.ac,saved_basket_id:input.saved_basket_id,widget:_infx.scripts.widgets.profile,valid_json:1},success:function(data){_infx.callbacks.popup({json:data});}});}}}
function remove_basket_item(json){_infx.basket.item.remove({params:json});};function multi_update_basket(type){_infx.basket.update({type:type});};function multi_basket_control(state,type){_infx.basket.update({type:type,state:((state!='')?state:undefined)});};function basket_spinner(onoff){_infx.basket.spinner((onoff)?{show:true}:{show:false});};function flash_basket(target_id){_infx.basket.flash({selector:'#'+target_id});};function add_to_basket(json){var input={params:json};if(typeof(input.params.validate)!='undefined'){input.validate=input.params.validate;delete input.params.validate;};_infx.basket.item.add(input);};function modify_basket_item(json){json.ac='modify_item';json.ajax=1;var validate={};validate[json.validate]={type:'numeric',notnegative:true};delete json.validate;var container_div;if(json.element_container!=''){container_div=rtnEl(json.element_container);}
if(!container_div)container_div=rtnEl('detail');if(container_div&&json.ignore!='options'){var elements=container_div.getElementsByTagName('select');for(var x=0;x<elements.length;x++){json[elements[x].id]=elements[x].value;}}
if(validate_single_field(rtnEl(json.validate),validate)){_popup.close();basket_spinner(1);$.ajax({url:basket_widget,type:'post',data:json,success:function(data){basket_callback(data);}});}}
function modify_basket_quantity(json){json.ac='modify_quantity';json.ajax=1;var validate={};validate[json.validate]={type:'numeric',notnegative:true};if(validate_single_field(rtnEl(json.validate),validate)){basket_spinner(1);delete json.validate;$.ajax({url:basket_widget,type:'post',data:json,success:function(data){if(json.mini){multi_basket_control(json.mode,'mini');}else if(json.slide){multi_basket_control(json.mode,'slide');}else{multi_update_basket('main');}}});}}
function collect_items(json){$('#'+json.target+' tr.on, #'+json.target+" tr.off").each(function(idx){var qty=$(this).find('input.qty').val();if(parseInt(qty)>0){var obj={quantity:qty};if(json.target=='regular_list'){obj.product_id=$(this).find('input[name="product_id_'+idx+'"]').val();obj.option_string=$(this).find('input[name="option_string_'+idx+'"]').val();}else{obj.product_id=json.product_id;obj.option_string=$(this).find('input[name="F_stock_level.option_string"]').val();};_infx.basket.multi_add_items.push(obj);};});if(_infx.basket.multi_add_items.length>0){var validated_options=true;for(var p in _infx.basket.multi_add_items){var soptions=$('.product-list-dialog').find('#options_'+_infx.basket.multi_add_items[p].product_id+' select');if(soptions.length){var count=0;soptions.each(function(){var value=$(this).val();if(value!=-1){json[$(this).attr('id')]=value;count++;}else{hilite_error({element:$(this).get(0),alt_tag:"Please select all options, before attempting to add this item to your basket."});};});if(count!=soptions.length){validated_options=false;}};};if(!validated_options){_infx.basket.multi_add_items.length=0;return;};multiple_add_to_basket();}else{_popup.create({width:0.5,html:"<div id='popup_form' ><div class='information_message'>Please ensure you have entered a valid quantity for at least one item!</div></div>",closeicon:false,plain:true,autohide:2500,force:true});};};function multiple_add_to_basket(){if(_infx.basket.multi_add_items.length>0){basket_spinner(1);var item=_infx.basket.multi_add_items.shift();item.multiple_add=1;item.ignore_options=1;add_to_basket(item);}else{_popup.create({width:0.5,html:"<div id='popup_form' ><div class='add_to_basket_message'>Item added to basket successfully!</div></div>",closeicon:false,plain:true,autohide:2500,force:true});multi_basket_control(_infx.basket.state,'mini');};};function update_state(json){json.ac='basket';json.ajax=1;json.valid_json=true;$.ajax({url:basket_widget,type:'post',data:json,success:function(data){_infx.callbacks.main_basket({target_id:'basket',json:data});}});};function remove_promo_code(json){json.ac='remove_promo_code';json.ajax=1;var confirm=window.confirm('Do you really want to remove this promotional code from your order?');if(confirm){$.ajax({url:basket_widget,type:'post',data:json,success:function(data){multi_update_basket('main');}});}}
function add_promo_code(json){json.ac='add_promo_code';json.ajax=1;var validate={};validate[json.validate]='text';if(validate_single_field(rtnEl(json.validate),validate)){$.ajax({url:basket_widget,type:'post',data:json,success:function(data){_infx.callbacks.promo({json:data});}});}}
_infx=(typeof(_infx)==='undefined')?{}:_infx;_infx.track={debug:0,sandbox:false,trackers:[],register:function(tracker){if(_infx.track.debug>1){console.log("_infx.track.register - tracker:",tracker);};if(typeof(tracker.definition)=='object'&&typeof(this[tracker.type])=='undefined'){this[tracker.type]=tracker.definition;};this.trackers.push(tracker);if(typeof(_infx.track[tracker.type]['init'])==='function'){_infx.track[tracker.type]['init'](tracker);};},init:function(){_infx.track.bind_ga();_infx.track.fire('pageview');},bind_ga:function(){$('[data-gaevent]').each(function(){var data=$(this).data();$(this).off(data.gaevent+'.infx-tracking').on(data.gaevent+'.infx-tracking',function(){_infx.track.fire('event',[data.gacategory,data.gaaction,data.galabel,data.gavalue]);});});},fire:function(action,args){if(typeof(args)=='undefined'){args=[];};if(_infx.track.debug>1){console.log("_infx.track.fire - action:",action);};for(var x=0;x<this.trackers.length;x++){var tracker=this.trackers[x];if(typeof(tracker)==='object'&&typeof(tracker.type)!='undefined'){if(typeof(_infx.track[tracker.type][action])==='function'){var cloneargs=[];$.extend(true,cloneargs,args);_infx.track[tracker.type][action](tracker,cloneargs);}else{if(_infx.track.debug){console.warn("_infx.track.fire - no method to action '"+action+"' found on tracker of type '"+tracker.type+"'");};};};};},analyticsjs:{init:function(tracker){if(_infx.track.debug>1){console.log("_infx.track.analyticsjs.init - code:",tracker.code,"config:",tracker.config);};if(_infx.track.sandbox){if(_infx.track.debug){console.warn("running in sandbox mode, blocking requests to google");};return;};ga('create',tracker.code,'auto',tracker.config);if(tracker.ecommerce){if(_infx.track.debug>1){console.log("_infx.track.analyticsjs.init - ecommerce:",tracker.code,"name:",tracker.name);};ga(((typeof(tracker.name)!='undefined')?tracker.name+".":"")+'require','ecommerce','ecommerce.js');};},event:function(tracker,args){if(_infx.track.debug>1){console.log("_infx.track.analyticsjs.event - code:",tracker.code,"args:",args);};this._send(tracker,'event',args);},pageview:function(tracker,args){if(_infx.track.debug>1){console.log("_infx.track.analyticsjs.pageview - code:",tracker.code,"args:",args);};this._send(tracker,'pageview',args);},tracktrans:function(tracker){if(_infx.track.debug>1){console.log("_infx.track.analyticsjs.tracktrans - code:",tracker.code);};this._plugin(tracker,'ecommerce','send');},addtrans:function(tracker,args){if(_infx.track.debug>1){console.log("_infx.track.analyticsjs.addtrans - code:",tracker.code,"args:",args);};this._plugin(tracker,'ecommerce','addTransaction',{id:args[0],affiliation:args[1],revenue:args[2],tax:args[3],shipping:args[4]});},additem:function(tracker,args){if(_infx.track.debug>1){console.log("_infx.track.analyticsjs.additem - code:",tracker.code,"args:",args);};this._plugin(tracker,'ecommerce','addItem',{id:args[0],sku:args[1],name:args[2],category:args[3],price:args[4],quantity:args[5]});},_plugin:function(tracker,plugin,method,config){if(_infx.track.debug>1){console.log("_infx.track.analyticsjs._plugin - code:",tracker.code,"plugin:",plugin,"method:",method,"config:",config);};var args=[];args.push(((typeof(tracker.name)!='undefined')?tracker.name+"."+plugin:plugin)+':'+method);if(typeof(config)==='object'){args.push(config);};if(_infx.track.debug){console.log("_infx.track.analyticsjs._plugin - args:",args);};if(_infx.track.sandbox){return;};ga.apply(this,args);},_send:function(tracker,method,args){if(method){args.unshift(method);};args.unshift(((typeof(tracker.name)!='undefined')?tracker.name+".send":"send"));if(_infx.track.debug){console.log("_infx.track.analyticsjs._send - args:",args);};if(_infx.track.sandbox){return;};ga.apply(this,args);}},gajs:{init:function(tracker){if(_infx.track.debug>1){console.log("_infx.track.gajs.init - code:",tracker.code);};this._push(tracker,'_setAccount',[tracker.code]);if(_infx.track.sandbox){if(_infx.track.debug){console.warn("running in sandbox mode, blocking requests to google");};};},event:function(tracker,args){if(_infx.track.debug>1){console.log("_infx.track.gajs.event - code:",tracker.code,"args:",args);};this._push(tracker,'_trackEvent',args);},pageview:function(tracker,args){if(_infx.track.debug>1){console.log("_infx.track.gajs.pageview - code:",tracker.code,"args:",args);};this._push(tracker,'_trackPageview',args);},setdomainname:function(tracker,args){if(_infx.track.debug>1){console.log("_infx.track.gajs.setdomainname - code:",tracker.code,"args:",args);};this._push(tracker,'_setDomainName',args);},setallowlinker:function(tracker,args){if(_infx.track.debug>1){console.log("_infx.track.gajs.setallowlinker - code:",tracker.code,"args:",args);};this._push(tracker,'_setAllowLinker',args);},tracktrans:function(tracker){if(_infx.track.debug>1){console.log("_infx.track.gajs.tracktrans - code:"+tracker.code);};this._push(tracker,'_trackTrans',[]);},addtrans:function(tracker,args){if(_infx.track.debug>1){console.log("_infx.track.gajs.addtrans - code:"+tracker.code,"args:",args);};this._push(tracker,'_addTrans',args);},additem:function(tracker,args){if(_infx.track.debug>1){console.log("_infx.track.gajs.additem - code:"+tracker.code,"args:",args);};this._push(tracker,'_addItem',args);},_push:function(tracker,method,args){if(method){args.unshift(method);};if(typeof(tracker.name)!='undefined'){args.unshift(tracker.name+"."+args.shift());};if(_infx.track.debug){console.log("_infx.track.gajs._push",args);};if(_infx.track.sandbox){return;};_gaq.push(args);}}};function googleTrackEvent(category,action,opt_label,opt_value){console.warn("googleTrackEvent is deprecated please use the _infx.track.fire( 'event', [ category, action, opt_label, opt_value ] ); syntax instead.");_infx.track.fire('event',[category,action,opt_label,opt_value]);};function infx_track_event(category,action,opt_label,opt_value){console.warn("infx_track_event is deprecated please use the _infx.track.fire( 'event', [ category, action, opt_label, opt_value ] ); syntax instead.");_infx.track.fire('event',[category,action,opt_label,opt_value]);};function googleTrackPage(path){console.warn("googleTrackPage is deprecated please use the _infx.track.fire( 'pageview', [ path ] ); syntax instead.");_infx.track.fire('pageview',[path]);};$(document).ready(function(){_infx.track.init();});$.fn.classList=function(){return this[0].className.split(/\s+/);};$(document).ready(function(){if($('.infx-dropdown-menu').length){_infx.navigation.init();}});_infx=(typeof(_infx)==='undefined')?{}:_infx;_infx.navigation={data:null,config:{useSlideFunctions:false,useFadeFunctions:true,slideUpTime:500,delayCloseSlideUpTime:1000,slideDownTime:500,fadeInTime:200,fadeOutTime:200,delayCloseFadeOutTime:1000,subNavCloseDelay:1000,subNavCloseDelayTouch:5000,subNavClosedClass:"",subNavOpenClass:"subnavopen",autoConstrainSubnav:false},leavingNav:false,delayedCloseTimer:null,delayedClose:false,handlers:{click_handler:function(type,element){if(type=="touch"){clearTimeout(_infx.navigation.delayedCloseTimer);var subNav=element.children(".subnavigation-inner");var hasSubNav=subNav.length==0?false:true;_infx.navigation.close_all_subnavs(subNav);if(hasSubNav===true){if(subNav.hasClass(_infx.navigation.config.subNavOpenClass)==false){_infx.navigation.open_subnav(subNav);_infx.navigation.touch_delay_close_all_subnavs();}else{document.location.href=element.children("a").attr("href");}}else{document.location.href=element.children("a").attr("href");}}
if(type=="click"){clearTimeout(_infx.navigation.delayedCloseTimer);location.href=element.children("a").attr("href");}},enter_handler:function(element){clearTimeout(_infx.navigation.delayedCloseTimer);var subNav=element.children(".subnavigation-inner");var hasSubNav=subNav.length==0?false:true;_infx.navigation.close_all_subnavs(subNav);if(hasSubNav==true){_infx.navigation.open_subnav(subNav);}},leave_handler:function(element){_infx.navigation.leavingNav=false;var p=element;setTimeout(function(){if(_infx.navigation.leavingNav===false)_infx.navigation.close_subnav(p.children(".subnavigation-inner"));},0);}},close_all_subnavs:function(exception){_infx.navigation.delayedClose=false;if(typeof exception!='undefined'){$(".subnavigation-inner").each(function(){if(exception[0]!=$(this)[0])_infx.navigation.close_subnav($(this));});}else{$(".subnavigation-inner").each(function(){_infx.navigation.close_subnav($(this));});}},delay_close_all_subnavs:function(){_infx.navigation.delayedClose=true;_infx.navigation.delayedCloseTimer=setTimeout(function(){_infx.navigation.close_all_subnavs();},_infx.navigation.config.subNavCloseDelay);},touch_delay_close_all_subnavs:function(){_infx.navigation.delayedClose=true;_infx.navigation.delayedCloseTimer=setTimeout(function(){_infx.navigation.close_all_subnavs();},_infx.navigation.config.subNavCloseDelayTouch);},close_subnav:function(element){var delaySlideTimeDiff=0;var delayFadeTimeDiff=0;if(_infx.navigation.delayedClose==true){delaySlideTimeDiff=_infx.navigation.config.delayCloseSlideUpTime-_infx.navigation.config.slideUpTime;delayFadeTimeDiff=_infx.navigation.config.delayCloseFadeOutTime-_infx.navigation.config.fadeOutTime;}
element.removeClass(_infx.navigation.config.subNavOpenClass);if(_infx.navigation.config.subNavClosedClass!="")element.addClass(_infx.navigation.config.subNavClosedClass);if(_infx.navigation.config.useSlideFunctions===true&&_infx.navigation.config.useFadeFunctions===false)element.stop(true,false).slideUp(_infx.navigation.config.slideUpTime+delaySlideTimeDiff);else if(_infx.navigation.config.useFadeFunctions===true&&_infx.navigation.config.useSlideFunctions===false)element.stop(true,false).fadeOut(_infx.navigation.config.fadeOutTime+delayFadeTimeDiff);else element.stop(true,false).slideUp({duration:_infx.navigation.config.slideUpTime+delaySlideTimeDiff,queue:false}).fadeOut({duration:_infx.navigation.config.fadeOutTime+delayFadeTimeDiff,queue:false});},open_subnav:function(element){element.addClass(_infx.navigation.config.subNavOpenClass);if(_infx.navigation.config.subNavClosedClass!="")element.removeClass(_infx.navigation.config.subNavClosedClass);if(_infx.navigation.config.useSlideFunctions===true&&_infx.navigation.config.useFadeFunctions===false)element.stop(true,false).slideDown(_infx.navigation.config.slideDownTime);else if(_infx.navigation.config.useFadeFunctions===true&&_infx.navigation.config.useSlideFunctions===false)element.stop(true,false).fadeIn(_infx.navigation.config.fadeInTime);else element.stop(true,false).slideDown({duration:_infx.navigation.config.slideDownTime,queue:false}).fadeIn({duration:_infx.navigation.config.fadeInTime,queue:false});if(_infx.navigation.autoConstrainSubnav===true)_infx.navigation.constrain_subnav(element);},constrain_subnav:function(element){var subnavwidth=$(".subnavigation-inner").width();if(element.children(".subnavigation-inner").length>0){var w=element.parent().offset().left+element.position().left+subnavwidth;if(w>$("body").width()){var dif=w-$("body").width();element.children(".subnavigation-inner").css("left",element.position().left-dif+"px");}else{element.children(".subnavigation-inner").css("left","auto");}}},init:function(){if(_infx.navigation.config.subNavClosedClass!=""){$(".subnavigation-inner").addClass(_infx.navigation.config.subNavClosedClass);}
$(".navigation-inner > ul > li").each(function(){$(this).children(".subnavigation-inner").css("min-height","0px");});$(".navigation-inner > ul > li ").each(function(index,element){if($(this).children(".subnavigation-inner").length>0){$(this).on("touchstart",function(event){event.preventDefault();_infx.navigation.handlers.click_handler("touch",$(this));});$(this).on("click",function(event){_infx.navigation.handlers.click_handler("click",$(this));});}});$(".subnavigation-inner > li ").on("touchstart",function(event){event.preventDefault();_infx.navigation.handlers.click_handler("touch",$(this));});$(".subnavigation-inner > li ").on("click",function(event){_infx.navigation.handlers.click_handler("click",$(this));});$(".navigation-inner > ul > li").on("mouseenter",function(event){event.preventDefault();_infx.navigation.handlers.enter_handler($(this));});$(".navigation-inner > ul > li").on("mouseleave",function(event){event.preventDefault();_infx.navigation.handlers.leave_handler($(this));});$("#navigation").on("mouseleave",function(event){_infx.navigation.leavingNav=true;_infx.navigation.delay_close_all_subnavs();});},genericNav:{config:{configFromDOM:true,useSliding:false,useClick:false,useFullwidthSubNavNextSwitch:false,useFullwidthSubNavPreviousSwitch:false,createStandaloneBackButton:false,JSONMenu:{},template:""},currentLevel:0,wrapperHeight:0,closeTimer:null,removeOriginalNav:true,forceWidestWidth:false,widestWidth:0,positionedLeft:true,autoCorrectNoWrap:true,menuShown:false,templateReadyJSON:{levels:[]},myHandlebarsTemplate:null,templateObject:null,prepareNavigationLevels:function(ul,level,parentLevel,createLevel){if(createLevel===true)$(".top-nav-sliding-nav-wrapper").append('<div class="sliding-nav-level sliding-nav-level-'+level+'" data-level="'+level+'"><ul></ul></div>');ul.children("li").not(".special-nav-element").each(function(index,element){var clone=$(this).clone();var levelDepth=level.split("-").join("").length;if(levelDepth>1)clone.addClass("sliding-nav-subnav-"+(levelDepth-1));if(_infx.navigation.genericNav.autoCorrectNoWrap===true){clone.find("a").each(function(index,element){var str=$(this).html();str=str.split("&nbsp;").join(" ");$(this).html(str);});$(".top-nav-sliding-nav-wrapper .sliding-nav-level ul li a").css("white-space","normal");}
if(createLevel===true)$(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level-'+level).children("ul").append(clone);else $(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level-'+parentLevel).children("ul").append(clone);if(level!=="0"&&index===0&&_infx.navigation.genericNav.config.useSliding===true)clone.addClass("has-subnav").append('<a class="subnav-switch-previous" data-parentlevel="'+parentLevel+'"> </a>');if(clone.find("ul.subnavigation-inner").length!==0){if(_infx.navigation.genericNav.config.useSliding===true)clone.addClass("has-subnav").append('<a class="subnav-switch-next" data-childlevel="'+level+"-"+index+'"> </a>');if(_infx.navigation.genericNav.config.useSliding===true)_infx.navigation.genericNav.prepareNavigationLevels(clone.find("ul.subnavigation-inner"),level+"-"+index,level,true);else _infx.navigation.genericNav.prepareNavigationLevels(clone.find("ul.subnavigation-inner"),level+"-"+index,level,false);clone.find("ul.subnavigation-inner").remove();}});var width=parseInt($(".top-nav-sliding-nav-wrapper").css("width").replace("px",""));var height=$(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level-'+level).height();if(height>_infx.navigation.genericNav.wrapperHeight)_infx.navigation.genericNav.wrapperHeight=height;if(width>_infx.navigation.genericNav.widestWidth)_infx.navigation.genericNav.widestWidth=width;if(_infx.navigation.genericNav.positionedLeft===true){$(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level-'+level).data("width",width).css("left",300);}else{$(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level-'+level).data("width",width).css("right",300);}},prepareJSONNavigationLevels:function(jsonArray,level,parentLevel,createLevel){if(createLevel===true)$(".top-nav-sliding-nav-wrapper").append('<div class="sliding-nav-level sliding-nav-level-'+level+'" data-level="'+level+'"><ul></ul></div>');for(var i=0;i<jsonArray.length;i++){var classes=jsonArray[i].classes.join(" ");classes+=jsonArray[i].active===1?" active":"";classes+=jsonArray[i].activeleaf===1?" activeleaf":"";var clone=$('<li><a href="'+jsonArray[i].path+'" class="inav '+classes+'">'+jsonArray[i].name+'</a></li>');var levelDepth=level.split("-").join("").length;if(levelDepth>1)clone.addClass("sliding-nav-subnav-"+(levelDepth-1));if(_infx.navigation.genericNav.autoCorrectNoWrap===true){clone.find("a").each(function(index,element){var str=$(this).html();str=str.split("&nbsp;").join(" ");$(this).html(str);});$(".top-nav-sliding-nav-wrapper .sliding-nav-level ul li a").css("white-space","normal");}
if(createLevel===true)$(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level-'+level).children("ul").append(clone);else $(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level-'+parentLevel).children("ul").append(clone);if(level!=="0"&&i===0&&_infx.navigation.genericNav.config.useSliding===true)clone.addClass("has-subnav").append('<a class="subnav-switch-previous" data-parentlevel="'+parentLevel+'"> </a>');if(jsonArray[i]["children"]&&jsonArray[i]["children"].length!==0){if(_infx.navigation.genericNav.config.useSliding===true)clone.addClass("has-subnav").append('<a class="subnav-switch-next" data-childlevel="'+level+"-"+i+'"> </a>');if(_infx.navigation.genericNav.config.useSliding===true)_infx.navigation.genericNav.prepareJSONNavigationLevels(jsonArray[i]["children"],level+"-"+i,level,true);else _infx.navigation.genericNav.prepareJSONNavigationLevels(jsonArray[i]["children"],level+"-"+i,level,false);}}
var width=parseInt($(".top-nav-sliding-nav-wrapper").css("width").replace("px",""));var height=$(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level-'+level).height();if(height>_infx.navigation.genericNav.wrapperHeight)_infx.navigation.genericNav.wrapperHeight=height;if(width>_infx.navigation.genericNav.widestWidth)_infx.navigation.genericNav.widestWidth=width;if(_infx.navigation.genericNav.positionedLeft===true){$(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level-'+level).data("width",width).css("left",300);}else{$(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level-'+level).data("width",width).css("right",300);}},prepareJSONNavigationLevelsForTemplating:function(jsonArray,templateJSON,level,parentLevel){var thisLevel={menuEntries:[]};var levelDepth=level.split("-").join("").length;thisLevel["levelDepth"]=levelDepth-1;for(var i=0;i<jsonArray.length;i++){var thisEntry={};var classes=jsonArray[i].classes.join(" ");classes+=jsonArray[i].active===1?" active":"";thisEntry["classes"]=classes;thisEntry["path"]=jsonArray[i].path;thisEntry["name"]=jsonArray[i].name;if(jsonArray[i]["children"]&&jsonArray[i]["children"].length!==0){_infx.navigation.genericNav.prepareJSONNavigationLevelsForTemplating(jsonArray[i]["children"],templateJSON,level+"-"+i,level);}
thisLevel["menuEntries"].push(thisEntry);}
templateJSON.levels.push(thisLevel);},removeOriginalNavigation:function(){$("nav").find(".navigation-inner").first().children("ul").children("li").not(".top-nav-sliding-nav").remove();},remeasureWidths:function(){$(".top-nav-sliding-nav-wrapper").show();_infx.navigation.genericNav.wrapperHeight=0;_infx.navigation.genericNav.widestWidth=0;$(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level').each(function(index,element){var width=parseInt($(".top-nav-sliding-nav-wrapper").css("width").replace("px",""));var height=$(this).height();if(height>_infx.navigation.genericNav.wrapperHeight)_infx.navigation.genericNav.wrapperHeight=height;if(width>_infx.navigation.genericNav.widestWidth)_infx.navigation.genericNav.widestWidth=width;$(this).width(width);});if(_infx.navigation.genericNav.forceWidestWidth===true){$(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level').each(function(index,element){$(this).data("width",_infx.navigation.genericNav.widestWidth).width(_infx.navigation.genericNav.widestWidth);});}
$(".top-nav-sliding-nav-wrapper").height(_infx.navigation.genericNav.wrapperHeight);if(_infx.navigation.genericNav.menuShown!==true)$(".top-nav-sliding-nav-wrapper").hide();},showMenu:function(){_infx.navigation.genericNav.currentLevel="0";$(".top-nav-sliding-nav-wrapper").show();var allLevels=$(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level');var level0=$(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level-0');if(_infx.navigation.genericNav.positionedLeft===true){allLevels.css("transform","translate3d("+$(".top-nav-sliding-nav-wrapper").width()+"px,0px,0px)");level0.css("transform","translate3d(0px,0px,0px)");}else{allLevels.css("transform","translate3d("+-$(".top-nav-sliding-nav-wrapper").width()+"px,0px,0px)");level0.css("transform","translate3d(0px,0px,0px)");}
_infx.navigation.genericNav.menuShown=true;},hideMenu:function(){$(".top-nav-sliding-nav-wrapper").fadeOut(300);var w=$(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level-0').data("width");if(_infx.navigation.genericNav.positionedLeft===true){$(".top-nav-sliding-nav-wrapper").children().not('.sliding-nav-level-0').css("transform","translate3d("+w+"px,0px,0px)");$(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level-0').css("transform","translate3d(0px,0px,0px)");}else{$(".top-nav-sliding-nav-wrapper").children().not('.sliding-nav-level-0').css("transform","translate3d("+-w+"px,0px,0px)");$(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level-0').css("transform","translate3d(0px,0px,0px)");}
_infx.navigation.genericNav.currentLevel="0";_infx.navigation.genericNav.menuShown=false;},toggleMenu:function(){if(_infx.navigation.genericNav.menuShown===true){$(".top-nav-sliding-nav").removeClass("menushown");_infx.navigation.genericNav.hideMenu();}else{$(".top-nav-sliding-nav").addClass("menushown");_infx.navigation.genericNav.showMenu();}},switchToChildLevel:function(desiredChild){if(_infx.navigation.genericNav.positionedLeft===true){var currentLevel=$(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level-'+_infx.navigation.genericNav.currentLevel);var w=currentLevel.width();currentLevel.css("transform","translate3d("+-w+"px,0px,0px)");_infx.navigation.genericNav.currentLevel=desiredChild.attr("data-childlevel");currentLevel=$(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level-'+_infx.navigation.genericNav.currentLevel);var w=currentLevel.width();$(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level').not('.sliding-nav-level-0').css("transform","translate3d("+w+"px,0px,0px)");currentLevel.css("transform","translate3d(0px,0px,0px)");}else{var w=$(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level-'+_infx.navigation.genericNav.currentLevel).width();$(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level-'+_infx.navigation.genericNav.currentLevel).css("transform","translate3d("+-w+"px,0px,0px)");_infx.navigation.genericNav.currentLevel=desiredChild.attr("data-childlevel");var w=$(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level-'+_infx.navigation.genericNav.currentLevel).width();$(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level').not('.sliding-nav-level-0').css("transform","translate3d("+-w+"px,0px,0px)");$(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level-'+_infx.navigation.genericNav.currentLevel).css("transform","translate3d(0px,0px,0px)");}},switchToParentLevel:function(desiredParent){if(_infx.navigation.genericNav.positionedLeft===true){var w=$(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level-'+desiredParent.attr("data-parentlevel")).width();$(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level-'+_infx.navigation.genericNav.currentLevel).css("transform","translate3d("+w+"px,0px,0px)");_infx.navigation.genericNav.currentLevel=desiredParent.attr("data-parentlevel");var w=$(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level-'+_infx.navigation.genericNav.currentLevel).width();$(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level-'+_infx.navigation.genericNav.currentLevel).css("transform","translate3d(0px,0px,0px)");}else{var w=$(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level-'+desiredParent.attr("data-parentlevel")).width();$(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level-'+_infx.navigation.genericNav.currentLevel).css("transform","translate3d("+-w+"px,0px,0px)");_infx.navigation.genericNav.currentLevel=desiredParent.attr("data-parentlevel");var w=$(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level-'+_infx.navigation.genericNav.currentLevel).width();$(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level-'+_infx.navigation.genericNav.currentLevel).css("transform","translate3d(0px,0px,0px)");}},init:function(){if(_infx.navigation.genericNav.config.configFromDOM===true){$(".navigation-inner > ul > li ").off("touchstart").off("click").off("mouseenter").off("mouseleave").unbind("touchstart").unbind("click").unbind("mouseenter").unbind("mouseleave");$(".subnavigation-inner > li ").off("touchstart").off("click").unbind("touchstart").unbind("click");$("#navigation").off("mouseleave").unbind("mouseleave");$("nav .navigation-inner > ul > li").last().removeClass("end");$("nav .navigation-inner > ul").append('<li class="top-nav-sliding-nav special-nav-element"></li>');$("nav .navigation-inner").append('<div class="top-nav-sliding-nav-wrapper"></div>');$(".top-nav-sliding-nav-wrapper").show();_infx.navigation.genericNav.prepareNavigationLevels($("nav").find(".navigation-inner").first().children("ul"),"0","-1",true);}else{_infx.navigation.genericNav.config.JSONMenu=_infx.navigation.data;if(_infx.navigation.genericNav.config.createStandaloneBackButton===true){_infx.navigation.genericNav.config.useFullwidthSubNavPreviousSwitch=true;function recursiveInsert(arr){var jsonArray=arr;for(var i=0;i<jsonArray.length;i++){if(jsonArray[i]["children"]&&jsonArray[i]["children"].length!==0){var itemToInsert={"classes":["back-button"],"active":0,"name":"back","children":[],"path":"","target":"","desc":"Back button","type":"0","sitemap":"0"}
jsonArray[i]["children"].splice(0,0,itemToInsert);recursiveInsert(jsonArray[i]["children"]);}}}
recursiveInsert(_infx.navigation.genericNav.config.JSONMenu.children);}
$(".top-nav-sliding-nav-wrapper").show();_infx.navigation.genericNav.prepareJSONNavigationLevels(_infx.navigation.genericNav.config.JSONMenu.children,"0","-1",true);}
if(_infx.navigation.genericNav.config.useFullwidthSubNavNextSwitch===true)$("a.subnav-switch-next").addClass("fullwidth");if(_infx.navigation.genericNav.config.useFullwidthSubNavPreviousSwitch===true)$("a.subnav-switch-previous").addClass("fullwidth");$(".top-nav-sliding-nav-wrapper").hide();if(_infx.navigation.genericNav.forceWidestWidth===true){$(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level').each(function(index,element){$(this).data("width",_infx.navigation.genericNav.widestWidth).width(_infx.navigation.genericNav.widestWidth);});}
if(_infx.navigation.genericNav.removeOriginalNav===true)_infx.navigation.genericNav.removeOriginalNavigation();if(_infx.navigation.genericNav.positionedLeft===true){$(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level').css("left",0);$(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level').css("transform","translate3d("+parseInt($(".top-nav-sliding-nav-wrapper").css("width").replace("px",""))+"px,0px,0px");$(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level-0').css("transform","translate3d(0px,0px,0px");}else{$(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level').css("right",0);$(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level').css("transform","translate3d("+-parseInt($(".top-nav-sliding-nav-wrapper").css("width").replace("px",""))+"px,0px,0px");$(".top-nav-sliding-nav-wrapper").children('.sliding-nav-level-0').css("transform","translate3d(0px,0px,0px");}
$(".top-nav-sliding-nav-wrapper").hide();$(".top-nav-sliding-nav-wrapper").height(_infx.navigation.genericNav.wrapperHeight);$(".top-nav-sliding-nav-wrapper, .top-nav-sliding-nav").on("mouseenter",function(){clearTimeout(_infx.navigation.genericNav.closeTimer);_infx.navigation.genericNav.showMenu();});$(".top-nav-sliding-nav-wrapper, .top-nav-sliding-nav").on("mouseleave",function(event){_infx.navigation.genericNav.closeTimer=setTimeout(function(){_infx.navigation.genericNav.hideMenu();},500);});$(".top-nav-sliding-nav-wrapper").on(_infx.navigation.genericNav.config.useClick===true?"click":"mouseover","a.subnav-switch-next",function(event){_infx.navigation.genericNav.switchToChildLevel($(this));});$(".top-nav-sliding-nav-wrapper").on(_infx.navigation.genericNav.config.useClick===true?"click":"mouseover","a.subnav-switch-previous",function(event){_infx.navigation.genericNav.switchToParentLevel($(this));});$(".top-nav-sliding-nav").on("touchstart",function(){_infx.navigation.genericNav.toggleMenu();});$(".top-nav-sliding-nav-wrapper").on("touchend",function(){});$(".top-nav-sliding-nav-wrapper").on("touchstart","a.subnav-switch-next",function(event){event.stopPropagation();event.preventDefault();_infx.navigation.genericNav.switchToChildLevel($(this));});$(".top-nav-sliding-nav-wrapper").on("touchstart","a.subnav-switch-previous",function(event){event.stopPropagation();event.preventDefault();_infx.navigation.genericNav.switchToParentLevel($(this));});$(window).on("resize",function(){_infx.navigation.genericNav.remeasureWidths();});_infx.navigation.genericNav.remeasureWidths();setTimeout(function(){_infx.navigation.genericNav.remeasureWidths();},1000);}},swipeNav:{currentPage:0,siblings:[],element:$(".swipe-navigation-wrapper"),thresholdMode:"distance",thresholdSpeed:300,thresholdDistance:100,infinite:true,leftPageValues:{},rightPageValues:{},pageRatio:0,bodyTween:null,sensitivity:2,hideWrapper:function(){$(".swipe-navigation-wrapper").css({"display":"none"});},showWrapper:function(){$(".swipe-navigation-wrapper").css({"display":"block"});},snapBack:function(){_infx.navigation.swipeNav.bodyTween=TweenMax.to(".swipe-navigation-wrapper .cover",1,{opacity:0,ease:Elastic.easeOut});TweenMax.to(_infx.navigation.swipeNav,0.3,{pageRatio:0,ease:Linear.easeOut,onUpdate:function(){_infx.navigation.swipeNav.positionPages();},onComplete:function(){_infx.navigation.swipeNav.hideWrapper();}});},snapAsideAndLoad:function(indexChange,newIndex){TweenMax.to(".swipe-navigation-wrapper .cover",1,{opacity:1,ease:Elastic.easeOut,onComplete:function(){_infx.navigation.swipeNav.loadNewPage(newIndex);$(".swipe-navigation-wrapper .left-page,.swipe-navigation-wrapper .right-page ").css({"transition":"all 20s ease-out","transform":"scale(0)"})}});_infx.navigation.swipeNav.pageRatio=-indexChange;_infx.navigation.swipeNav.positionPages();},loadNewPage:function(index){var path=_infx.navigation.swipeNav.siblings[index].path;document.location.href=path;},calculatePageValues:function(){_infx.navigation.swipeNav.leftPageValues={lpOrigWidth:_infx.navigation.swipeNav.screenHalfWidth,lpOrigHeight:_infx.navigation.swipeNav.screenHeight/2,lpOrigLeft:-_infx.navigation.swipeNav.screenHalfWidth/2,lpOrigTop:_infx.navigation.swipeNav.screenHeight/2/2,lpShownWidth:_infx.navigation.swipeNav.screenHalfWidth*1.5,lpShownHeight:_infx.navigation.swipeNav.screenHeight/2*1.5,lpShownLeft:(_infx.navigation.swipeNav.screenWidth-_infx.navigation.swipeNav.screenHalfWidth*1.5)/2,lpShownTop:(_infx.navigation.swipeNav.screenHeight-_infx.navigation.swipeNav.screenHeight/2*1.5)/2};_infx.navigation.swipeNav.rightPageValues={rpOrigWidth:_infx.navigation.swipeNav.screenHalfWidth,rpOrigHeight:_infx.navigation.swipeNav.screenHeight/2,rpOrigRight:-_infx.navigation.swipeNav.screenHalfWidth/2,rpOrigTop:_infx.navigation.swipeNav.screenHeight/2/2,rpShownWidth:_infx.navigation.swipeNav.screenHalfWidth*1.5,rpShownHeight:_infx.navigation.swipeNav.screenHeight/2*1.5,rpShownRight:(_infx.navigation.swipeNav.screenWidth-_infx.navigation.swipeNav.screenHalfWidth*1.5)/2,rpShownTop:(_infx.navigation.swipeNav.screenHeight-_infx.navigation.swipeNav.screenHeight/2*1.5)/2};},positionLeftPage:function(ratio){var w=_infx.navigation.swipeNav.leftPageValues.lpOrigWidth+((_infx.navigation.swipeNav.leftPageValues.lpShownWidth-_infx.navigation.swipeNav.leftPageValues.lpOrigWidth)*ratio);var h=_infx.navigation.swipeNav.leftPageValues.lpOrigHeight+((_infx.navigation.swipeNav.leftPageValues.lpShownHeight-_infx.navigation.swipeNav.leftPageValues.lpOrigHeight)*ratio);var l=_infx.navigation.swipeNav.leftPageValues.lpOrigLeft+((_infx.navigation.swipeNav.leftPageValues.lpShownLeft-_infx.navigation.swipeNav.leftPageValues.lpOrigLeft)*ratio);var t=_infx.navigation.swipeNav.leftPageValues.lpOrigTop+((_infx.navigation.swipeNav.leftPageValues.lpShownTop-_infx.navigation.swipeNav.leftPageValues.lpOrigTop)*ratio);$("#swipe-navigation-wrapper").find(".left-page").css({"width":w+"px","height":h+"px","left":l+"px","top":t+"px","opacity":ratio*10});},positionRightPage:function(ratio){var w=_infx.navigation.swipeNav.rightPageValues.rpOrigWidth+((_infx.navigation.swipeNav.rightPageValues.rpShownWidth-_infx.navigation.swipeNav.rightPageValues.rpOrigWidth)*ratio);var h=_infx.navigation.swipeNav.rightPageValues.rpOrigHeight+((_infx.navigation.swipeNav.rightPageValues.rpShownHeight-_infx.navigation.swipeNav.rightPageValues.rpOrigHeight)*ratio);var l=_infx.navigation.swipeNav.rightPageValues.rpOrigRight+((_infx.navigation.swipeNav.rightPageValues.rpShownRight-_infx.navigation.swipeNav.rightPageValues.rpOrigRight)*ratio);var t=_infx.navigation.swipeNav.rightPageValues.rpOrigTop+((_infx.navigation.swipeNav.rightPageValues.rpShownTop-_infx.navigation.swipeNav.rightPageValues.rpOrigTop)*ratio);$("#swipe-navigation-wrapper").find(".right-page").css({"width":w+"px","height":h+"px","right":l+"px","top":t+"px","opacity":ratio*10});},positionPages:function(){var absratio=Math.abs(_infx.navigation.swipeNav.pageRatio);if(_infx.navigation.swipeNav.pageRatio<=0){_infx.navigation.swipeNav.positionLeftPage(0);_infx.navigation.swipeNav.positionRightPage(absratio<=1?absratio:1);}else{_infx.navigation.swipeNav.positionLeftPage(absratio<=1?absratio:1);_infx.navigation.swipeNav.positionRightPage(0);}},onDragStart:function(event){if($(event.target).parents(".slick-slider").length!==0){return;}
if($(event.target).parents(".picture-grid").length!==0){return;}
if($(event.target).parents(".drag-parallax").length!==0){return;}
if($(event.target).parents("#mypopupcontent").length!==0){return;}
if(_infx.navigation.swipeNav.bodyTween){_infx.navigation.swipeNav.bodyTween.kill();}
_infx.navigation.swipeNav.pressedDown=true;_infx.navigation.swipeNav.distanceXOld=_infx.navigation.swipeNav.startX;_infx.navigation.swipeNav.startTime=(new Date()).getTime();_infx.navigation.swipeNav.speedTimeOld=_infx.navigation.swipeNav.startTime;},onDragMove:function(event,x,y){if(_infx.navigation.swipeNav.pressedDown===true){_infx.navigation.swipeNav.midTime=(new Date()).getTime();_infx.navigation.swipeNav.currentDistanceXFromStart=x-_infx.navigation.swipeNav.startX;_infx.navigation.swipeNav.currentDistanceX=x-_infx.navigation.swipeNav.distanceXOld;_infx.navigation.swipeNav.currentDistanceY=y-_infx.navigation.swipeNav.distanceYOld;_infx.navigation.swipeNav.currentSpeed=_infx.navigation.swipeNav.currentDistanceX/((_infx.navigation.swipeNav.midTime-_infx.navigation.swipeNav.speedTimeOld)/1000);var opac=Math.abs(_infx.navigation.swipeNav.currentDistanceXFromStart/_infx.navigation.swipeNav.screenHalfWidth)*_infx.navigation.swipeNav.sensitivity;if(opac>1){opac=1;}
if(opac<0){opac=0;}
if(_infx.navigation.swipeNav.currentDistanceXFromStart<_infx.navigation.swipeNav.screenHalfWidth){}
if(_infx.navigation.swipeNav.thresholdMode==="speed"){if(_infx.navigation.swipeNav.currentSpeed>=_infx.navigation.swipeNav.thresholdSpeed){}}else if(_infx.navigation.swipeNav.thresholdMode==="distance"){if(Math.abs(_infx.navigation.swipeNav.currentDistanceXFromStart)>=_infx.navigation.swipeNav.thresholdDistance){if(Math.abs(Math.abs(y)-Math.abs(_infx.navigation.swipeNav.startY))<50){_infx.navigation.swipeNav.pageRatio=(_infx.navigation.swipeNav.currentDistanceXFromStart/_infx.navigation.swipeNav.screenHalfWidth)*_infx.navigation.swipeNav.sensitivity;$("#page-shell").css("transition","all 0.3s linear").css("opacity",0);_infx.navigation.swipeNav.showWrapper();if(_infx.navigation.swipeNav.pageRatio<=0){_infx.navigation.swipeNav.pageRatio=0;_infx.navigation.swipeNav.shiftLeft();}else{_infx.navigation.swipeNav.pageRatio=0;_infx.navigation.swipeNav.shiftRight();}
_infx.navigation.swipeNav.pressedDown=false;}}}
_infx.navigation.swipeNav.distanceXOld=x;_infx.navigation.swipeNav.distanceYOld=y;_infx.navigation.swipeNav.speedTimeOld=_infx.navigation.swipeNav.midTime;}},onDragEnd:function(event){if(_infx.navigation.swipeNav.pressedDown===true){_infx.navigation.swipeNav.endTime=(new Date()).getTime();_infx.navigation.swipeNav.touchDistance=_infx.navigation.swipeNav.currentDistanceXFromStart=(_infx.navigation.swipeNav.endX-_infx.navigation.swipeNav.startX)*1;_infx.navigation.swipeNav.touchDistanceY=_infx.navigation.swipeNav.currentDistanceYFromStart=(_infx.navigation.swipeNav.endY-_infx.navigation.swipeNav.startY)*1;if(Math.abs(_infx.navigation.swipeNav.currentDistanceYFromStart)>Math.abs(_infx.navigation.swipeNav.currentDistanceXFromStart)/10){}
if(Math.abs(_infx.navigation.swipeNav.touchDistance)<(_infx.navigation.swipeNav.screenHalfWidth/2)){}else{}
_infx.navigation.swipeNav.pressedDown=false;}},findLastSibling:function(){for(var i=_infx.navigation.swipeNav.siblings.length-1;i>=0;i--){if(_infx.navigation.swipeNav.siblings[i].path!=="")return i;}},findFirstSibling:function(){for(var i=0;i<_infx.navigation.swipeNav.siblings.length;i++){if(_infx.navigation.swipeNav.siblings[i].path!=="")return i;}},checkShift:function(indexChange,newIndex){if(_infx.navigation.swipeNav.infinite===false){if(newIndex<0){_infx.navigation.swipeNav.snapBack();}else if(newIndex>_infx.navigation.swipeNav.siblings.length-1){_infx.navigation.swipeNav.snapBack();}else{_infx.navigation.swipeNav.snapAsideAndLoad(indexChange,newIndex);}}else{if(newIndex<_infx.navigation.swipeNav.findFirstSibling()){_infx.navigation.swipeNav.snapAsideAndLoad(indexChange,_infx.navigation.swipeNav.findLastSibling());}else if(newIndex>_infx.navigation.swipeNav.siblings.length-1){_infx.navigation.swipeNav.snapAsideAndLoad(indexChange,_infx.navigation.swipeNav.findFirstSibling());}else{_infx.navigation.swipeNav.snapAsideAndLoad(indexChange,newIndex);}}},shiftLeft:function(){TweenMax.to(_infx.navigation.swipeNav,0.3,{pageRatio:-1,ease:Linear.easeOut,onUpdate:function(){_infx.navigation.swipeNav.positionPages();},onComplete:function(){_infx.navigation.swipeNav.checkShift(1,_infx.navigation.swipeNav.currentPage+1);}});},shiftRight:function(){TweenMax.to(_infx.navigation.swipeNav,0.3,{pageRatio:1,ease:Linear.easeOut,onUpdate:function(){_infx.navigation.swipeNav.positionPages();},onComplete:function(){_infx.navigation.swipeNav.checkShift(-1,_infx.navigation.swipeNav.currentPage-1);}});},findSiblings:function(jsonArray){for(var i=0;i<jsonArray.length;i++){if(jsonArray[i].active===true){if(jsonArray[i]["children"]&&jsonArray[i]["children"].length!==0){_infx.navigation.swipeNav.findSiblings(jsonArray[i]["children"]);}else{_infx.navigation.swipeNav.currentPage=i;for(var j=0;j<jsonArray.length;j++){_infx.navigation.swipeNav.siblings.push({name:jsonArray[j].name,path:jsonArray[j].path});}}}}
},init:function(){_infx.navigation.swipeNav.findSiblings(_infx.navigation.data.children);_infx.navigation.swipeNav.screenWidth=$(window).width();_infx.navigation.swipeNav.screenHalfWidth=_infx.navigation.swipeNav.screenWidth/2;_infx.navigation.swipeNav.screenHeight=$(window).height();$("#swipe-navigation-wrapper").remove();var clone=$("#swipe-navigation-helpers").find(".swipe-navigation-wrapper").clone();clone.attr("id","swipe-navigation-wrapper");$("body").append(clone);_infx.navigation.swipeNav.calculatePageValues();_infx.navigation.swipeNav.positionLeftPage(_infx.navigation.swipeNav.pageRatio);_infx.navigation.swipeNav.positionRightPage(_infx.navigation.swipeNav.pageRatio);var lpname="";var rpname="";if(_infx.navigation.swipeNav.infinite===false){lpname=typeof _infx.navigation.swipeNav.siblings[_infx.navigation.swipeNav.currentPage-1]!='undefined'?_infx.navigation.swipeNav.siblings[_infx.navigation.swipeNav.currentPage-1].name:"";rpname=typeof _infx.navigation.swipeNav.siblings[_infx.navigation.swipeNav.currentPage+1]!='undefined'?_infx.navigation.swipeNav.siblings[_infx.navigation.swipeNav.currentPage+1].name:"";}else{lpname=typeof _infx.navigation.swipeNav.siblings[_infx.navigation.swipeNav.currentPage-1]!='undefined'?_infx.navigation.swipeNav.siblings[_infx.navigation.swipeNav.currentPage-1].name:_infx.navigation.swipeNav.siblings[_infx.navigation.swipeNav.siblings.length-1].name;rpname=typeof _infx.navigation.swipeNav.siblings[_infx.navigation.swipeNav.currentPage+1]!='undefined'?_infx.navigation.swipeNav.siblings[_infx.navigation.swipeNav.currentPage+1].name:_infx.navigation.swipeNav.siblings[0].name;}
if(lpname!==""){$("#swipe-navigation-wrapper").find(".left-page").find(".title").text(lpname);}
else{$("#swipe-navigation-wrapper").find(".left-page").addClass("last");}
if(rpname!==""){$("#swipe-navigation-wrapper").find(".right-page").find(".title").text(rpname);}
else{$("#swipe-navigation-wrapper").find(".right-page").addClass("last");}
$("body").off("touchstart").on("touchstart",function(event){_infx.navigation.swipeNav.startX=event.originalEvent.touches[0].clientX;_infx.navigation.swipeNav.startY=event.originalEvent.touches[0].clientY;_infx.navigation.swipeNav.onDragStart(event);});$(window).off("touchmove").on("touchmove",function(event){var x=event.originalEvent.touches[0].clientX;var y=event.originalEvent.touches[0].clientY;_infx.navigation.swipeNav.onDragMove(event,x,y);});$(window).off("touchend").on("touchend",function(event){_infx.navigation.swipeNav.endX=event.originalEvent.changedTouches[0].clientX;_infx.navigation.swipeNav.endY=event.originalEvent.changedTouches[0].clientY;_infx.navigation.swipeNav.onDragEnd(event);});$("body").off("mousedown").on("mousedown",function(event){_infx.navigation.swipeNav.startX=event.clientX;_infx.navigation.swipeNav.startY=event.clientY;_infx.navigation.swipeNav.onDragStart(event);});$(window).off("mousemove").on("mousemove",function(event){var x=event.clientX;var y=event.clientY;_infx.navigation.swipeNav.onDragMove(event,x,y);});$(window).off("mouseup").on("mouseup",function(event){_infx.navigation.swipeNav.endX=event.clientX;_infx.navigation.swipeNav.endY=event.clientY;_infx.navigation.swipeNav.onDragEnd(event);});$(window).on("resize",function(){clearTimeout(_infx.navigation.swipeNav.resizeTimeout);_infx.navigation.swipeNav.resizeTimeout=setTimeout(function(){_infx.navigation.swipeNav.init();},200);});$(window).on("keydown",function(event){if(event.keyCode===39){_infx.navigation.swipeNav.showWrapper();_infx.navigation.swipeNav.shiftLeft();}
if(event.keyCode===37){_infx.navigation.swipeNav.showWrapper();_infx.navigation.swipeNav.shiftRight();}});}}}
_infx=(typeof(_infx)==='undefined')?{}:_infx;_infx.form={debug:0,setupReturnSequence:function(input){if(this.debug){console.log('_infx.form.setupReturnSequence called',input);};if(Object.prototype.toString.call(input.names)==='[object Array]'){jQuery.each(input.names,function(idx,name){var $el=$(((input.scope)?input.scope+" ":"")+'input[name="'+name+'"]');if($el.length){var closure=function(idx){return function(event){var action=(idx==input.names.length-1)?'submit':'next';if(_infx.form.debug){console.log('event:',event,'idx:',idx,"action:",action);};if(event.which==13){if(action=='next'){$(((input.scope)?input.scope+" ":"")+'input[name="'+input.names[idx+1]+'"]').focus();}else{if(typeof(input.trigger)!=='undefined'){var $trigger=$(((input.scope)?input.scope+" ":"")+input.trigger.selector);if(!$trigger.length){console.error("_infx.form.setupReturnSequence can't find element to trigger event using selector:",input.trigger.selector);}else{$trigger.trigger(input.trigger.event);};}else{$(((input.scope)?input.scope+" ":"")+'input[name="'+input.names[idx]+'"]').closest('form').submit();};};};};};$el.on('keypress.infx.form',closure(idx));}else{console.error("_infx.form.setupReturnSequence can't find element with name:",name);};});}else{console.error("_infx.form.setupReturnSequence expects an array containing form names");};}};var widget_script='/cgi-bin/infxwidgets/widget-node-navigation.pl';var timeouts=new Array();timeouts['product_navigation']=null;timeouts['product_finder']=null;timeouts['product_breadcrumb']=null;timeouts['product_breadcrumb_open']=null;function truncate(s,l){if(s.length>l){s=s.substring(0,l-3)
for(var j=s.length;j>0;j--){if(s.charAt(j)==";")j=-1
if(s.charAt(j)=="&")return s.substring(0,j)+"...";}
return s+"...";}
return s;}
function create_menu(json,node_id,whatisit,first){var cat=_ext.JSON.decode(json);var string=(first)?"<ul id='"+whatisit+"_ul_"+node_id+"'>":"<ul id='"+whatisit+"_ul_"+node_id+"' class='sub'>";for(var p in cat){var text=cat[p].text;delete cat[p].text;var click=(cat[p].disabled)?"":"onclick='navigate_menu("+_ext.JSON.encode(cat[p])+");'";cat[p].text=text;var mover="onmouseover=do_menu('"+cat[p].id+"',1,"+cat[p].leaf+","+((cat[p].disabled)?1:0)+",'"+whatisit+"')";var mout="onmouseout=do_menu('"+cat[p].id+"',0,"+cat[p].leaf+","+((cat[p].disabled)?1:0)+",'"+whatisit+"')";var sub_div="<div class='sub' id='"+whatisit+"_"+cat[p].id+"'><\/div>";var text_div="<div "+mover+" "+mout+" "+click+">"+cat[p].text+"<\/div>";var classes=new Array();if(p!=(cat.length-1))classes.push("border");if(cat[p].disabled)classes.push("disabled");if(!parseInt(cat[p].leaf)){classes.push("folder");string+="<li id='"+whatisit+"_li_"+cat[p].id+"' class='"+classes.join(" ")+"'>"+sub_div+""+text_div+"<\/li>";}else{classes.push("file");string+="<li id='"+whatisit+"_li_"+cat[p].id+"' class='"+classes.join(" ")+"'>";string+="<div "+mover+" "+mout+" "+click+">";string+=cat[p].text;string+="<\/div>";string+="<\/li>";}}
string+="<\/ul>";rtnEl(whatisit+'_'+node_id).innerHTML=string;if(cat.length>0){rtnEl(whatisit+'_'+node_id).style.visibility="visible";rtnEl(whatisit+'_ul_'+node_id).style.visibility="visible";}}
function do_menu(node_id,isover,isleaf,isdisabled,whatisit){if(isover){timeout_menu_types(0,whatisit);var li_el=rtnEl(whatisit+'_li_'+node_id);if(!isdisabled)alter_class(li_el,'hilite','add');var el=rtnEl(whatisit+'_'+node_id);if(el){el.style.display='inline';if(el.innerHTML==""){$.ajax({url:widget_script,type:'post',data:{'menu_node':node_id},success:function(data){create_menu(data,node_id,whatisit,0);}});}else{hide_grand_children(node_id,whatisit);if(el.childNodes[0].childNodes.length>0){rtnEl(whatisit+'_ul_'+node_id).style.visibility="visible";rtnEl(whatisit+'_ul_'+node_id).style.display="block";}}
}
hide_brother_children(node_id,whatisit);}else{timeout_menu_types(1,whatisit);}}
function hide_grand_children(node_id,whatisit){div_node=rtnEl(whatisit+'_'+node_id);if(div_node.childNodes[0]){for(var i=0;i<div_node.childNodes[0].childNodes.length;i++){var el=div_node.childNodes[0].childNodes[i];alter_class(el,'hilite','remove');if(el.childNodes[1]){el.childNodes[0].style.visibility="hidden";el.childNodes[0].style.display="none";}}}}
function hide_brother_children(node_id,whatisit){li_node=rtnEl(whatisit+'_li_'+node_id);div_parent=li_node.parentNode.parentNode;for(var i=0;i<div_parent.childNodes[0].childNodes.length;i++){var el=div_parent.childNodes[0].childNodes[i];if(el.id!=whatisit+'_li_'+node_id){alter_class(el,'hilite','remove');if(el.childNodes[1]){el.childNodes[0].style.visibility="hidden";el.childNodes[0].style.display='none';}}}}
function find_breadcrumb(breadcrumb_node){$.ajax({url:widget_script,type:'post',data:{'breadcrumb_node':breadcrumb_node},success:function(data){create_menu(data,breadcrumb_node,'product_breadcrumb',0);}});}
function create_breadcrumb(json,node_id,whatisit){var s=_ext.JSON.decode(json);var string="<ul>";string+="<li class='top'><a href='/index.shtml'>Home</a><\/li> ";while(s.child){var text=s.text;delete s.text;string+=" <span class='divider'>&#187;</span> <div class='menu' id='"+whatisit+"_"+s.id+"'><\/div> <li id='"+whatisit+"_li_"+s.id+"' onmouseover=\"delayed_display_menu('"+s.id+"',1,'"+whatisit+"',2000);\" onmouseout=delayed_display_menu('"+s.id+"',0,'"+whatisit+"',0) class='top'><a href='#navigate-to' onmousedown='navigate_menu("+_ext.JSON.encode(s)+");'>"+s.name+"</a><\/li>";s.text=text;s=s.child;}
string+="<\/ul>";rtnEl('product_breadcrumb').innerHTML=string;}
function delayed_display_menu(node_id,over,whatisit,delay){if(timeouts['product_breadcrumb_open'])clearTimeout(timeouts['product_breadcrumb_open']);if(over){timeouts['product_breadcrumb_open']=setTimeout("display_menu('"+node_id+"',"+over+",'"+whatisit+"')",delay);}else{display_menu(node_id,over,whatisit);}}
function display_menu(node_id,over,whatisit){timeout_menu_types(0,whatisit);var el=rtnEl(whatisit+'_li_'+node_id);if(over){alter_class(el,'hilite','add');alter_class(el,'active','add');if(rtnEl(whatisit+'_'+node_id)){if(rtnEl(whatisit+'_'+node_id).innerHTML==""){$.ajax({url:widget_script,type:'post',data:{'first_menu_node':node_id},success:function(data){create_menu(data,node_id,whatisit,1);}});}
close_menu(node_id,whatisit);hide_grand_children(node_id,whatisit);}}else{alter_class(el,'hilite','remove');alter_class(el,'active','add');timeout_menu_types(1,whatisit);}}
function create_finder(finder_node,over){var whatisit="product_finder";if(over){timeout_menu_types(0,whatisit);var mycontainer=rtnEl(whatisit);if(!rtnEl(whatisit+"_"+finder_node)){var firstdiv=document.createElement("div");firstdiv.setAttribute("id",whatisit+"_"+finder_node);mycontainer.appendChild(firstdiv);$.ajax({url:widget_script,type:'post',data:{'menu_node':finder_node},success:function(data){create_menu(data,finder_node,whatisit,1);}});}
else{rtnEl(whatisit+"_"+finder_node).style.display="inline";hide_grand_children(finder_node,whatisit);}}else{timeout_menu_types(1,whatisit);}}
function navigation(parent_node,option,type){var whatisit=(type)?type:"product_navigation";var mycontainer=rtnEl(whatisit);if(!rtnEl(whatisit+"_"+parent_node)){var myfirstdiv=document.createElement("div");myfirstdiv.setAttribute("id",whatisit+"_"+parent_node);mycontainer.appendChild(myfirstdiv);$.ajax({url:widget_script,type:'post',data:{'menu_node':parent_node},success:function(data){if(option){create_menu(data,parent_node,whatisit,1);}else{create_navigation(data,parent_node,whatisit,1);}}});}}
function create_navigation(json,node_id,whatisit){var cat=_ext.JSON.decode(json);var string;string="<ul id='"+whatisit+"_ul_"+node_id+"'>";for(var p in cat){var text=cat[p].text;delete cat[p].text;var click=(cat[p].disabled)?"":"onclick='navigate_menu("+_ext.JSON.encode(cat[p])+");'";cat[p].text=text;var mover=(cat[p].disabled)?"":"onmouseover=navigation_hilite('"+cat[p].id+"',1,'"+whatisit+"')";var mout=(cat[p].disabled)?"":"onmouseout=navigation_hilite('"+cat[p].id+"',0,'"+whatisit+"')";var text_div="<div "+click+" "+mover+" "+mout+">"+cat[p].text+"<\/div>";var classes=new Array();classes.push((!cat[p].leaf)?"folder":"file");if(p!=(cat.length-1))classes.push("border");if(cat[p].disabled)classes.push("disabled");string+=(!cat[p].leaf)?"<li id='"+whatisit+"_li_"+cat[p].id+"' class='"+classes.join(" ")+"'>"+text_div+"<\/li>":"<li id='"+whatisit+"_li_"+cat[p].id+"' class='"+classes.join(" ")+"'><div "+mover+" "+mout+" "+click+">"+cat[p].text+"<\/div><\/li>";string+="";}
string+="<\/ul>";rtnEl(whatisit+'_'+node_id).innerHTML=string;if(cat.length>0){rtnEl(whatisit+'_'+node_id).style.visibility="visible";rtnEl(whatisit+'_ul_'+node_id).style.visibility="visible";}}
function navigation_hilite(node_id,over,whatisit){alter_class(rtnEl(whatisit+"_li_"+node_id),'hilite',(over)?'add':'remove');}
function close_menu(node_id,whatisit){var container=rtnEl(whatisit);for(var i=0;i<container.childNodes[0].childNodes.length;i++){var el=container.childNodes[0].childNodes[i];if(el.tagName){if(el.tagName.toLowerCase()=='div'){el.style.display=(el.id!=whatisit+'_'+node_id)?'none':'inline';}
else if(el.tagName.toLowerCase()=='li'){if(el.id!=whatisit+'_li_'+node_id){alter_class(el,'active','remove');}}}}}
function alter_class(element,classname,action){if(element){var classRegEx=new RegExp(" "+classname,"g");element.className=element.className.replace(classRegEx,"");if(action=='add')element.className+=" "+classname;}}
function close_menu_types(node_id,whatisit){if(whatisit.indexOf('finder')!=-1){var obj=rtnEl(whatisit+"_0");if(obj)obj.style.display="none";}else if(whatisit.indexOf('navigation')!=-1){var container=rtnEl(whatisit);var ul_elements=container.getElementsByTagName('ul');for(var x=0;x<ul_elements.length;x++){if(x==0){var li_elements=ul_elements[x].getElementsByTagName('li');for(var y=0;y<li_elements.length;y++){alter_class(li_elements[y],'hilite','remove');}}else{ul_elements[x].style.display='none';}}
}else if(whatisit.indexOf('breadcrumb')!=-1){close_menu(node_id,whatisit);}}
function debug(text){var panel=rtnEl('debug_panel');panel.innerHTML+=text+"<br>";}
function timeout_menu_types(set,whatisit){if(!set){clearTimeout(timeouts[whatisit]);timeouts[whatisit]=null;}else{timeouts[whatisit]=setTimeout("close_menu_types('ul_0','"+whatisit+"');",1000);}}
function navigate_menu(node){if(typeof(node.post)=='object'){var form=document.createElement("form");form.action=node.action;form.method='post';for(var p in node.post){var el=document.createElement("input");el.type="hidden";el.name=p;el.value=(typeof v=="object")?_ext.JSON.encode(node.post[p]):node.post[p];form.appendChild(el);}
document.body.appendChild(form);form.submit();}else{if(node.link!=null&&node.link!='')location.href=node.link;}}
_infx=(typeof(_infx)==='undefined')?{}:_infx;_infx.validate={debug:0,errorTxt:"Some of the fields below are required or the information given is not valid, for further information move your mouse over the highlighted boxes below.",regEx:{'url':/^((http|https):\/\/([\-\w]+\.)+\w{2,3}(\/[%\-\w]+(\.\w{2,})?)*(([\w\-\.\?\\/+@&#;`~=%!]*)(\.\w{2,})?)*\/?)/i,'email':/^([\w_-]+)(\.[\w_-]+)*@([\w_-]+)(\.[\w_-]*){0,1}(\.[a-zA-Z]{2,4}){1,2}$/,'ukpostcode':/^[a-zA-Z0-9 ]+$/i,'loosedate':/^([0-9]){1,2}[\/:-]{1}([0-9]){1,2}[\/:-]([0-9]){4}$/,'dd/mm/yyyy':/^\d{2}\/(\d){2}\/(\d){4}$/,'dd-mm-yyyy':/^\d{2}\-(\d){2}\-(\d){4}$/,'yyyy/mm/dd':/^(\d){4}\/\d{2}\/(\d){2}$/,'yyyy-mm-dd':/^(\d){4}\-\d{2}\-(\d){2}$/,'loosedatetime':/^([0-9]){1,2}[\/:-]{1}([0-9]){1,2}[\/:-]([0-9]){4} [0-9]{2}:{1}[0-9]{2}$/,'hh:mm':/^[0-9]{2}:{1}[0-9]{2}$/,'carddate':/^([0-9]){1,2}[\/:-]{1}([0-9]){1,2}$/,'simplepassword':/^.{6,100}$/,'twitterhandle':/^@[a-zA-Z0-9_]{1,15}$/,'username':/^[a-zA-Z0-9]{3,100}$/,'secureusername':/^[a-zA-Z0-9\-]{6,100}$/,'currency':/^-?\d+(\.\d{1,2})?$/,'telephone':/^(^[0-9\+ \-\)\(]+)$/,'numeric':/^-?([0-9]+)$/,'notblank':/[a-zA-Z_0-9]+/,'ignoretags':/fieldset/i,},input:{oldError:function(input){if(_infx.validate.debug){console.log('_infx.validate.input.oldError called',input);};if(input.robj.type='radio'&&rtnEl(input.robj.element.name+"_div")){input.robj.element=rtnEl(input.robj.element.name+"_div");};$(input.robj.element).removeClass('hilite-valid').addClass('hilite-error').attr('title',input.robj.alt_tag);$(input.robj.element).off('change.infx.validation').on('change.infx.validation',function(){clear_error({'element':input.robj.element});});},oldPass:function(input){if(_infx.validate.debug){console.log('_infx.validate.input.oldPass called',input);};if(input.robj.type='radio'&&rtnEl(input.robj.element.name+"_div")){input.robj.element=rtnEl(input.robj.element.name+"_div");};$(input.robj.element).removeClass('hilite-error').addClass('hilite-valid').attr('title',input.robj.alt_tag);$(input.robj.element).off('change.infx.validation').on('change.infx.validation',function(){clear_error({'element':input.robj.element});});},oldReset:function(input){if(_infx.validate.debug){console.log('_infx.validate.input.oldReset called',input);};if(input.robj.type='radio'&&rtnEl(input.robj.element.name+"_div")){input.robj.element=rtnEl(input.robj.element.name+"_div");};$(input.robj.element).removeClass('hilite-error hilite-valid').attr('title',input.robj.alt_tag);},error:function($input,message){if(_infx.validate.debug){console.log('_infx.validate.input.error called input:',$input,'message:',message);};if($input.length!=0){$input.removeClass('hilite-valid').addClass('hilite-error');_infx.validate.displayValidationResult($input,'error',message);$input.data('validation-state','error');$input.off('change.infx.validation').on('change.infx.validation',function(){_infx.validate.input.reset($(this));});};},pass:function($input,message){if(_infx.validate.debug){console.log('_infx.validate.input.pass called input:',$input,'message:',message);};if($input.length!=0){$input.removeClass('hilite-error').addClass('hilite-valid');_infx.validate.displayValidationResult($input,'pass',message);$input.data('validation-state','pass');};},reset:function($input){if(_infx.validate.debug){console.log('_infx.validate.input.reset called input:',$input);};if($input.length!=0){$input.removeClass('hilite-error hilite-valid');$input.siblings('.infx-validation-result').removeClass('infx-error-message infx-success-message').html("");};}},displayValidationResult:function($input,state,message){var $validation_result=$input.siblings('.infx-validation-result');if($validation_result.length){if(typeof(message)=='undefined'||message==""){$validation_result.hide();}else{$validation_result.removeClass('infx-error-message infx-success-message');if(state=="error"){$validation_result.addClass('infx-error-message');}else if(state=="pass"){$validation_result.addClass('infx-success-message');};$validation_result.html(message).show();};};},displayMessage:function(input){if(_infx.validate.debug){console.log('_infx.validate.input.displayMessage',input);};var messageConfig={title:undefined,body:undefined,state:undefined,fadeSpeed:200,autoHide:undefined};$.extend(messageConfig,input.message);if(input.$form.find('div.infx-message-wrapper').length==0){input.$form.prepend($("<div/>").attr('class','infx-message-wrapper'));};$("html, body").animate({scrollTop:input.$form.offset().top-_infx.config.scrollTopOffset},'fast',function(){var $message=input.$form.find('div.infx-message-wrapper');if(_infx.validate.debug>1){console.log("message offset: "+$message.offset().top+" top offset: "+_infx.config.scrollTopOffset);};if(typeof(messageConfig.state)!='undefined'&&messageConfig.state!=null){$message.removeClass('success-state warning-state error-state').addClass(messageConfig.state);};var messageHTML=(typeof messageConfig.title!=='undefined')?'<div class="infx-message-title">'+messageConfig.title+"</div>":"";messageHTML+=messageConfig.body;$message.html(messageHTML).fadeIn(messageConfig.fadeSpeed,function(){if(messageConfig.autoHide){$(this).delay(messageConfig.autoHide).fadeOut(messageConfig.fadeSpeed);};});});},isValidDate:function(dateString){var config={splitter:undefined,didx:undefined,midx:undefined,yidx:undefined};if(_infx.validate.regEx['dd/mm/yyyy'].test(dateString)){config={splitter:'/',didx:0,midx:1,yidx:2};}else if(_infx.validate.regEx['dd-mm-yyyy'].test(dateString)){config={splitter:'-',didx:0,midx:1,yidx:2};}else if(_infx.validate.regEx['yyyy/mm/dd'].test(dateString)){config={splitter:'/',didx:2,midx:1,yidx:0};}else if(_infx.validate.regEx['yyyy-mm-dd'].test(dateString)){config={splitter:'-',didx:2,midx:1,yidx:0};}else{return false;};var parts=dateString.split(config.splitter);var day=parseInt(parts[config.didx],10);var month=parseInt(parts[config.midx],10);var year=parseInt(parts[config.yidx],10);if(year<1000||year>3000||month==0||month>12){return false;};var monthLength=[31,28,31,30,31,30,31,31,30,31,30,31];if(year%400==0||(year%100!=0&&year%4==0)){monthLength[1]=29;};return day>0&&day<=monthLength[month-1];}};var errorTxt=_infx.validate.errorTxt;var urlRegxp=_infx.validate.regEx.url;var emailRegxp=_infx.validate.regEx.email;var pcodeRegxp=_infx.validate.regEx.ukpostcode;var dateRegxp=_infx.validate.regEx.loosedate;var dateTimeRegxp=_infx.validate.regEx.loosedatetime;var carddateRegxp=_infx.validate.regEx.carddate;var passwordRegxp=_infx.validate.regEx.simplepassword;var twitterRegxp=_infx.validate.regEx.twitterhandle;var timeRegxp=_infx.validate.regEx['hh:mm'];var usernameReqxp=_infx.validate.regEx.username;var secureusernameReqxp=_infx.validate.regEx.secureusername;var currencyRegxp=_infx.validate.regEx.currency;var telnoRegxp=_infx.validate.regEx.telephone;var numericRegxp=_infx.validate.regEx.numeric;var notblankRegxp=_infx.validate.regEx.notblank;var ignoretagsRegxp=_infx.validate.regEx.ignoretags;function clear_error(robj){_infx.validate.input.oldReset({robj:robj});};function hilite_error(robj){_infx.validate.input.oldError({robj:robj});};function hilite_validated(robj){_infx.validate.input.oldPass({robj:robj});};var validate={};function verifylist(formobj,chklist,error_display_id){var fail=0;var result_array=new Array();for(var i=0;i<formobj.length;i++){var e=formobj.elements[i];if(_infx.validate.regEx.ignoretags.test(e.tagName)==true||e.tagName==''){continue;}
var valobj={};var robj={};robj.debug='';var val=chklist[e.name];if(typeof val=='string'){valobj.type=val;}else{valobj=val;};robj.debug+="Field: "+e.name;if(valobj){robj.element=e;robj.alt_tag='';robj.good=0;robj.type=valobj.type;robj.debug+=" ("+valobj.type+")";if((isdisplayed(e)&&e.type!='hidden')||valobj.hidden){robj.debug+=" Visible";validate_field_value(robj,valobj);}else{robj.debug+=" Invisible";robj.good=1;};result_array.push(robj);}else{robj.debug+=" (NOT IN CHECKLIST)\n";};};var debugTxt="";for(var x=0;x<result_array.length;x++){var robj=result_array[x];if(robj.type=='radio'){var nm=robj.element.name;for(var y=0;y<result_array.length;y++){var chk_robj=result_array[y];if(chk_robj.element.name==nm){if(robj.good==1||chk_robj.good==1){robj.good=1;chk_robj.good=1;};};};};if(robj.good){robj.debug+=" - GOOD\n";}else{robj.debug+="\n  "+robj.alt_tag+" - ERROR\n";};if(robj.good==0){if(!robj.stateful){hilite_error(robj);};fail=1;}else if(robj.good==1){if(!robj.stateful){clear_error(robj);};};debugTxt+=robj.debug;};if(_infx.validate.debug){console.log("debug text:",debugTxt);};display_error_dialogue(formobj,errorTxt,fail,error_display_id);return(fail)?false:true;}
function validate_single_field(e,chklist){if(typeof(e)==='undefined'||e===null){return 1;};if(typeof(chklist[e.name])==='undefined'){return 1;};var valobj=(typeof(chklist[e.name])==='string')?{type:chklist[e.name]}:chklist[e.name];var robj={element:e,alt_tag:'',type:valobj.type,good:0};if((isdisplayed(e)&&e.type!='hidden')||valobj.hidden){validate_field_value(robj,valobj);}else{robj.good=1;};if(robj.good==0){if(!robj.stateful){hilite_error(robj);};}else if(robj.good==1){if(!robj.stateful){clear_error(robj);};};if(_infx.validate.debug){console.log("debug - robj: ",robj,"valobj:",valobj);};return robj.good;}
function validate_field_value(robj,valobj){var value=String(robj.element.value);if(valobj.type=="text"||valobj.type=="file"){value=trim(value);if((valobj.optional==1)&&(value=='')||(value!="")&&(!isBlank(value))){robj.good=1;}else{robj.alt_tag="This is a required field";};}
else if(valobj.type=="payment_type"){if(value!=''){robj.good=1;}else{alert('Please select a payment method before clicking on checkout.');};}
else if(valobj.type=="username"){value=trim(value);if(_infx.validate.regEx.username.test(value)==true||(valobj.optional==1&&value=='')){robj.good=1;}else{robj.alt_tag="Username must be between 3 - 20 characters long and contain only letters and numbers.";};}
else if(valobj.type=="secure_username"){value=trim(value);if(_infx.validate.regEx.secureusername.test(value)==true||(valobj.optional==1&&value=='')){robj.good=1;}else{robj.alt_tag="Username must be between 6 - 20 characters long and contain only letters, numbers and hyphens.";};}
else if(valobj.type=="twitter_username"){value=trim(value);if(_infx.validate.regEx.twitterhandle.test(value)==true||(valobj.optional==1&&value=='')){robj.good=1;}else{robj.alt_tag="Please ensure you have entered a valid twitter username including the @ symbol.";};}
else if(valobj.type=="password"){value=trim(value);if(_infx.validate.regEx.simplepassword.test(value)==true||(valobj.optional==1&&value=='')){robj.good=1;}else{robj.alt_tag="Passwords should be over 6 characters in length.";};}
else if(valobj.type=="checkbox"){robj.good=1;}
else if(valobj.type=="select-one"){if(robj.element.value!="-1"||(valobj.optional==1&&value=='')){robj.good=1;}else{robj.alt_tag="Please select a value from the dropdown menu";robj.good=0;};}
else if(valobj.type=="radio"){if(robj.element.checked||(valobj.optional==1&&value=='')){robj.good=1;}else{robj.alt_tag="Please select at least one of these options";};}
else if(valobj.type=="agree"){if(robj.element.checked){robj.good=1;}else{robj.alt_tag="Please tick to agree";};}
else if(valobj.type=="date"){value=value.replace(/[^0-9:\-\/]/g,'');if(_infx.validate.regEx.loosedate.test(value)==true||(valobj.optional==1&&value=='')){var bits=value.split(/:|\/|-/);var dateobj=new Date(bits[2],bits[1]-1,bits[0]);if((dateobj.getMonth()+1!=bits[1])||(dateobj.getDate()!=bits[0])||(dateobj.getFullYear()!=bits[2])){robj.alt_tag="Please ensure you have entered a valid date.";}else{robj.good=1;}}else{robj.alt_tag="Date format must be eg. dd/mm/yyyy";};}
else if(valobj.type=="ukdate"){value=value.replace(/[^\d\/]/g,'');if(valobj.optional==1&&value==''){robj.good=1;}else{if(_infx.validate.isValidDate(value)){robj.good=1;}else{robj.alt_tag="Please ensure you have entered a valid date, expected format is dd/mm/yyyy";}}}
else if(valobj.type=="datetime"){value=trim(value);value=value.replace(/[^0-9:\-\/ ]/g,'');if(_infx.validate.regEx.loosedatetime.test(value)==true||(valobj.optional==1&&value=='')){robj.good=1;}else{robj.alt_tag="Date time format must be eg. dd/mm/yyyy hh:mm";};}
else if(valobj.type=="card_date"){value=value.replace(/[^0-9:\-\/]/g,'');if(_infx.validate.regEx.carddate.test(value)==true||(valobj.optional==1&&value=='')){robj.good=1;}else{robj.alt_tag="Please make a selection from this drop down.";};}
else if(valobj.type=="time"){value=value.replace(/[^0-9:]/g,'');if(_infx.validate.regEx['hh:mm'].test(value)==true||(valobj.optional==1&&value=='')){robj.good=1;}else{robj.alt_tag="Time format must be in 24hr format eg. 16:00";};}
else if(valobj.type=="numeric"){value=value.replace(/[^0-9\-]/g,'');if(_infx.validate.regEx.numeric.test(value)==true||(valobj.optional==1&&value=='')){if(valobj.positive&&value<=0){robj.alt_tag="value entered must be positive & should only contain digits eg. 1234";}else if(valobj.negative&&value>=0){robj.alt_tag="value entered must be negative & should only contain digits eg. 1234";}else if(valobj.notnegative&&value<0){robj.alt_tag="value entered can't be negative & should only contain digits eg. 1234";}else{robj.good=1;};}else{robj.alt_tag="Value entered should only contain digits eg. 1234";};}
else if(valobj.type=="csv"){value=value.replace(/[^0-9]/g,'');if((_infx.validate.regEx.numeric.test(value)==true&&(value.length==3||value.length==4))||(valobj.optional==1&&value=='')){robj.good=1;}else{robj.alt_tag="Your security code should be either 3 or 4 digits.";};}
else if(valobj.type=="card_number"){value=value.replace(/[^0-9]/g,'');if(_infx.validate.regEx.numeric.test(value)==true&&(value.length>=12&&value.length<=19)||(valobj.optional==1&&value=='')){robj.good=1;}else{robj.alt_tag="Please ensure you have entered your card number correctly.";};}
else if(valobj.type=="meters"){value=value.replace(/[^0-9]/g,'');if(_infx.validate.regEx.numeric.test(value)==true||(valobj.optional==1&&value=='')){robj.good=1;}else{robj.alt_tag="Fabrics can only be purchased in whole meters.";};}
else if(valobj.type=="currency"){value=value.replace(/[^0-9\.-]/g,'');if(_infx.validate.regEx.currency.test(value)==true||(valobj.optional==1&&value=='')){robj.good=1;}else{robj.alt_tag="Must contain a positive currency value eg. 10.99";};}
else if(valobj.type=="postcode"){value=trim(value);valobj.change_case=='upper';if(_infx.validate.regEx.ukpostcode.test(value)==true||(valobj.optional==1&&value=='')){robj.good=1;}else{robj.alt_tag="Ensure postcode is valid eg. BN27 2GH";};}
else if(valobj.type=="telephone"){value=value.replace(/ /g,'');if(_infx.validate.regEx.telephone.test(value)==true||(valobj.optional==1&&value=='')){robj.good=1;}else{robj.alt_tag="Ensure this is a valid phone number.";};}
else if(valobj.type=="http"){if(_infx.validate.regEx.url.test(value)==true||(valobj.optional==1&&value=='')){robj.good=1;}else{robj.alt_tag="Please ensure you have entered a valid web address.";};}
else if(valobj.type=="email"){valobj.change_case=='lower';if(_infx.validate.regEx.email.test(value)==true||(valobj.optional==1&&value=='')){robj.good=1;}else{robj.alt_tag="Ensure this is a valid email address eg. somebody@domain.co.uk";};}
else if(valobj.type=="cm"||(valobj.optional==1&&value=='')){value=value.replace(/[^0-9]/g,'');if(_infx.validate.regEx.numeric.test(value)==true){robj.good=1;}else{robj.alt_tag="This should be a value in cm eg. 100cm";};}
else if(valobj.type=="recaptcha"){var validated=_infx.google.recaptcha.check_recaptcha_response(robj.element.name);if(!validated){$('#'+robj.element.name).addClass('hilite-error');robj.good=0;}else{$('#'+robj.element.name).removeClass('hilite-error');robj.good=1;}}
else if(valobj.type=="custom"){if(typeof(valobj.validate_function)=='function'){var result=valobj.validate_function();robj.alt_tag=result.alt_tag;robj.good=result.good;};}
else{console.warn('element ('+robj.element.name+') has unknown validation type! ('+valobj.type+')');robj.good=1;};if(valobj.change_case){if(valobj.change_case=='upper'){value=value.toUpperCase();}else if(valobj.change_case=='lower'){value=value.toLowerCase();}else if(valobj.change_case=='capitalise'){value=value.toUpperCaseFirst(true);};};if(valobj.minimum!=null){if(value>=valobj.minimum){robj.alt_tag="Entered value is below the minimum of "+valobj.minimum;robj.good=0;};};if(valobj.maximum!=null){if(value<=valobj.maximum){robj.alt_tag="Entered value is above the maximum of "+valobj.maximum;robj.good=0;};};if(valobj.round_up){value=parseInt((value*valobj.round_up)/valobj.round_up);};if(valobj.round_down){value=(value/valobj.round_down)*valobj.round_down;};if(valobj.expiry_date){var today=new Date();var mnth=rtnEl('dyn_expiry_month');var year=rtnEl('dyn_expiry_year');today.setDate(1);if(mnth.value!=-1&&year.value!=-1){var checkdate=new Date();checkdate.setFullYear(parseInt('20'+year.value),(mnth.value-1),2);if(checkdate>today){clear_error({'element':mnth,'alt_tag':''});clear_error({'element':year,'alt_tag':''});}else{var errstr="This card has expired please ensure you have entered the information correctly.";hilite_error({'element':mnth,'alt_tag':errstr});hilite_error({'element':year,'alt_tag':errstr});robj.good=0;};};};if(valobj.start_date){var today=new Date();var mnth=rtnEl('dyn_start_month');var year=rtnEl('dyn_start_year');today.setDate(2);if(mnth.value!=-1&&year.value!=-1){var checkdate=new Date();checkdate.setFullYear(parseInt('20'+year.value),(mnth.value-1),1);if(checkdate<today){clear_error({'element':mnth,'alt_tag':''});clear_error({'element':year,'alt_tag':''});}else{var errstr="This card is not active yet please ensure you have entered the information correctly.";hilite_error({'element':mnth,'alt_tag':errstr});hilite_error({'element':year,'alt_tag':errstr});robj.good=0;};};};if(valobj.conf_email){var errstr="Please ensure both email address fields match before continuing";var confObj=rtnEl(valobj.conf_email);if(confObj){var test=(value==confObj.value)?1:0;if(test){clear_error({'element':confObj,'alt_tag':''});}else{robj.alt_tag=(robj.good)?errstr:robj.alt_tag;hilite_error({'element':confObj,'alt_tag':errstr});robj.good=0;};}else{console.error("no email confirmation email field found with id: "+valobj.conf_email);};};if(valobj.checkifblank){if(robj.good==0){var cobj={};cobj.element=rtnEl(valobj.checkifblank.name);cobj.alt_tag='';cobj.good=0;cobj.type=valobj.checkifblank.type;var cvalobj={}
cvalobj.type=valobj.checkifblank.type;if(cobj.element){validate_field_value(cobj,cvalobj);}else{cobj.good=0;};robj.good=cobj.good;};};if(valobj.onerrorhilite){var elements=valobj.onerrorhilite.split(',');for(var x=0;x<elements.length;x++){var obj=rtnEl(elements[x]);if(robj.good){clear_error({'element':obj,'alt_tag':''});}else{hilite_error({'element':obj,'alt_tag':robj.alt_tag});};};};if($(robj.element).data('validation-state')=='error'){robj.debug+=" [error validation state]";robj.stateful=true;robj.good=0;};if(valobj.type!="file"){robj.element.value=value;};}
function display_error_dialogue(formobj,error,fail,error_display_id){var $error=undefined;var display_message_id=(typeof(error_display_id)=='undefined')?'message':error_display_id;var	$error=$(formobj).find('#'+display_message_id);if($error.length==0){$error=$('#'+display_message_id);};if($error.length){$error.css({display:(fail)?'block':'none'}).html(error);var position=$error.position();$('html, body').animate({scrollTop:position.top},500);}else{window.scrollTo(0,0);};};function display_message(message,message_state_class){var $message=$('#message');if($message.length){if(message_state_class!='success-state'&&message_state_class!='warning-state'&&message_state_class!='error-state'){console.warn('display_message - invalid message state class provided');message_state_class='error-state';};$message.html(message).removeClass('success-state warning-state error-state').addClass(message_state_class).fadeIn('fast');}else{console.warn('display_message - no message div found in page, no way to display requested message');};};function trim(s){s=s.replace(/\s+$/,'');s=s.replace(/^\s+/,'');return s;};function isBlank(s){if(s==''){return true}
return!_infx.validate.regEx.notblank.test(s);};function isdisplayed(node){return jQuery(node).is(":visible");};_infx.validate_email=function(){var $email=$('input[name="F_client.email"]');client_form_control({'ac':'validate_email','el':$email.get(0)});};_infx.validate_username=function(){var $username=$('input[name="F_client.username"]');client_form_control({'ac':'validate_username','el':$username.get(0)});};_infx.validate_password=function(inputname){var $passhash=$('input[name="'+inputname+'"]');client_form_control({'ac':'validate_password','el':$passhash.get(0)});_infx.validate_password_confirm(inputname);};_infx.validate_password_confirm=function(inputname){var $passhash_confirm=$('input[name="'+inputname+'_confirm"]');if($passhash_confirm.length){var $passhash=$('input[name="'+inputname+'"]');client_form_control({'ac':'validate_password_confirm','el':$passhash.get(0),'el_confirm':$passhash_confirm.get(0)});};};if(typeof(_ext)=="undefined")var _ext={};var idSeed=0;_ext.toString=Object.prototype.toString;_ext.apply=function(o,c){if(o&&c&&typeof c=='object'){for(var p in c){o[p]=c[p];}}}
_ext.Element=function(element,forceNew){var dom=typeof element=="string"?document.getElementById(element):element,id;if(!dom)return null;id=dom.id;if(!forceNew&&id&&_ext.Element.cache[id]){return _ext.Element.cache[id];}
this.dom=dom;this.id=id||_ext.id(dom);};_ext.Element.cache={};_ext.apply(_ext,{id:function(el,prefix){return(el=_ext.getDom(el)||{}).id=el.id||(prefix||"ext-gen")+(++idSeed);},get:function(el){var ex,elm,id;if(!el){return null;}
if(typeof el=="string"){if(!(elm=document.getElementById(el))){return null;}
if(ex=_ext.Element.cache[el]){ex.dom=elm;}else{ex=_ext.Element.cache[el]=new _ext.Element(elm);}
return ex;}else if(el.tagName){if(!(id=el.id)){id=_ext.id(el);}
if(ex=_ext.Element.cache[id]){ex.dom=el;}else{ex=_ext.Element.cache[id]=new _ext.Element(el);}
return ex;}else if(el instanceof _ext.Element){if(el!=docEl){el.dom=document.getElementById(el.id)||el.dom;_ext.Element.cache[el.id]=el;}
return el;}else if(el.isComposite){return el;}else if(_ext.isArray(el)){return _ext.Element.select(el);}else if(el==document){if(!docEl){var f=function(){};f.prototype=_ext.Element.prototype;docEl=new f();docEl.dom=document;}
return docEl;}
return null;},getDom:function(el){if(!el||!document)return null;return el.dom?el.dom:(_ext.isString(el)?document.getElementById(el):el);},getBody:function(){return _ext.get(document.body||document.documentElement);},isArray:function(v){return _ext.toString.apply(v)==='[object Array]';},isString:function(v){return typeof v==='string';},isObject:function(v){return v&&typeof v=="object";},isFunction:function(v){return _ext.toString.apply(v)==='[object Function]';},isNumber:function(v){return typeof v==='number'&&isFinite(v);},USE_NATIVE_JSON:false});_ext.JSON=new(function(){var useHasOwn=!!{}.hasOwnProperty,isNative=function(){var useNative=null;return function(){if(useNative===null){useNative=_ext.USE_NATIVE_JSON&&window.JSON&&JSON.toString()=='[object JSON]';}
return useNative;};}(),pad=function(n){return n<10?"0"+n:n;},doDecode=function(json){return eval("("+json+')');},doEncode=function(o){if(typeof o=="undefined"||o===null){return"null";}else if(_ext.isArray(o)){return encodeArray(o);}else if(Object.prototype.toString.apply(o)==='[object Date]'){return _ext.JSON.encodeDate(o);}else if(typeof o=="string"){return encodeString(o);}else if(typeof o=="number"){return isFinite(o)?String(o):"null";}else if(typeof o=="boolean"){return String(o);}else{var a=["{"],b,i,v;for(i in o){if(!useHasOwn||o.hasOwnProperty(i)){v=o[i];switch(typeof v){case"undefined":case"function":case"unknown":break;default:if(b){a.push(',');}
a.push(doEncode(i),":",v===null?"null":doEncode(v));b=true;}}}
a.push("}");return a.join("");}},m={"\b":'\\b',"\t":'\\t',"\n":'\\n',"\f":'\\f',"\r":'\\r','"':'\\"',"\\":'\\\\'},encodeString=function(s){if(/["\\\x00-\x1f]/.test(s)){return'"'+s.replace(/([\x00-\x1f\\"])/g,function(a,b){var c=m[b];if(c){return c;}
c=b.charCodeAt();return"\\u00"+
Math.floor(c/16).toString(16)+
(c%16).toString(16);})+'"';}
return'"'+s+'"';},encodeArray=function(o){var a=["["],b,i,l=o.length,v;for(i=0;i<l;i+=1){v=o[i];switch(typeof v){case"undefined":case"function":case"unknown":break;default:if(b){a.push(',');}
a.push(v===null?"null":_ext.JSON.encode(v));b=true;}}
a.push("]");return a.join("");};this.encodeDate=function(o){return'"'+o.getFullYear()+"-"+
pad(o.getMonth()+1)+"-"+
pad(o.getDate())+"T"+
pad(o.getHours())+":"+
pad(o.getMinutes())+":"+
pad(o.getSeconds())+'"';};this.encode=function(){var ec;return function(o){if(!ec){ec=isNative()?JSON.stringify:doEncode;}
return ec(o);};}();this.decode=function(){var dc;return function(json){if(!dc){dc=isNative()?JSON.parse:doDecode;}
return dc(json);};}();})();_infx=(typeof(_infx)==='undefined')?{}:_infx;_infx.social={disable_button:function(config){if(typeof config.btn!=='undefined'){if($(config.btn).is('button')||$(config.btn).is('input')){$(config.btn).attr('disabled',true);}else{console.log("Warning: cannot disable non-button object with class: "+config.btn.className);};};if(!config.no_timeout){var tm_val=config.timer_val||2000;setTimeout(function(){_infx.social.re_enable_button(config);},tm_val);};},re_enable_button:function(config){if(typeof config.btn!=='undefined'){$(config.btn).removeAttr('disabled');};},post_action:function(loginconf,config,callback){if(_popup&&_popup.active&&(!config||!config.leave_popup)){_popup.close();};var track_config=config.track||{};if(typeof(track_config.category)==='undefined')track_config.category='Action';if(typeof(track_config.action)==='undefined')track_config.action='Social Login';if(typeof(track_config.label)==='undefined')track_config.label=loginconf.name.charAt(0).toUpperCase()+loginconf.name.slice(1);_infx.track.fire('event',[track_config.category,track_config.action,track_config.label]);var post_data={widget:'widget-login.pl',ac:'do_social_login',valid_json:true,social_login_name:loginconf.name,social_login_token:loginconf.token};if(typeof config.btn!=='undefined'){post_data.redirect=$(config.btn).closest('div.infx-ecommerce-form-shell').find('input[name="redirect"]').val();};$.ajax({url:_infx.scripts.infxsystem.widget,type:'post',data:post_data,success:function(data){if(typeof(callback)=='function'){callback(loginconf,config,data);};_infx.social.re_enable_button(config);if(typeof(data.redirect)!='undefined'){location.href=data.redirect;}else if(config&&config.reload){location.reload();};},error:function(rq,status,e){_infx.social.re_enable_button(config);}});}};_infx.facebook={initialised:false,config:undefined,init:function(fb_config,oninitialisation){if(typeof FB!=='object'){$('body').prepend('<div id="fb-root"></div>');this.config=fb_config||{};var js_src=this.config.js_src||"//connect.facebook.net/en_US/sdk.js";var facebook_application_config=_infx.config.return_config_for_domain(this.config.oauth);if(typeof facebook_application_config!=='undefined'){this.config.oauth_client_id=facebook_application_config.appid;var scope_config=this.config;$.getScript('//connect.facebook.net/en_US/sdk.js',function(){FB.init({appId:scope_config.oauth_client_id,version:scope_config.version||'v2.5',status:true,cookie:true,xfbml:true});FB.getLoginStatus(function(){if(typeof oninitialisation==='function'){oninitialisation();};_infx.facebook.initialised=true;});});}else{console.error("current domain has no facebook application id configuration");};}else{console.error("Something else has defined the facebook object, it's potentially used the wrong app id - It's vital this is resolved.");};},share:function(config,callback){if(this.initialised){if(typeof(FB)==='object'){FB.ui(config,callback);}else{console.error("no facebook object detected");};}else{this.init(undefined,function(){this.share(config,callback);});};},login:function(config,callback){if(typeof(FB)==='object'){_infx.social.disable_button(config);FB.login(function(fb_response){if(fb_response.status==='connected'){_infx.social.post_action({name:'facebook',token:fb_response.authResponse.accessToken},config,callback);}else if(fb_response.status==='not_authorized'){}else{};},{scope:'public_profile,email'});}else{};}};_infx.twitter={initialised:true,init:function(twitter_config,oninitialisation){if(typeof(window.twttr)==='undefined'){window.twttr=(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],t=window.twttr||{};if(d.getElementById(id))return;js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);t._e=[];t.ready=function(f){t._e.push(f);};return t;}(document,"script","twitter-wjs"));if(typeof(oninitialisation)==='function'){twttr.ready(oninitialisation);};}else{console.warn("twitter widget is already setup");};},login:function(config,callback){console.log('twitter login TBD');},prepareTweetButton:function(config,callback){if(typeof window.twttr==='object'&&typeof callback==='function')window.twttr.events.bind('tweet',callback);config.button.attr("href","https://twitter.com/intent/tweet?original_referer="+config.referer+"&text="+config.text+"&tw_p=tweetbutton&url="+config.url);},tweet:function(config,callback){if(typeof window.twttr==='object'&&typeof callback==='function')window.twttr.events.bind('tweet',callback);config.button.attr("href","https://twitter.com/intent/tweet?original_referer="+config.referer+"&text="+config.text+"&tw_p=tweetbutton&url="+config.url);config.button.trigger("click");}};_infx.google={initialised:true,config:undefined,init:function(google_config,oninitialisation){if(typeof(gapi)==='undefined'){this.config=google_config||{};var js_src=this.config.js_src||"//apis.google.com/js/client:platform.js";var google_application_config=_infx.config.return_config_for_domain(this.config.oauth);if(typeof google_application_config!=='undefined'){this.google_oauth_client_id=google_application_config.appid;(function(d){var js,id='google-jssdk',ref=d.getElementsByTagName('script')[0],head;if(d.getElementById(id)){return;}
js=d.createElement('script');js.id=id;js.async=true;js.src=js_src;head=ref?ref.parentNode:d.getElementsByTagName('head')[0];head.insertBefore(js,ref);}(document));if(typeof oninitialisation==='function'){oninitialisation();};}else{console.error("current domain has no google application id configuration");};}else{console.error("Something else has defined the google api object, it's potentially used the wrong app id - It's vital this is resolved.");};},prepareShareButton:function(element,options){if(typeof(gapi)==='object'){gapi.interactivepost.render(element,options);};},login:function(config,callback){if(typeof(gapi)==='object'){_infx.social.disable_button(config);var oauth_client_id=(config?config.oauth_client_id:undefined)||this.google_oauth_client_id;if(typeof oauth_client_id!=='undefined'){gapi.auth.authorize({client_id:oauth_client_id,scope:["https://www.googleapis.com/auth/userinfo.email","https://www.googleapis.com/auth/userinfo.profile"],immediate:false},function(google_response){if(google_response.access_token){_infx.social.post_action({name:'google',token:google_response.access_token},config,callback);}else{};});}else{};};}};_infx=(typeof(_infx)==='undefined')?{}:_infx;_infx.bazaarvoice={config:undefined,globalProductId:undefined,inserts:[],inlineRatingProductIds:[],init:function(bazaarvoice_config){this.config=bazaarvoice_config||{};$('[data-bazaarvoice-insert]').each(function(idx){_infx.bazaarvoice.inserts.push({$el:$(this),data:$(this).data()});});if($('[data-bazaarvoice-global]').length){this.globalProductId=String($('[data-bazaarvoice-global]').data('bazaarvoice-global'));$BV.configure('global',{productId:this.globalProductId,});}
var inline_rating_product_ids={};$(_infx.bazaarvoice.inserts).each(function(idx){if(this.data.bazaarvoiceInsert=='inline_ratings'){inline_rating_product_ids[this.$el.data('product-id')]=1;}else if(this.data.bazaarvoiceInsert=='show_reviews'){if(typeof(_infx.bazaarvoice.globalProductId)!=='undefined'){$BV.ui('rr','show_reviews',{productId:_infx.bazaarvoice.globalProductId,doShowContent:function(){console.log("show_reviews doShowContent");}});}else{console.warn("unable to render show_reviews content, no global product ID defined");}}else if(this.data.bazaarvoiceInsert=='show_questions'){if(typeof(_infx.bazaarvoice.globalProductId)!=='undefined'){$BV.ui('qa','show_questions',{productId:_infx.bazaarvoice.globalProductId,doShowContent:function(){console.log("show_questions doShowContent");}});}else{console.warn("unable to render show_reviews content, no global product ID defined");}}});for(var p in inline_rating_product_ids){this.inlineRatingProductIds.push(p);$('body').append('<div id="BVRRInlineRating-'+p+'" style="display:none;"></div>');}
if(this.inlineRatingProductIds.length){$BV.ui('rr','inline_ratings',{productIds:this.inlineRatingProductIds,containerPrefix:'BVRRInlineRating',doShowContent:function(){console.log("inline_ratings doShowContent");}});setTimeout(function(){for(var p in inline_rating_product_ids){var $temp=$('#BVRRInlineRating-'+p);$('[data-bazaarvoice-insert="inline_ratings"][data-product-id="'+p+'"]').html($temp.html());$temp.remove();}},2500);}},register:function(){_infx.track.register({type:'bazaarvoice',definition:{trackTransactionData:{items:[]},init:function(tracker){if(_infx.track.debug>1){console.log("_infx.track.bazaarvoice.init config:",tracker.config);};},addpii:function(tracker,args){$.extend(this.trackTransactionData,{email:args[0]});},addtrans:function(tracker,args){if(_infx.track.debug>1){console.log("_infx.track.bazaarvoice.addtrans args:",args);};$.extend(this.trackTransactionData,{orderId:args[0],total:args[2],tax:args[3],shipping:args[4],city:args[5],state:args[6],country:args[7]});},additem:function(tracker,args){if(_infx.track.debug>1){console.log("_infx.track.bazaarvoice.additem args:",args);};if(args[1]==""){return;};this.trackTransactionData.items.push({sku:args[1],price:args[4],quantity:args[5]});},tracktrans:function(tracker){if(_infx.track.debug>1){console.log("_infx.track.bazaarvoice.tracktrans trackTransactionData:",this.trackTransactionData);};if(_infx.track.sandbox){if(_infx.track.debug){console.warn("running in sandbox mode, blocking requests to bazaar voice");};return;}
$BV.SI.trackTransactionPageView(this.trackTransactionData);}}});}};function show_children(el,spacer){el.children().each(function(){console.log(spacer+"tag "+$(this).prop("tagName")+" class "+$(this).get(0).className+" width="+$(this).width());show_children($(this),spacer+'  ');});}
var asph_tid=null;$(window).on('resize load tab_change col_change',function(){autoSetPictureHeight();if(asph_tid)clearTimeout(asph_tid);asph_tid=setTimeout(function(){autoSetPictureHeight()},300);});function get_prop_from_style($el,prop){var s;if(s=$el.attr('style')){var props=s.split(';');for(var n=0;n<props.length;n++){var nv=props[n].split(":");if(trim(nv[0])==prop){return trim(nv[1]);}}}
return'';}
function trim(s){if(!s)return s;s=s.replace(/^ +/,'');s=s.replace(/ +$/,'');return s;}
function autoSetPictureHeight(){var ww=$(window).width();var cw=0;$('.-sys-dbnewpicture img').removeClass('heightset');$('.-sys-dbnewpicture').removeClass('heightset');$.each($('.-sys-dbnewpicture'),function(){var $img=$(this).find('img');var w=0;var $obj=$img;while(w==0){w=$obj[0].getBoundingClientRect().width;if(w==0){if($(this).hasClass('-sys-setsizeondisplay')){return;}
var wcss=$obj[0].style.width;if(wcss&&/px/.test(wcss))w=parseFloat(wcss);$obj=$obj.parent();}}
if(cw==0)cw=w;if((cw!=w)&&(Math.abs(w-cw)<2)){w=cw;};var process=true;if(w>ww+100){if($(this).closest('.parallax').length){}else{process=false;if(console&&console.warn)console.warn('Error: Picture (width='+w+'px) would be resized greater than the browser window (width='+ww+'px). Look for bad css making some parent element too wide ');var $biggy=$(this);var tw=w;while(($biggy.length)&&($biggy.parent().width()>=tw)){$biggy=$biggy.parent();tw=$biggy.width();};if(console&&console.log){console.log('This is the suspect element (width='+tw+'px) with bad width/css',$biggy);console.log('If this is genuine width case, then consider adding class "parallax" to stop it reporting error');};};};if(process){var r=$img.data('aspectratio');if(r){$img.height(w*r);$img.addClass('heightset');$(this).addClass('heightset');};};});$(window).trigger('content_resize');}
var infxcols=infxcols||{};infxcols.tid=null;function process_cols($frame){var m=10;if(typeof($frame.data('colgap'))!='undefined'){m=$frame.data('colgap')/2;}
var outermargins=$frame.data('outermargins')||0;if($frame.children().css('display')=='block'){m=0;outermargins=0;}
$frame.css('min-width','auto');var ww=$frame.outerWidth(true);var gcols=0,cols=0;px_tot=0;var $children=$frame.children('.infx-column-data,.infx-column-data-locked');var percent_or_px_present=0;$children.each(function(idx){var w=$(this).data('colwidth');if(w&&/%/.test(w)){percent_or_px_present=1;}
if(w&&/px/.test(w)){px_tot+=parseFloat(w);percent_or_px_present=1;}else{gcols+=w||1;}
cols++;});if(percent_or_px_present){}else{var n=(gcols>2)?gcols+(gcols-2):gcols;if(cols==1)n=0;if(outermargins)n+=2;var ct=ww-(n*m)-px_tot;$children.each(function(idx){var $child=$(this).children();if(outermargins||(idx>0)||(m==0))$child.css('margin-left',m+'px');if(outermargins||(idx<(cols-1))||(m==0))$child.css('margin-right',m+'px');var cw=$(this).data('colwidth')||1;var pw;if(cw&&/(px|%)/.test(cw)){pw=cw;}else{var c=(ct*cw)/gcols;var w=c+m+(2*m*(cw-1));if((!(idx==0)&&!(idx==(cols-1)))||outermargins){w+=m;}
pw=(w/ww*100)+'%';}
$(this).css('width',pw);});}
}
function process_column_wrappers(){$('.column-wrapper').not('.no-auto-width').each(function(idx){process_cols($(this));});$(window).trigger('col_change');}
function clean_columns_of_white_space(){$('.column-wrapper').each(function(idx){var $childs=$(this).children();$(this).empty().append($childs);});}
$(document).ready(function(){infxcols.tid=setTimeout(process_column_wrappers,10);$(window).on('resize',function(){if(infxcols.tid)clearTimeout(infxcols.tid);infxcols.tid=setTimeout(process_column_wrappers,10);});$('.column-wrapper').each(function(idx){var mytab=$(this).closest('.tab-panel');if(mytab.length){mytab.on('tab_change',function(e,tab_idx,group){if(infxcols.tid)clearTimeout(infxcols.tid);infxcols.tid=setTimeout(process_column_wrappers,10);});}});});(function(){var lastTime=0;var vendors=['webkit','moz'];for(var x=0;x<vendors.length&&!window.requestAnimationFrame;++x){window.requestAnimationFrame=window[vendors[x]+'RequestAnimationFrame'];window.cancelAnimationFrame=window[vendors[x]+'CancelAnimationFrame']||window[vendors[x]+'CancelRequestAnimationFrame'];}
if(!window.requestAnimationFrame)
window.requestAnimationFrame=function(callback,element){var currTime=new Date().getTime();var timeToCall=Math.max(0,16-(currTime-lastTime));var id=window.setTimeout(function(){callback(currTime+timeToCall);},timeToCall);lastTime=currTime+timeToCall;return id;};if(!window.cancelAnimationFrame)
window.cancelAnimationFrame=function(id){clearTimeout(id);};}());_infx=(typeof(_infx)==='undefined')?{}:_infx;_infx.slidingHeader={_self:this,scrollTimeline:null,config:{},headerHeight:0,navHeight:0,scrollHeight:0,addObject:function(cssObject){$(cssObject.element).css("transform","translateZ(0)");var tween=TweenMax.fromTo(cssObject.element,1,cssObject.startCSS,cssObject.endCSS);scrollTimeline.add(tween,0);scrollTimeline.progress(1);scrollTimeline.progress(0);},progressAnimation:function(progress){scrollTimeline.progress(progress<0?0:progress>1?1:progress);},addHeaderHeightToScrollTopOffset:function(increment){_infx.config.scrollTopOffset+=headerHeight;},init:function(){var _self=this;if(this.config.mobileEnabled===false){if(this.config.mobileFixedHeader===true){$("header").css({"position":"fixed","transform":"translateZ(0)","top":"0px","left":"0px","right":"0px"});headerHeight=$("header").height();$("#outer-content-container").css("margin-top",headerHeight);};if($(window).width()<=this.config.mobileThreshold)return;};scrollTimeline=new TimelineMax({repeat:0,align:"normal",tweens:[TweenMax.to({},1,{})]});scrollTimeline.pause();$("header").css({"position":"fixed","transform":"translateZ(0)","top":"0px","left":"0px","right":"0px"});headerHeight=_infx.slidingHeader.config.headerStartHeight;navHeight=_infx.slidingHeader.config.headerEndHeight;scrollHeight=headerHeight-navHeight;_self.addHeaderHeightToScrollTopOffset();$("#outer-content-container").css("margin-top",headerHeight);for(var i=0;i<this.config.cssObjects.length;i++){this.addObject(this.config.cssObjects[i]);};(function(){var throttle=function(type,name,obj){var obj=obj||window;var running=false;var func=function(){if(running){return;}
running=true;window.requestAnimationFrame(function(){var evt=document.createEvent("CustomEvent");evt.initCustomEvent(name,false,false,{});window.dispatchEvent(evt);running=false;});};obj.addEventListener(type,func);};throttle("scroll","optimizedScroll");})();window.removeEventListener("optimizedScroll",function(){var progress=$(document).scrollTop()/scrollHeight;_self.progressAnimation(progress);});window.addEventListener("optimizedScroll",function(){var progress=$(document).scrollTop()/scrollHeight;_self.progressAnimation(progress);});var progress=$(document).scrollTop()/scrollHeight;_self.progressAnimation(progress);}};_infx.generate_password_popup={initialised:false,visible:false,btn:null,inputname:null,dialog:null,password:"",init:function(btn,inputname){var _self=this;_self.btn=$(btn);_self.inputname=inputname;_self.dialog=_self.btn.parent().find('.generate-password-dialog');_self.dialog.html("<span class='generated-password'></span>"+
"<a nohref class='accept-password'>Use this password</a>"+
"<a nohref class='another-password'>Another password please</a>");_self.initialised=true;},toggle:function(btn,inputname){var _self=this;if(!_self.initialised){_self.init(btn,inputname);};if(_self.visible){_self.hide();}else{_self.show();};},generate:function(){var _self=this;$.ajax({dataType:"json",url:_infx.scripts.ecommerce.ajax,type:'post',data:{ac:'generate_password'},async:true,context:_self,success:function(data){if(data.success){_self.dialog.find('.generated-password').html(data.password);_self.password=data.password;}else{console.warn("unable to generate password, check server side components")};}});},accept:function(){var _self=this;$('input[name="'+_self.inputname+'"],input[name="'+_self.inputname+'_confirm"]').val(_self.password).change();_self.hide();},show:function(){var _self=this;_self.btn.addClass('generate-password-dialog-open');_self.generate();_self.dialog.fadeIn('fast',function(){_self.visible=true;});},hide:function(){var _self=this;_self.btn.removeClass('generate-password-dialog-open');_self.dialog.fadeOut('fast',function(){_self.dialog.find('.generated-password').html('');_self.visible=false;});}};$(document).ready(function(){$(document).on('click.infx-generate-password','.generate-password-dialog-container .generate-password-popup-button',function(e){_infx.generate_password_popup.toggle(this,$(this).data('inputname'));});$(document).on('click.infx-generate-password','.generate-password-dialog .another-password',function(e){_infx.generate_password_popup.generate();e.stopPropagation();});$(document).on('click.infx-generate-password','.generate-password-dialog .accept-password',function(e){_infx.generate_password_popup.accept();e.stopPropagation();});$(document).on('click.infx-generate-password','.generate-password-dialog',function(e){e.stopPropagation();});$(document).on('click.infx-generate-password touchend.infx-generate-password','body',function(e){if($(e.target).closest(".generate-password-dialog").length>0)return;if(_infx.generate_password_popup.visible){_infx.generate_password_popup.hide();};});});